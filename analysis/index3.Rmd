---
title: 'Population density affects sexual selection in an insect model'
author: "Lennart Winkler^1^, Ronja Eilhardt^1^ & Tim Janicke^1,2^ <br></br>  ^1^Applied Zoology, Technical University Dresden <br> ^2^Centre d’Écologie Fonctionnelle et Évolutive, UMR 5175, CNRS, Université de Montpellier</br>"
subtitle: 'Part 2: Testing the effect of density on mating behaviour and reproductive success'
site: workflowr::wflow_site
output:
  workflowr::wflow_html
---

Supplementary material reporting R code for the manuscript 'Population density affects sexual selection in an insect model'.

# Part 2: Testing the effect of density on mating behaviour and reproductive success

Here we tested the effect that the treatments (group and arena size) had on the mating behaviour and reproductive success of focal beetles.<br><br>
Behavioural variables:<br>
- Copulation attempts<br>
- Copulations per encounter<br>
- Number of partners<br>
- Number copulations<br>
- Copulations per partner<br>
- Copulation duration

# Load and prepare data

Before we started the analyses, we loaded all necessary packages and data.

```{r , message=FALSE, warning=FALSE, results='hide'}
rm(list = ls()) # Clear work environment

# Load R-packages ####
list_of_packages=cbind('ggeffects','ggplot2','gridExtra','lme4','lmerTest','readr','dplyr','EnvStats','cowplot','gridGraphics','car','RColorBrewer','boot','data.table','base','ICC','knitr')
lapply(list_of_packages, require, character.only = TRUE) 

# Load data set ####
D_data=read_delim("./data/Data_Winkler_et_al_2023_Denstiy.csv",";", escape_double = FALSE, trim_ws = TRUE)

# Set factors and levels for factors
D_data$Week=as.factor(D_data$Week)
D_data$Sex=as.factor(D_data$Sex)
D_data$Gr_size=as.factor(D_data$Gr_size)
D_data$Gr_size <- factor(D_data$Gr_size, levels=c("SG","LG"))
D_data$Arena=as.factor(D_data$Arena)

## Subset data set ####
### Data according to denstiy ####
D_data_0.26=D_data[D_data$Treatment=='D = 0.26',]
D_data_0.52=D_data[D_data$Treatment=='D = 0.52',]
D_data_0.67=D_data[D_data$Treatment=='D = 0.67',]
D_data_1.33=D_data[D_data$Treatment=='D = 1.33',]

### Subset data by sex ####
D_data_m=D_data[D_data$Sex=='M',]
D_data_f=D_data[D_data$Sex=='F',]

### Calculate data relativized within treatment and sex ####
# Small group + large Area
D_data_0.26=D_data[D_data$Treatment=='D = 0.26',]

D_data_0.26$rel_m_RS=NA
D_data_0.26$rel_m_prop_RS=NA
D_data_0.26$rel_m_cMS=NA
D_data_0.26$rel_m_InSuc=NA
D_data_0.26$rel_m_feSuc=NA
D_data_0.26$rel_m_pFec=NA
D_data_0.26$rel_m_PS=NA
D_data_0.26$rel_m_pFec_compl=NA

D_data_0.26$rel_f_RS=NA
D_data_0.26$rel_f_prop_RS=NA
D_data_0.26$rel_f_cMS=NA
D_data_0.26$rel_f_fec_pMate=NA

D_data_0.26$rel_m_RS=D_data_0.26$m_RS/mean(D_data_0.26$m_RS,na.rm=T)
D_data_0.26$rel_m_prop_RS=D_data_0.26$m_prop_RS/mean(D_data_0.26$m_prop_RS,na.rm=T)
D_data_0.26$rel_m_cMS=D_data_0.26$m_cMS/mean(D_data_0.26$m_cMS,na.rm=T)
D_data_0.26$rel_m_InSuc=D_data_0.26$m_InSuc/mean(D_data_0.26$m_InSuc,na.rm=T)
D_data_0.26$rel_m_feSuc=D_data_0.26$m_feSuc/mean(D_data_0.26$m_feSuc,na.rm=T)
D_data_0.26$rel_m_pFec=D_data_0.26$m_pFec/mean(D_data_0.26$m_pFec,na.rm=T)
D_data_0.26$rel_m_PS=D_data_0.26$m_PS/mean(D_data_0.26$m_PS,na.rm=T)
D_data_0.26$rel_m_pFec_compl=D_data_0.26$m_pFec_compl/mean(D_data_0.26$m_pFec_compl,na.rm=T)

D_data_0.26$rel_f_RS=D_data_0.26$f_RS/mean(D_data_0.26$f_RS,na.rm=T)
D_data_0.26$rel_f_prop_RS=D_data_0.26$f_prop_RS/mean(D_data_0.26$f_prop_RS,na.rm=T)
D_data_0.26$rel_f_cMS=D_data_0.26$f_cMS/mean(D_data_0.26$f_cMS,na.rm=T)
D_data_0.26$rel_f_fec_pMate=D_data_0.26$f_fec_pMate/mean(D_data_0.26$f_fec_pMate,na.rm=T)

# Large group + large Area
D_data_0.52=D_data[D_data$Treatment=='D = 0.52',]
#Relativize data

D_data_0.52$rel_m_RS=NA
D_data_0.52$rel_m_prop_RS=NA
D_data_0.52$rel_m_cMS=NA
D_data_0.52$rel_m_InSuc=NA
D_data_0.52$rel_m_feSuc=NA
D_data_0.52$rel_m_pFec=NA
D_data_0.52$rel_m_PS=NA
D_data_0.52$rel_m_pFec_compl=NA

D_data_0.52$rel_f_RS=NA
D_data_0.52$rel_f_prop_RS=NA
D_data_0.52$rel_f_cMS=NA
D_data_0.52$rel_f_fec_pMate=NA

D_data_0.52$rel_m_RS=D_data_0.52$m_RS/mean(D_data_0.52$m_RS,na.rm=T)
D_data_0.52$rel_m_prop_RS=D_data_0.52$m_prop_RS/mean(D_data_0.52$m_prop_RS,na.rm=T)
D_data_0.52$rel_m_cMS=D_data_0.52$m_cMS/mean(D_data_0.52$m_cMS,na.rm=T)
D_data_0.52$rel_m_InSuc=D_data_0.52$m_InSuc/mean(D_data_0.52$m_InSuc,na.rm=T)
D_data_0.52$rel_m_feSuc=D_data_0.52$m_feSuc/mean(D_data_0.52$m_feSuc,na.rm=T)
D_data_0.52$rel_m_pFec=D_data_0.52$m_pFec/mean(D_data_0.52$m_pFec,na.rm=T)
D_data_0.52$rel_m_PS=D_data_0.52$m_PS/mean(D_data_0.52$m_PS,na.rm=T)
D_data_0.52$rel_m_pFec_compl=D_data_0.52$m_pFec_compl/mean(D_data_0.52$m_pFec_compl,na.rm=T)

D_data_0.52$rel_f_RS=D_data_0.52$f_RS/mean(D_data_0.52$f_RS,na.rm=T)
D_data_0.52$rel_f_prop_RS=D_data_0.52$f_prop_RS/mean(D_data_0.52$f_prop_RS,na.rm=T)
D_data_0.52$rel_f_cMS=D_data_0.52$f_cMS/mean(D_data_0.52$f_cMS,na.rm=T)
D_data_0.52$rel_f_fec_pMate=D_data_0.52$f_fec_pMate/mean(D_data_0.52$f_fec_pMate,na.rm=T)

# Small group + small Area
D_data_0.67=D_data[D_data$Treatment=='D = 0.67',]
#Relativize data
D_data_0.67$rel_m_RS=NA
D_data_0.67$rel_m_prop_RS=NA
D_data_0.67$rel_m_cMS=NA
D_data_0.67$rel_m_InSuc=NA
D_data_0.67$rel_m_feSuc=NA
D_data_0.67$rel_m_pFec=NA
D_data_0.67$rel_m_PS=NA
D_data_0.67$rel_m_pFec_compl=NA

D_data_0.67$rel_f_RS=NA
D_data_0.67$rel_f_prop_RS=NA
D_data_0.67$rel_f_cMS=NA
D_data_0.67$rel_f_fec_pMate=NA

D_data_0.67$rel_m_RS=D_data_0.67$m_RS/mean(D_data_0.67$m_RS,na.rm=T)
D_data_0.67$rel_m_prop_RS=D_data_0.67$m_prop_RS/mean(D_data_0.67$m_prop_RS,na.rm=T)
D_data_0.67$rel_m_cMS=D_data_0.67$m_cMS/mean(D_data_0.67$m_cMS,na.rm=T)
D_data_0.67$rel_m_InSuc=D_data_0.67$m_InSuc/mean(D_data_0.67$m_InSuc,na.rm=T)
D_data_0.67$rel_m_feSuc=D_data_0.67$m_feSuc/mean(D_data_0.67$m_feSuc,na.rm=T)
D_data_0.67$rel_m_pFec=D_data_0.67$m_pFec/mean(D_data_0.67$m_pFec,na.rm=T)
D_data_0.67$rel_m_PS=D_data_0.67$m_PS/mean(D_data_0.67$m_PS,na.rm=T)
D_data_0.67$rel_m_pFec_compl=D_data_0.67$m_pFec_compl/mean(D_data_0.67$m_pFec_compl,na.rm=T)

D_data_0.67$rel_f_RS=D_data_0.67$f_RS/mean(D_data_0.67$f_RS,na.rm=T)
D_data_0.67$rel_f_prop_RS=D_data_0.67$f_prop_RS/mean(D_data_0.67$f_prop_RS,na.rm=T)
D_data_0.67$rel_f_cMS=D_data_0.67$f_cMS/mean(D_data_0.67$f_cMS,na.rm=T)
D_data_0.67$rel_f_fec_pMate=D_data_0.67$f_fec_pMate/mean(D_data_0.67$f_fec_pMate,na.rm=T)

# Large group + small Area
D_data_1.33=D_data[D_data$Treatment=='D = 1.33',]
#Relativize data

D_data_1.33$rel_m_RS=NA
D_data_1.33$rel_m_prop_RS=NA
D_data_1.33$rel_m_cMS=NA
D_data_1.33$rel_m_InSuc=NA
D_data_1.33$rel_m_feSuc=NA
D_data_1.33$rel_m_pFec=NA
D_data_1.33$rel_m_PS=NA
D_data_1.33$rel_m_pFec_compl=NA

D_data_1.33$rel_f_RS=NA
D_data_1.33$rel_f_prop_RS=NA
D_data_1.33$rel_f_cMS=NA
D_data_1.33$rel_f_fec_pMate=NA

D_data_1.33$rel_m_RS=D_data_1.33$m_RS/mean(D_data_1.33$m_RS,na.rm=T)
D_data_1.33$rel_m_prop_RS=D_data_1.33$m_prop_RS/mean(D_data_1.33$m_prop_RS,na.rm=T)
D_data_1.33$rel_m_cMS=D_data_1.33$m_cMS/mean(D_data_1.33$m_cMS,na.rm=T)
D_data_1.33$rel_m_InSuc=D_data_1.33$m_InSuc/mean(D_data_1.33$m_InSuc,na.rm=T)
D_data_1.33$rel_m_feSuc=D_data_1.33$m_feSuc/mean(D_data_1.33$m_feSuc,na.rm=T)
D_data_1.33$rel_m_pFec=D_data_1.33$m_pFec/mean(D_data_1.33$m_pFec,na.rm=T)
D_data_1.33$rel_m_PS=D_data_1.33$m_PS/mean(D_data_1.33$m_PS,na.rm=T)
D_data_1.33$rel_m_pFec_compl=D_data_1.33$m_pFec_compl/mean(D_data_1.33$m_pFec_compl,na.rm=T)

D_data_1.33$rel_f_RS=D_data_1.33$f_RS/mean(D_data_1.33$f_RS,na.rm=T)
D_data_1.33$rel_f_prop_RS=D_data_1.33$f_prop_RS/mean(D_data_1.33$f_prop_RS,na.rm=T)
D_data_1.33$rel_f_cMS=D_data_1.33$f_cMS/mean(D_data_1.33$f_cMS,na.rm=T)
D_data_1.33$rel_f_fec_pMate=D_data_1.33$f_fec_pMate/mean(D_data_1.33$f_fec_pMate,na.rm=T)

### Reduce treatments to arena and population size ####
# Arena size
D_data_Large_arena=rbind(D_data_0.26,D_data_0.52)
D_data_Small_arena=rbind(D_data_0.67,D_data_1.33)

# Population size
D_data_Small_pop=rbind(D_data_0.26,D_data_0.67)
D_data_Large_pop=rbind(D_data_0.52,D_data_1.33)

## Set figure schemes ####
# Set color-sets for figures
colpal=brewer.pal(4, 'Dark2')
colpal2=c("#b2182b","#2166AC")
colpal3=brewer.pal(4, 'Paired')

# Set theme for ggplot2 figures
fig_theme=theme(panel.border = element_blank(),
                plot.margin = margin(0,2.2,0,0.2,"cm"),
                plot.title = element_text(hjust = 0.5),
                panel.background = element_blank(),
                legend.key=element_blank(),
                panel.grid.major = element_blank(),
                panel.grid.minor = element_blank(), 
                legend.position = c(1.25, 0.8),
                plot.tag.position=c(0.01,0.98),
                legend.title = element_blank(),
                legend.text = element_text(colour="black", size=10),
                axis.line.x = element_line(colour = "black", size = 1),
                axis.line.y = element_line(colour = "black", size = 1),
                axis.text.x = element_text(face="plain", color="black", size=16, angle=0),
                axis.text.y = element_text(face="plain", color="black", size=16, angle=0),
                axis.title.x = element_text(size=16,face="plain", margin = margin(r=0,10,0,0)),
                axis.title.y = element_text(size=16,face="plain", margin = margin(r=10,0,0,0)),
                axis.ticks = element_line(size = 1),
                axis.ticks.length = unit(.3, "cm"))

## Create customized functions for analysis ####
# Create function to calculate standard error and upper/lower standard deviation
standard_error <- function(x) sd(x,na.rm=T) / sqrt(length(na.exclude(x)))
upper_CI <- function(x) mean(x,na.rm=T)+((standard_error(x))*qnorm(0.975))
lower_CI <- function(x) mean(x,na.rm=T)-((standard_error(x))*qnorm(0.975))

upper_SD <- function(x) mean(x,na.rm=T)+(sd(x)/2)
lower_SD <- function(x) mean(x,na.rm=T)-(sd(x)/2)
```

# Model the effect of density on mating behaviour

## Copulation attempts
### Males
First, we calculated means and SE for each treatment:</br></br>
Mean number of copulation attempts in small groups (SE) = `r round(mean(D_data$m_Total_Encounters[D_data$Gr_size=='SG'],na.rm=T),digits=2)` (`r round(standard_error(D_data$m_Total_Encounters[D_data$Gr_size=='SG']),digits=2)`)
```{r, warning=FALSE, message=FALSE, results='hide'}
mean(D_data$m_Total_Encounters[D_data$Gr_size=='SG'],na.rm=T)
standard_error(D_data$m_Total_Encounters[D_data$Gr_size=='SG'])
```

Mean number of copulation attempts in large groups (SE) = `r round(mean(D_data$m_Total_Encounters[D_data$Gr_size=='LG'],na.rm=T),digits=2)` (`r round(standard_error(D_data$m_Total_Encounters[D_data$Gr_size=='LG']),digits=2)`)
```{r , warning=FALSE, message=FALSE, results='hide'}
mean(D_data$m_Total_Encounters[D_data$Gr_size=='LG'],na.rm=T)
standard_error(D_data$m_Total_Encounters[D_data$Gr_size=='LG'])
```

Mean number of copulation attempts in large arena size (SE) = `r round(mean(D_data$m_Total_Encounters[D_data$Arena=='Large'],na.rm=T),digits=2)` (`r round(standard_error(D_data$m_Total_Encounters[D_data$Arena=='Large']),digits=2)`)
```{r , warning=FALSE, message=FALSE, results='hide'}
mean(D_data$m_Total_Encounters[D_data$Arena=='Large'],na.rm=T)
standard_error(D_data$m_Total_Encounters[D_data$Arena=='Large'])
```

Mean number of copulation attempts in small arena size (SE) = `r round(mean(D_data$m_Total_Encounters[D_data$Arena=='Small'],na.rm=T),digits=2)` (`r round(standard_error(D_data$m_Total_Encounters[D_data$Arena=='Small']),digits=2)`)
```{r, warning=FALSE, message=FALSE, results='hide'}
mean(D_data$m_Total_Encounters[D_data$Arena=='Small'],na.rm=T)
standard_error(D_data$m_Total_Encounters[D_data$Arena=='Small'])
```

GLM for copulation attempts including interaction between group and arena size treatment:
```{r , warning=FALSE, message=FALSE}
mod3=glm(m_Total_Encounters~Gr_size*Arena,data=D_data,family = quasipoisson)
Anova(mod3,type=2)
```

GLM for copulation attempts excluding interaction between group and arena size treatment:
```{r , warning=FALSE, message=FALSE}
mod3.1=glm(m_Total_Encounters~Gr_size+Arena,data=D_data,family = quasipoisson)
summary(mod3.1)
Anova(mod3.1,type=2)
```

### Females
We calculated means and SE for each treatment:</br></br>
Mean number of copulation attempts in small groups (SE) = `r round(mean(D_data$f_Total_Encounters[D_data$Gr_size=='SG'],na.rm=T),digits=2)` (`r round(standard_error(D_data$f_Total_Encounters[D_data$Gr_size=='SG']),digits=2)`)
```{r, warning=FALSE, message=FALSE, results='hide'}
mean(D_data$f_Total_Encounters[D_data$Gr_size=='SG'],na.rm=T)
standard_error(D_data$f_Total_Encounters[D_data$Gr_size=='SG'])
```

Mean number of copulation attempts in large groups (SE) = `r round(mean(D_data$f_Total_Encounters[D_data$Gr_size=='LG'],na.rm=T),digits=2)` (`r round(standard_error(D_data$f_Total_Encounters[D_data$Gr_size=='LG']),digits=2)`)
```{r , warning=FALSE, message=FALSE, results='hide'}
mean(D_data$f_Total_Encounters[D_data$Gr_size=='LG'],na.rm=T)
standard_error(D_data$f_Total_Encounters[D_data$Gr_size=='LG'])
```

Mean number of copulation attempts in large arena size (SE) = `r round(mean(D_data$f_Total_Encounters[D_data$Arena=='Large'],na.rm=T),digits=2)` (`r round(standard_error(D_data$f_Total_Encounters[D_data$Arena=='Large']),digits=2)`)
```{r , warning=FALSE, message=FALSE, results='hide'}
mean(D_data$f_Total_Encounters[D_data$Arena=='Large'],na.rm=T)
standard_error(D_data$f_Total_Encounters[D_data$Arena=='Large'])
```

Mean number of copulation attempts in small arena size (SE) = `r round(mean(D_data$f_Total_Encounters[D_data$Arena=='Small'],na.rm=T),digits=2)` (`r round(standard_error(D_data$f_Total_Encounters[D_data$Arena=='Small']),digits=2)`)
```{r, warning=FALSE, message=FALSE, results='hide'}
mean(D_data$f_Total_Encounters[D_data$Arena=='Small'],na.rm=T)
standard_error(D_data$f_Total_Encounters[D_data$Arena=='Small'])
```

GLM for copulation attempts including interaction between group and arena size treatment:
```{r, warning=FALSE, message=FALSE}
mod4=glm(f_Total_Encounters~Gr_size*Arena,data=D_data,family = quasipoisson)
Anova(mod4,type=2)
```

GLM for copulation attempts excluding interaction between group and arena size treatment:
```{r , warning=FALSE, message=FALSE}
mod4.1=glm(f_Total_Encounters~Gr_size+Arena,data=D_data,family = quasipoisson)
summary(mod4.1)
Anova(mod4.1,type=2)
```

## Copulations per attempt
### Males
We calculated means and SE for each treatment:</br></br>
Number of copulations per attempt in small groups (SE) = `r round(mean(D_data$m_TotMatings[D_data$Gr_size=='SG']/(D_data$m_TotMatings[D_data$Gr_size=='SG']+D_data$m_Attempts_number[D_data$Gr_size=='SG']),na.rm=T),digits=2)` (`r round(standard_error(D_data$m_TotMatings[D_data$Gr_size=='SG']/(D_data$m_TotMatings[D_data$Gr_size=='SG']+D_data$m_Attempts_number[D_data$Gr_size=='SG'])),digits=2)`)
```{r, warning=FALSE, message=FALSE, results='hide'}
mean(D_data$m_TotMatings[D_data$Gr_size=='SG']/(D_data$m_TotMatings[D_data$Gr_size=='SG']+D_data$m_Attempts_number[D_data$Gr_size=='SG']),na.rm=T)
standard_error(D_data$m_TotMatings[D_data$Gr_size=='SG']/(D_data$m_TotMatings[D_data$Gr_size=='SG']+D_data$m_Attempts_number[D_data$Gr_size=='SG']))
```

Number of copulations per attempt in large groups (SE) = `r round(mean(D_data$m_TotMatings[D_data$Gr_size=='LG']/(D_data$m_TotMatings[D_data$Gr_size=='LG']+D_data$m_Attempts_number[D_data$Gr_size=='LG']),na.rm=T),digits=2)` (`r round(standard_error(D_data$m_TotMatings[D_data$Gr_size=='LG']/(D_data$m_TotMatings[D_data$Gr_size=='LG']+D_data$m_Attempts_number[D_data$Gr_size=='LG'])),digits=2)`)
```{r , warning=FALSE, message=FALSE, results='hide'}
mean(D_data$m_TotMatings[D_data$Gr_size=='LG']/(D_data$m_TotMatings[D_data$Gr_size=='LG']+D_data$m_Attempts_number[D_data$Gr_size=='LG']),na.rm=T)
standard_error(D_data$m_TotMatings[D_data$Gr_size=='LG']/(D_data$m_TotMatings[D_data$Gr_size=='LG']+D_data$m_Attempts_number[D_data$Gr_size=='LG']))
```

Number of copulations per attempt in large arena size (SE) = `r round(mean(D_data$m_TotMatings[D_data$Arena=='Large']/(D_data$m_TotMatings[D_data$Arena=='Large']+D_data$m_Attempts_number[D_data$Arena=='Large']),na.rm=T),digits=2)` (`r round(standard_error(D_data$m_TotMatings[D_data$Arena=='Large']/(D_data$m_TotMatings[D_data$Arena=='Large']+D_data$m_Attempts_number[D_data$Arena=='Large'])),digits=2)`)
```{r , warning=FALSE, message=FALSE, results='hide'}
mean(D_data$m_TotMatings[D_data$Arena=='Large']/(D_data$m_TotMatings[D_data$Arena=='Large']+D_data$m_Attempts_number[D_data$Arena=='Large']),na.rm=T)
standard_error(D_data$m_TotMatings[D_data$Arena=='Large']/(D_data$m_TotMatings[D_data$Arena=='Large']+D_data$m_Attempts_number[D_data$Arena=='Large']))
```

Number of copulations per attempt in small arena size (SE) = `r round(mean(D_data$m_TotMatings[D_data$Arena=='Small']/(D_data$m_TotMatings[D_data$Arena=='Small']+D_data$m_Attempts_number[D_data$Arena=='Small']),na.rm=T),digits=2)` (`r round(standard_error(D_data$m_TotMatings[D_data$Arena=='Small']/(D_data$m_TotMatings[D_data$Arena=='Small']+D_data$m_Attempts_number[D_data$Arena=='Small'])),digits=2)`)
```{r, warning=FALSE, message=FALSE, results='hide'}
mean(D_data$m_TotMatings[D_data$Arena=='Small']/(D_data$m_TotMatings[D_data$Arena=='Small']+D_data$m_Attempts_number[D_data$Arena=='Small']),na.rm=T)
standard_error(D_data$m_TotMatings[D_data$Arena=='Small']/(D_data$m_TotMatings[D_data$Arena=='Small']+D_data$m_Attempts_number[D_data$Arena=='Small']))
```

GLM for copulations per attempt including interaction between group and arena size treatment:
```{r, warning=FALSE, message=FALSE}
mod5=glm(cbind(m_TotMatings,m_Attempts_number)~Gr_size*Arena,data=D_data,family = quasibinomial)
Anova(mod5,type=2)
```

GLM for copulations per attempt excluding interaction between group and arena size treatment:
```{r, warning=FALSE, message=FALSE}
mod5.1=glm(cbind(m_TotMatings,m_Attempts_number)~Gr_size+Arena,data=D_data,family = quasibinomial)
summary(mod5.1)
Anova(mod5.1,type=2)
```

### Females
We calculated means and SE for each treatment:</br></br>
Number of copulations per attempt in small groups (SE) = `r round(mean(D_data$f_TotMatings[D_data$Gr_size=='SG']/(D_data$f_TotMatings[D_data$Gr_size=='SG']+D_data$f_Attempts_number[D_data$Gr_size=='SG']),na.rm=T),digits=2)` (`r round(standard_error(D_data$f_TotMatings[D_data$Gr_size=='SG']/(D_data$f_TotMatings[D_data$Gr_size=='SG']+D_data$f_Attempts_number[D_data$Gr_size=='SG'])),digits=2)`)
```{r, warning=FALSE, message=FALSE, results='hide'}
mean(D_data$f_TotMatings[D_data$Gr_size=='SG']/(D_data$f_TotMatings[D_data$Gr_size=='SG']+D_data$f_Attempts_number[D_data$Gr_size=='SG']),na.rm=T)
standard_error(D_data$f_TotMatings[D_data$Gr_size=='SG']/(D_data$f_TotMatings[D_data$Gr_size=='SG']+D_data$f_Attempts_number[D_data$Gr_size=='SG']))
```

Number of copulations per attempt in large groups (SE) = `r round(mean(D_data$f_TotMatings[D_data$Gr_size=='LG']/(D_data$f_TotMatings[D_data$Gr_size=='LG']+D_data$f_Attempts_number[D_data$Gr_size=='LG']),na.rm=T),digits=2)` (`r round(standard_error(D_data$f_TotMatings[D_data$Gr_size=='LG']/(D_data$f_TotMatings[D_data$Gr_size=='LG']+D_data$f_Attempts_number[D_data$Gr_size=='LG'])),digits=2)`)
```{r , warning=FALSE, message=FALSE, results='hide'}
mean(D_data$f_TotMatings[D_data$Gr_size=='LG']/(D_data$f_TotMatings[D_data$Gr_size=='LG']+D_data$f_Attempts_number[D_data$Gr_size=='LG']),na.rm=T)
standard_error(D_data$f_TotMatings[D_data$Gr_size=='LG']/(D_data$f_TotMatings[D_data$Gr_size=='LG']+D_data$f_Attempts_number[D_data$Gr_size=='LG']))
```

Number of copulations per attempt in large arena size (SE) = `r round(mean(D_data$f_TotMatings[D_data$Arena=='Large']/(D_data$f_TotMatings[D_data$Arena=='Large']+D_data$f_Attempts_number[D_data$Arena=='Large']),na.rm=T),digits=2)` (`r round(standard_error(D_data$f_TotMatings[D_data$Arena=='Large']/(D_data$f_TotMatings[D_data$Arena=='Large']+D_data$f_Attempts_number[D_data$Arena=='Large'])),digits=2)`)
```{r , warning=FALSE, message=FALSE, results='hide'}
mean(D_data$f_TotMatings[D_data$Arena=='Large']/(D_data$f_TotMatings[D_data$Arena=='Large']+D_data$f_Attempts_number[D_data$Arena=='Large']),na.rm=T)
standard_error(D_data$f_TotMatings[D_data$Arena=='Large']/(D_data$f_TotMatings[D_data$Arena=='Large']+D_data$f_Attempts_number[D_data$Arena=='Large']))
```

Number of copulations per attempt in small arena size (SE) = `r round(mean(D_data$f_TotMatings[D_data$Arena=='Small']/(D_data$f_TotMatings[D_data$Arena=='Small']+D_data$f_Attempts_number[D_data$Arena=='Small']),na.rm=T),digits=2)` (`r round(standard_error(D_data$f_TotMatings[D_data$Arena=='Small']/(D_data$f_TotMatings[D_data$Arena=='Small']+D_data$f_Attempts_number[D_data$Arena=='Small'])),digits=2)`)
```{r, warning=FALSE, message=FALSE, results='hide'}
mean(D_data$f_TotMatings[D_data$Arena=='Small']/(D_data$f_TotMatings[D_data$Arena=='Small']+D_data$f_Attempts_number[D_data$Arena=='Small']),na.rm=T)
standard_error(D_data$f_TotMatings[D_data$Arena=='Small']/(D_data$f_TotMatings[D_data$Arena=='Small']+D_data$f_Attempts_number[D_data$Arena=='Small']))
```

GLM for copulations per attempt including interaction between group and arena size treatment:
```{r, warning=FALSE, message=FALSE}
mod6=glm(cbind(f_TotMatings,f_Attempts_number)~Gr_size*Arena,data=D_data,family = quasibinomial)
Anova(mod6,type=2)
```

GLM for copulations per attempt excluding interaction between group and arena size treatment:
```{r, warning=FALSE, message=FALSE}
mod6.1=glm(cbind(f_TotMatings,f_Attempts_number)~Gr_size+Arena,data=D_data,family = quasibinomial)
summary(mod6.1)
Anova(mod6.1,type=2)
```

## Number of partners
### Males
We calculated means and SE for each treatment:</br></br>
Mean number of partners in small groups (SE) = `r round(mean(D_data$m_cMS[D_data$Gr_size=='SG'],na.rm=T),digits=2)` (`r round(standard_error(D_data$m_cMS[D_data$Gr_size=='SG']),digits=2)`)
```{r, warning=FALSE, message=FALSE, results='hide'}
mean(D_data$m_cMS[D_data$Gr_size=='SG'],na.rm=T)
standard_error(D_data$m_cMS[D_data$Gr_size=='SG'])
```

Mean number of partners in large groups (SE) = `r round(mean(D_data$m_cMS[D_data$Gr_size=='LG'],na.rm=T),digits=2)` (`r round(standard_error(D_data$m_cMS[D_data$Gr_size=='LG']),digits=2)`)
```{r , warning=FALSE, message=FALSE, results='hide'}
mean(D_data$m_cMS[D_data$Gr_size=='LG'],na.rm=T)
standard_error(D_data$m_cMS[D_data$Gr_size=='LG'])
```

Mean number of partners in large arena size (SE) = `r round(mean(D_data$m_cMS[D_data$Arena=='Large'],na.rm=T),digits=2)` (`r round(standard_error(D_data$m_cMS[D_data$Arena=='Large']),digits=2)`)
```{r , warning=FALSE, message=FALSE, results='hide'}
mean(D_data$m_cMS[D_data$Arena=='Large'],na.rm=T)
standard_error(D_data$m_cMS[D_data$Arena=='Large'])
```

Mean number of partners in small arena size (SE) = `r round(mean(D_data$m_cMS[D_data$Arena=='Small'],na.rm=T),digits=2)` (`r round(standard_error(D_data$m_cMS[D_data$Arena=='Small']),digits=2)`)
```{r, warning=FALSE, message=FALSE, results='hide'}
mean(D_data$m_cMS[D_data$Arena=='Small'],na.rm=T)
standard_error(D_data$m_cMS[D_data$Arena=='Small'])
```

GLM for number of partners including interaction between group and arena size treatment</br>
```{r , warning=FALSE, message=FALSE}
mod7=glm(m_cMS~Gr_size*Arena,data=D_data,family = quasipoisson)
Anova(mod7,type=2)
```

GLM for number of partners excluding interaction between group and arena size treatment</br>
```{r , warning=FALSE, message=FALSE}
mod7.1=glm(m_cMS~Gr_size+Arena,data=D_data,family = quasipoisson)
summary(mod7.1)
Anova(mod7.1,type=2)
```

## Number of partners
### Females
We calculated means and SE for each treatment:</br></br>
Mean number of partners in small groups (SE) = `r round(mean(D_data$f_cMS[D_data$Gr_size=='SG'],na.rm=T),digits=2)` (`r round(standard_error(D_data$f_cMS[D_data$Gr_size=='SG']),digits=2)`)
```{r, warning=FALSE, message=FALSE, results='hide'}
mean(D_data$f_cMS[D_data$Gr_size=='SG'],na.rm=T)
standard_error(D_data$f_cMS[D_data$Gr_size=='SG'])
```

Mean number of partners in large groups (SE) = `r round(mean(D_data$f_cMS[D_data$Gr_size=='LG'],na.rm=T),digits=2)` (`r round(standard_error(D_data$f_cMS[D_data$Gr_size=='LG']),digits=2)`)
```{r , warning=FALSE, message=FALSE, results='hide'}
mean(D_data$f_cMS[D_data$Gr_size=='LG'],na.rm=T)
standard_error(D_data$f_cMS[D_data$Gr_size=='LG'])
```

Mean number of partners in large arena size (SE) = `r round(mean(D_data$f_cMS[D_data$Arena=='Large'],na.rm=T),digits=2)` (`r round(standard_error(D_data$f_cMS[D_data$Arena=='Large']),digits=2)`)
```{r , warning=FALSE, message=FALSE, results='hide'}
mean(D_data$f_cMS[D_data$Arena=='Large'],na.rm=T)
standard_error(D_data$f_cMS[D_data$Arena=='Large'])
```

Mean number of partners in small arena size (SE) = `r round(mean(D_data$f_cMS[D_data$Arena=='Small'],na.rm=T),digits=2)` (`r round(standard_error(D_data$f_cMS[D_data$Arena=='Small']),digits=2)`)
```{r, warning=FALSE, message=FALSE, results='hide'}
mean(D_data$f_cMS[D_data$Arena=='Small'],na.rm=T)
standard_error(D_data$f_cMS[D_data$Arena=='Small'])
```

GLM for number of partners including interaction between group and arena size treatment:
```{r , warning=FALSE, message=FALSE}
mod8=glm(f_cMS~Gr_size*Arena,data=D_data,family = quasipoisson)
Anova(mod8,type=2)
```

GLM for number of partners excluding interaction between group and arena size treatment:
```{r , warning=FALSE, message=FALSE}
mod8.1=glm(f_cMS~Gr_size+Arena,data=D_data,family = quasipoisson)
summary(mod8.1)
Anova(mod8.1,type=2)
```

## Number copulations
### Males
We calculated means and SE for each treatment:</br></br>
Mean number of copulations in small groups (SE) = `r round(mean(D_data$m_TotMatings[D_data$Gr_size=='SG'],na.rm=T),digits=2)` (`r round(standard_error(D_data$m_TotMatings[D_data$Gr_size=='SG']),digits=2)`)
```{r, warning=FALSE, message=FALSE, results='hide'}
mean(D_data$m_TotMatings[D_data$Gr_size=='SG'],na.rm=T)
standard_error(D_data$m_TotMatings[D_data$Gr_size=='SG'])
```

Mean number of copulations in large groups (SE) = `r round(mean(D_data$m_TotMatings[D_data$Gr_size=='LG'],na.rm=T),digits=2)` (`r round(standard_error(D_data$m_TotMatings[D_data$Gr_size=='LG']),digits=2)`)
```{r , warning=FALSE, message=FALSE, results='hide'}
mean(D_data$m_TotMatings[D_data$Gr_size=='LG'],na.rm=T)
standard_error(D_data$m_TotMatings[D_data$Gr_size=='LG'])
```

Mean number of copulations in large arena size (SE) = `r round(mean(D_data$m_TotMatings[D_data$Arena=='Large'],na.rm=T),digits=2)` (`r round(standard_error(D_data$m_TotMatings[D_data$Arena=='Large']),digits=2)`)
```{r , warning=FALSE, message=FALSE, results='hide'}
mean(D_data$m_TotMatings[D_data$Arena=='Large'],na.rm=T)
standard_error(D_data$m_TotMatings[D_data$Arena=='Large'])
```

Mean number of copulations in small arena size (SE) = `r round(mean(D_data$m_TotMatings[D_data$Arena=='Small'],na.rm=T),digits=2)` (`r round(standard_error(D_data$m_TotMatings[D_data$Arena=='Small']),digits=2)`)
```{r, warning=FALSE, message=FALSE, results='hide'}
mean(D_data$m_TotMatings[D_data$Arena=='Small'],na.rm=T)
standard_error(D_data$m_TotMatings[D_data$Arena=='Small'])
```

GLM for number of copulations including interaction between group and arena size treatment:
```{r , warning=FALSE, message=FALSE}
mod9=glm(m_TotMatings~Gr_size*Arena,data=D_data,family = quasipoisson)
Anova(mod9,type=2)
```

GLM for number of copulations excluding interaction between group and arena size treatment:
```{r , warning=FALSE, message=FALSE}
mod9.1=glm(m_TotMatings~Gr_size+Arena,data=D_data,family = quasipoisson)
summary(mod9.1)
Anova(mod9.1,type=2)
```

### Females
We calculated means and SE for each treatment:</br></br>
Mean number of copulations in small groups (SE) = `r round(mean(D_data$f_TotMatings[D_data$Gr_size=='SG'],na.rm=T),digits=2)` (`r round(standard_error(D_data$f_TotMatings[D_data$Gr_size=='SG']),digits=2)`)
```{r, warning=FALSE, message=FALSE, results='hide'}
mean(D_data$f_TotMatings[D_data$Gr_size=='SG'],na.rm=T)
standard_error(D_data$f_TotMatings[D_data$Gr_size=='SG'])
```

Mean number of copulations in large groups (SE) = `r round(mean(D_data$f_TotMatings[D_data$Gr_size=='LG'],na.rm=T),digits=2)` (`r round(standard_error(D_data$f_TotMatings[D_data$Gr_size=='LG']),digits=2)`)
```{r , warning=FALSE, message=FALSE, results='hide'}
mean(D_data$f_TotMatings[D_data$Gr_size=='LG'],na.rm=T)
standard_error(D_data$f_TotMatings[D_data$Gr_size=='LG'])
```

Mean number of copulations in large arena size (SE) = `r round(mean(D_data$f_TotMatings[D_data$Arena=='Large'],na.rm=T),digits=2)` (`r round(standard_error(D_data$f_TotMatings[D_data$Arena=='Large']),digits=2)`)
```{r , warning=FALSE, message=FALSE, results='hide'}
mean(D_data$f_TotMatings[D_data$Arena=='Large'],na.rm=T)
standard_error(D_data$f_TotMatings[D_data$Arena=='Large'])
```

Mean number of copulations in small arena size (SE) = `r round(mean(D_data$f_TotMatings[D_data$Arena=='Small'],na.rm=T),digits=2)` (`r round(standard_error(D_data$f_TotMatings[D_data$Arena=='Small']),digits=2)`)
```{r, warning=FALSE, message=FALSE, results='hide'}
mean(D_data$f_TotMatings[D_data$Arena=='Small'],na.rm=T)
standard_error(D_data$f_TotMatings[D_data$Arena=='Small'])
```

GLM for number of copulations including interaction between group and arena size treatment:
```{r , warning=FALSE, message=FALSE}
mod10=glm(f_TotMatings~Gr_size*Arena,data=D_data,family = quasipoisson)
Anova(mod10,type=2)
```

GLM for number of copulations excluding interaction between group and arena size treatment:
```{r , warning=FALSE, message=FALSE}
mod10.1=glm(f_TotMatings~Gr_size+Arena,data=D_data,family = quasipoisson)
summary(mod10.1)
Anova(mod10.1,type=2)
```

## Copulations per partner
### Males

We calculated means and SE for each treatment:</br></br>
Copulations per partner in small groups (SE) = `r round(mean(D_data$m_meanCop[D_data$Gr_size=='SG'],na.rm=T),digits=2)` (`r round(standard_error(D_data$m_meanCop[D_data$Gr_size=='SG']),digits=2)`)
```{r, warning=FALSE, message=FALSE, results='hide'}
mean(D_data$m_meanCop[D_data$Gr_size=='SG'],na.rm=T)
standard_error(D_data$m_meanCop[D_data$Gr_size=='SG'])
```

Copulations per partner in large groups (SE) = `r round(mean(D_data$m_meanCop[D_data$Gr_size=='LG'],na.rm=T),digits=2)` (`r round(standard_error(D_data$m_meanCop[D_data$Gr_size=='LG']),digits=2)`)
```{r , warning=FALSE, message=FALSE, results='hide'}
mean(D_data$m_meanCop[D_data$Gr_size=='LG'],na.rm=T)
standard_error(D_data$m_meanCop[D_data$Gr_size=='LG'])
```

Copulations per partner in large arena size (SE) = `r round(mean(D_data$m_meanCop[D_data$Arena=='Large'],na.rm=T),digits=2)` (`r round(standard_error(D_data$m_meanCop[D_data$Arena=='Large']),digits=2)`)
```{r , warning=FALSE, message=FALSE, results='hide'}
mean(D_data$m_meanCop[D_data$Arena=='Large'],na.rm=T)
standard_error(D_data$m_meanCop[D_data$Arena=='Large'])
```

Copulations per partner in small arena size (SE) = `r round(mean(D_data$m_meanCop[D_data$Arena=='Small'],na.rm=T),digits=2)` (`r round(standard_error(D_data$m_meanCop[D_data$Arena=='Small']),digits=2)`)
```{r, warning=FALSE, message=FALSE, results='hide'}
mean(D_data$m_meanCop[D_data$Arena=='Small'],na.rm=T)
standard_error(D_data$m_meanCop[D_data$Arena=='Small'])
```

GLM for copulations per partner including interaction between group and arena size treatment:
```{r , warning=FALSE, message=FALSE}
mod11=glm(cbind(m_cMS,m_TotMatings)~Gr_size*Arena,data=D_data,family = quasibinomial)
Anova(mod11,type=2)
```

GLM for copulations per partner excluding interaction between group and arena size treatment:
```{r , warning=FALSE, message=FALSE}
mod11.1=glm(cbind(m_cMS,m_TotMatings)~Gr_size+Arena,data=D_data,family = quasibinomial)
summary(mod11.1)
Anova(mod11.1,type=2)
```

### Females

We calculated means and SE for each treatment:</br></br>
Copulations per partner in small groups (SE) = `r round(mean(D_data$f_meanCop[D_data$Gr_size=='SG'],na.rm=T),digits=2)` (`r round(standard_error(D_data$f_meanCop[D_data$Gr_size=='SG']),digits=2)`)
```{r, warning=FALSE, message=FALSE, results='hide'}
mean(D_data$f_meanCop[D_data$Gr_size=='SG'],na.rm=T)
standard_error(D_data$f_meanCop[D_data$Gr_size=='SG'])
```

Copulations per partner in large groups (SE) = `r round(mean(D_data$f_meanCop[D_data$Gr_size=='LG'],na.rm=T),digits=2)` (`r round(standard_error(D_data$f_meanCop[D_data$Gr_size=='LG']),digits=2)`)
```{r , warning=FALSE, message=FALSE, results='hide'}
mean(D_data$f_meanCop[D_data$Gr_size=='LG'],na.rm=T)
standard_error(D_data$f_meanCop[D_data$Gr_size=='LG'])
```

Copulations per partner in large arena size (SE) = `r round(mean(D_data$f_meanCop[D_data$Arena=='Large'],na.rm=T),digits=2)` (`r round(standard_error(D_data$f_meanCop[D_data$Arena=='Large']),digits=2)`)
```{r , warning=FALSE, message=FALSE, results='hide'}
mean(D_data$f_meanCop[D_data$Arena=='Large'],na.rm=T)
standard_error(D_data$f_meanCop[D_data$Arena=='Large'])
```

Copulations per partner in small arena size (SE) = `r round(mean(D_data$f_meanCop[D_data$Arena=='Small'],na.rm=T),digits=2)` (`r round(standard_error(D_data$f_meanCop[D_data$Arena=='Small']),digits=2)`)
```{r, warning=FALSE, message=FALSE, results='hide'}
mean(D_data$f_meanCop[D_data$Arena=='Small'],na.rm=T)
standard_error(D_data$f_meanCop[D_data$Arena=='Small'])
```

GLM for copulations per partner including interaction between group and arena size treatment:
```{r , warning=FALSE, message=FALSE}
mod12=glm(cbind(f_cMS,f_TotMatings)~Gr_size*Arena,data=D_data,family = quasibinomial)
Anova(mod12,type=2)
```

GLM for copulations per partner excluding interaction between group and arena size treatment:
```{r , warning=FALSE, message=FALSE}
mod12.1=glm(cbind(f_cMS,f_TotMatings)~Gr_size+Arena,data=D_data,family = quasibinomial)
summary(mod12.1)
Anova(mod12.1,type=2)
```

## Copulation duration
### Males

We calculated means and SE for each treatment:</br></br>
Copulation duration in small groups (SE) = `r round(mean(D_data$m_MatingDuration_av[D_data$Gr_size=='SG'],na.rm=T),digits=2)` (`r round(standard_error(D_data$m_MatingDuration_av[D_data$Gr_size=='SG']),digits=2)`)
```{r, warning=FALSE, message=FALSE, results='hide'}
mean(D_data$m_MatingDuration_av[D_data$Gr_size=='SG'],na.rm=T)
standard_error(D_data$m_MatingDuration_av[D_data$Gr_size=='SG'])
```

Copulation duration in large groups (SE) = `r round(mean(D_data$m_MatingDuration_av[D_data$Gr_size=='LG'],na.rm=T),digits=2)` (`r round(standard_error(D_data$m_MatingDuration_av[D_data$Gr_size=='LG']),digits=2)`)
```{r , warning=FALSE, message=FALSE, results='hide'}
mean(D_data$m_MatingDuration_av[D_data$Gr_size=='LG'],na.rm=T)
standard_error(D_data$m_MatingDuration_av[D_data$Gr_size=='LG'])
```

Copulation duration in large arena size (SE) = `r round(mean(D_data$m_MatingDuration_av[D_data$Arena=='Large'],na.rm=T),digits=2)` (`r round(standard_error(D_data$m_MatingDuration_av[D_data$Arena=='Large']),digits=2)`)
```{r , warning=FALSE, message=FALSE, results='hide'}
mean(D_data$m_MatingDuration_av[D_data$Arena=='Large'],na.rm=T)
standard_error(D_data$m_MatingDuration_av[D_data$Arena=='Large'])
```

Copulation duration in small arena size (SE) = `r round(mean(D_data$m_MatingDuration_av[D_data$Arena=='Small'],na.rm=T),digits=2)` (`r round(standard_error(D_data$m_MatingDuration_av[D_data$Arena=='Small']),digits=2)`)
```{r, warning=FALSE, message=FALSE, results='hide'}
mean(D_data$m_MatingDuration_av[D_data$Arena=='Small'],na.rm=T)
standard_error(D_data$m_MatingDuration_av[D_data$Arena=='Small'])
```

GLM for copulation duration including interaction between group and arena size treatment:
```{r , warning=FALSE, message=FALSE}
mod13=glm(m_MatingDuration_av~Gr_size*Arena,data=D_data,family = gaussian)
Anova(mod13,type=2)
```

GLM for copulation duration excluding interaction between group and arena size treatment:
```{r , warning=FALSE, message=FALSE}
mod13.1=glm(m_MatingDuration_av~Gr_size+Arena,data=D_data,family = gaussian)
summary(mod13.1)
Anova(mod13.1,type=2)
```

### Females

We calculated means and SE for each treatment:</br></br>
Copulation duration in small groups (SE) = `r round(mean(D_data$f_MatingDuration_av[D_data$Gr_size=='SG'],na.rm=T),digits=2)` (`r round(standard_error(D_data$f_MatingDuration_av[D_data$Gr_size=='SG']),digits=2)`)
```{r, warning=FALSE, message=FALSE, results='hide'}
mean(D_data$f_MatingDuration_av[D_data$Gr_size=='SG'],na.rm=T)
standard_error(D_data$f_MatingDuration_av[D_data$Gr_size=='SG'])
```

Copulation duration in large groups (SE) = `r round(mean(D_data$f_MatingDuration_av[D_data$Gr_size=='LG'],na.rm=T),digits=2)` (`r round(standard_error(D_data$f_MatingDuration_av[D_data$Gr_size=='LG']),digits=2)`)
```{r , warning=FALSE, message=FALSE, results='hide'}
mean(D_data$f_MatingDuration_av[D_data$Gr_size=='LG'],na.rm=T)
standard_error(D_data$f_MatingDuration_av[D_data$Gr_size=='LG'])
```

Copulation duration in large arena size (SE) = `r round(mean(D_data$f_MatingDuration_av[D_data$Arena=='Large'],na.rm=T),digits=2)` (`r round(standard_error(D_data$f_MatingDuration_av[D_data$Arena=='Large']),digits=2)`)
```{r , warning=FALSE, message=FALSE, results='hide'}
mean(D_data$f_MatingDuration_av[D_data$Arena=='Large'],na.rm=T)
standard_error(D_data$f_MatingDuration_av[D_data$Arena=='Large'])
```

Copulation duration in small arena size (SE) = `r round(mean(D_data$f_MatingDuration_av[D_data$Arena=='Small'],na.rm=T),digits=2)` (`r round(standard_error(D_data$f_MatingDuration_av[D_data$Arena=='Small']),digits=2)`)
```{r, warning=FALSE, message=FALSE, results='hide'}
mean(D_data$f_MatingDuration_av[D_data$Arena=='Small'],na.rm=T)
standard_error(D_data$f_MatingDuration_av[D_data$Arena=='Small'])
```

GLM for copulation duration including interaction between group and arena size treatment:
```{r , warning=FALSE, message=FALSE}
mod14=glm(f_MatingDuration_av~Gr_size*Arena,data=D_data,family = gaussian)
Anova(mod14,type=2)
```

GLM for copulation duration excluding interaction between group and arena size treatment:
```{r , warning=FALSE, message=FALSE}
mod14.1=glm(f_MatingDuration_av~Gr_size+Arena,data=D_data,family = gaussian)
summary(mod14.1)
Anova(mod14.1,type=2)
```

## Reproductive success
### Males

We calculated means and SE for each treatment:</br></br>
Reproductive success in small groups (SE) = `r round(mean(D_data$m_RS[D_data$Gr_size=='SG'],na.rm=T),digits=2)` (`r round(standard_error(D_data$m_RS[D_data$Gr_size=='SG']),digits=2)`)
```{r, warning=FALSE, message=FALSE, results='hide'}
mean(D_data$m_RS[D_data$Gr_size=='SG'],na.rm=T)
standard_error(D_data$m_RS[D_data$Gr_size=='SG'])
```

Reproductive success in large groups (SE) = `r round(mean(D_data$m_RS[D_data$Gr_size=='LG'],na.rm=T),digits=2)` (`r round(standard_error(D_data$m_RS[D_data$Gr_size=='LG']),digits=2)`)
```{r , warning=FALSE, message=FALSE, results='hide'}
mean(D_data$m_RS[D_data$Gr_size=='LG'],na.rm=T)
standard_error(D_data$m_RS[D_data$Gr_size=='LG'])
```

Reproductive success in large arena size (SE) = `r round(mean(D_data$m_RS[D_data$Arena=='Large'],na.rm=T),digits=2)` (`r round(standard_error(D_data$m_RS[D_data$Arena=='Large']),digits=2)`)
```{r , warning=FALSE, message=FALSE, results='hide'}
mean(D_data$m_RS[D_data$Arena=='Large'],na.rm=T)
standard_error(D_data$m_RS[D_data$Arena=='Large'])
```

Reproductive success in small arena size (SE) = `r round(mean(D_data$m_RS[D_data$Arena=='Small'],na.rm=T),digits=2)` (`r round(standard_error(D_data$m_RS[D_data$Arena=='Small']),digits=2)`)
```{r, warning=FALSE, message=FALSE, results='hide'}
mean(D_data$m_RS[D_data$Arena=='Small'],na.rm=T)
standard_error(D_data$m_RS[D_data$Arena=='Small'])
```

GLM for reproductive success including interaction between group and arena size treatment:
```{r , warning=FALSE, message=FALSE}
mod15=glm(m_RS~Gr_size*Arena,data=D_data,family = quasipoisson)
Anova(mod15,type=2)
```

GLM for reproductive success excluding interaction between group and arena size treatment:
```{r , warning=FALSE, message=FALSE}
mod15.1=glm(m_RS~Gr_size+Arena,data=D_data,family = quasipoisson)
summary(mod15.1)
Anova(mod15.1,type=2)
```

### Females

We calculated means and SE for each treatment:</br></br>
Reproductive success in small groups (SE) = `r round(mean(D_data$f_RS[D_data$Gr_size=='SG'],na.rm=T),digits=2)` (`r round(standard_error(D_data$f_RS[D_data$Gr_size=='SG']),digits=2)`)
```{r, warning=FALSE, message=FALSE, results='hide'}
mean(D_data$f_RS[D_data$Gr_size=='SG'],na.rm=T)
standard_error(D_data$f_RS[D_data$Gr_size=='SG'])
```

Reproductive success in large groups (SE) = `r round(mean(D_data$f_RS[D_data$Gr_size=='LG'],na.rm=T),digits=2)` (`r round(standard_error(D_data$f_RS[D_data$Gr_size=='LG']),digits=2)`)
```{r , warning=FALSE, message=FALSE, results='hide'}
mean(D_data$f_RS[D_data$Gr_size=='LG'],na.rm=T)
standard_error(D_data$f_RS[D_data$Gr_size=='LG'])
```

Reproductive success in large arena size (SE) = `r round(mean(D_data$f_RS[D_data$Arena=='Large'],na.rm=T),digits=2)` (`r round(standard_error(D_data$f_RS[D_data$Arena=='Large']),digits=2)`)
```{r , warning=FALSE, message=FALSE, results='hide'}
mean(D_data$f_RS[D_data$Arena=='Large'],na.rm=T)
standard_error(D_data$f_RS[D_data$Arena=='Large'])
```

Reproductive success in small arena size (SE) = `r round(mean(D_data$f_RS[D_data$Arena=='Small'],na.rm=T),digits=2)` (`r round(standard_error(D_data$f_RS[D_data$Arena=='Small']),digits=2)`)
```{r, warning=FALSE, message=FALSE, results='hide'}
mean(D_data$f_RS[D_data$Arena=='Small'],na.rm=T)
standard_error(D_data$f_RS[D_data$Arena=='Small'])
```

GLM for reproductive success including interaction between group and arena size treatment:
```{r , warning=FALSE, message=FALSE}
mod16=glm(f_RS~Gr_size*Arena,data=D_data,family = quasipoisson)
Anova(mod16,type=2)
```

GLM for reproductive success excluding interaction between group and arena size treatment:
```{r , warning=FALSE, message=FALSE}
mod16.1=glm(f_RS~Gr_size+Arena,data=D_data,family = quasipoisson)
summary(mod16.1)
Anova(mod16.1,type=2)
```

## Calculate adjusted p-values
We calculated adjusted p-values within sex and treatment using the false discovery rate correction (FDR).</br></br>
Adjusted p-values for population size treatment effect in females:
```{r , warning=FALSE, message=FALSE}
tab1=data.table(round(p.adjust(cbind(Anova(mod4.1,type=2)[1,3],Anova(mod6.1,type=2)[1,3],Anova(mod8.1,type=2)[1,3],Anova(mod10.1,type=2)[1,3],Anova(mod12.1,type=2)[1,3],Anova(mod14.1,type=2)[1,3],Anova(mod16.1,type=2)[1,3]), method = 'fdr'),digit=3)) # Compute FDR corrected p-values
traits=rbind('Copulation attempts','Copulations per attempt','Number of partners','Number copulations','Copulations per partner','Copulation duration','Reproductive success')
tab1= cbind(traits,tab1)
colnames(tab1)= cbind('Trait','Adj. p-value')
tab1
```

Adjusted p-values for arena size treatment effect in females:
```{r , warning=FALSE, message=FALSE}
tab2=data.table(round(p.adjust(cbind(Anova(mod4.1,type=2)[2,3],Anova(mod6.1,type=2)[2,3],Anova(mod8.1,type=2)[2,3],Anova(mod10.1,type=2)[2,3],Anova(mod12.1,type=2)[2,3],Anova(mod14.1,type=2)[2,3],Anova(mod16.1,type=2)[2,3]), method = 'fdr'),digit=3)) # Compute FDR corrected p-values
tab2= cbind(traits,tab2)
colnames(tab2)= cbind('Trait','Adj. p-value')
tab2
```

Adjusted p-values for population size treatment effect in males:
```{r , warning=FALSE, message=FALSE}
tab3=data.table(round(p.adjust(cbind(Anova(mod3.1,type=2)[1,3],Anova(mod5.1,type=2)[1,3],Anova(mod7.1,type=2)[1,3],Anova(mod9.1,type=2)[1,3],Anova(mod11.1,type=2)[1,3],Anova(mod13.1,type=2)[1,3],Anova(mod15.1,type=2)[1,3]), method = 'fdr'),digit=3)) # Compute FDR corrected p-values
tab3= cbind(traits,tab3)
colnames(tab3)= cbind('Trait','Adj. p-value')
tab3
```

Adjusted p-values for population size treatment effect in males:
```{r , warning=FALSE, message=FALSE}
tab4=data.table(round(p.adjust(cbind(Anova(mod3.1,type=2)[2,3],Anova(mod5.1,type=2)[2,3],Anova(mod7.1,type=2)[2,3],Anova(mod9.1,type=2)[2,3],Anova(mod11.1,type=2)[2,3],Anova(mod13.1,type=2)[2,3],Anova(mod15.1,type=2)[2,3]), method = 'fdr'),digit=3)) # Compute FDR corrected p-values
tab4= cbind(traits,tab4)
colnames(tab4)= cbind('Trait','Adj. p-value')
tab4
```

## Figures for mating behaviour and reproductive success (Figure S2-S4)

Here we plotted the mating behaviour and reproductive success per treatment and sex.
```{r , warning=FALSE, message=FALSE, results='hide'}
## Figures for mating behaviour and reproductive success (Figure S2-S4) ####

# Create factor for treatment categories
D_data$TreatCgroup <- factor(paste(D_data$Sex,D_data$Gr_size,  sep=" "), levels = c("F SG", "F LG", "M SG",'M LG'))
D_data$TreatCarena <- factor(paste(D_data$Sex,D_data$Arena,  sep=" "), levels = c("F Large", "F Small", "M Large",'M Small'))

p3<-ggplot(D_data, aes(x=Sex, y=as.numeric(Total_Encounters),fill=TreatCgroup, col=TreatCgroup,alpha=TreatCgroup)) +
  geom_point(position=position_jitterdodge(jitter.width=0.5,jitter.height = 0,dodge.width=1.2),shape=19, size = 2)+
  stat_summary(fun.min =lower_CI ,
               fun.max = upper_CI ,fun = mean,
               position=position_dodge2(0.3),col=c("#b2182b","#b2182b","#2166AC","#2166AC"),alpha=c(0.5,0.75,0.5,0.75),show.legend = F, linewidth = 1.15)+
  stat_summary(fun = mean,
               position=position_dodge2(0.3), size = 1,col=c("white","white","white","white"),alpha=c(1,1,1,1),show.legend = F, stroke = 0,linewidth = 1.2)+
  stat_summary(fun = mean,
               position=position_dodge2(0.3), size = 1,col=c("#b2182b","#b2182b","#2166AC","#2166AC"),alpha=c(0.5,0.75,0.5,0.75),show.legend = F, stroke = 0,linewidth = 1.2)+
 scale_color_manual(values=c(colpal2[1],colpal2[1],colpal2[2],colpal2[2]),name = "Treatment", labels = c('Small group','Large group','Small group','Large group'))+
  scale_fill_manual(values=c(colpal2[1],colpal2[1],colpal2[2],colpal2[2]),name = "Treatment", labels = c('Small group','Large group','Small group','Large group'))+
  scale_alpha_manual(values=c(0.5,0.75,0.5,0.75),name = "Treatment", labels = c('Small group','Large group','Small group','Large group'))+
  xlab('Sex')+ylab("Copulation attempts")+ggtitle('')+ theme(plot.title = element_text(hjust = 0.5))+
  scale_x_discrete(labels = c('Female','Male'),drop=FALSE)+ ylim(0,30)+labs(tag = "C")+
  annotate("text",label='n =',x=0.55,y=30,size=4)+
  annotate("text",label='54',x=0.78,y=30,size=4)+
  annotate("text",label='45',x=1.23,y=30,size=4)+
  annotate("text",label='46',x=1.78,y=30,size=4)+
  annotate("text",label='58',x=2.23,y=30,size=4)+
  guides(colour = guide_legend(override.aes = list(size=4)))+
  fig_theme

p3.2<-ggplot(D_data, aes(x=Sex, y=as.numeric(Total_Encounters),fill=TreatCarena, col=TreatCarena,alpha=TreatCarena)) +
  geom_point(position=position_jitterdodge(jitter.width=0.5,jitter.height = 0,dodge.width=1.2),shape=19, size = 2)+
  stat_summary(fun.min =lower_CI ,
               fun.max = upper_CI ,fun = mean,
               position=position_dodge2(0.3),col=c("#b2182b","#b2182b","#2166AC","#2166AC"),alpha=c(0.5,0.75,0.5,0.75),show.legend = F, linewidth = 1.15)+
  stat_summary(fun = mean,
               position=position_dodge2(0.3), size = 1,col=c("white","white","white","white"),alpha=c(1,1,1,1),show.legend = F, stroke = 0,linewidth = 1.2)+
  stat_summary(fun = mean,
               position=position_dodge2(0.3), size = 1,col=c("#b2182b","#b2182b","#2166AC","#2166AC"),alpha=c(0.5,0.75,0.5,0.75),show.legend = F, stroke = 0,linewidth = 1.2)+
scale_color_manual(values=c(colpal2[1],colpal2[1],colpal2[2],colpal2[2]),name = "Treatment", labels = c('Small arena','Large arena','Small arena','Large arena'))+
  scale_fill_manual(values=c(colpal2[1],colpal2[1],colpal2[2],colpal2[2]),name = "Treatment", labels = c('Small arena','Large arena','Small arena','Large arena'))+
  scale_alpha_manual(values=c(0.5,0.75,0.5,0.75),name = "Treatment", labels = c('Small arena','Large arena','Small arena','Large arena'))+
  xlab('Sex')+ylab("")+ggtitle('')+ theme(plot.title = element_text(hjust = 0.5))+
  scale_x_discrete(labels = c('Female','Male'),drop=FALSE)+ ylim(0,30)+labs(tag = "D")+
  annotate("text",label='n =',x=0.55,y=30,size=4)+
  annotate("text",label='51',x=0.78,y=30,size=4)+
  annotate("text",label='48',x=1.23,y=30,size=4)+
  annotate("text",label='55',x=1.78,y=30,size=4)+
  annotate("text",label='49',x=2.23,y=30,size=4)+
  guides(colour = guide_legend(override.aes = list(size=4)))+
  fig_theme

### Plot: Copulations per attempt ####
p4<-ggplot(D_data, aes(x=Sex, y=as.numeric(Prop_MS),fill=TreatCgroup, col=TreatCgroup,alpha=TreatCgroup)) +
  geom_point(position=position_jitterdodge(jitter.width=0.5,jitter.height = 0,dodge.width=1.2),shape=19, size = 2)+
  stat_summary(fun.min =lower_CI ,
               fun.max = upper_CI ,fun = mean,
               position=position_dodge2(0.3),col=c("#b2182b","#b2182b","#2166AC","#2166AC"),alpha=c(0.5,0.75,0.5,0.75),show.legend = F, linewidth = 1.15)+
  stat_summary(fun = mean,
               position=position_dodge2(0.3), size = 1,col=c("white","white","white","white"),alpha=c(1,1,1,1),show.legend = F, stroke = 0,linewidth = 1.2)+
  stat_summary(fun = mean,
               position=position_dodge2(0.3), size = 1,col=c("#b2182b","#b2182b","#2166AC","#2166AC"),alpha=c(0.5,0.75,0.5,0.75),show.legend = F, stroke = 0,linewidth = 1.2)+
  scale_color_manual(values=c(colpal2[1],colpal2[1],colpal2[2],colpal2[2]),name = "Treatment", labels = c('Small group','Large group','Small group','Large group'))+
  scale_fill_manual(values=c(colpal2[1],colpal2[1],colpal2[2],colpal2[2]),name = "Treatment", labels = c('Small group','Large group','Small group','Large group'))+
  scale_alpha_manual(values=c(0.5,0.75,0.5,0.75),name = "Treatment", labels = c('Small group','Large group','Small group','Large group'))+
  xlab('')+ylab("Copulations per attempt")+ggtitle('')+ theme(plot.title = element_text(hjust = 0.5))+
  scale_x_discrete(labels = c('Female','Male'),drop=FALSE)+ ylim(0,1.1)+labs(tag = "A")+
  annotate("text",label='n =',x=0.55,y=1.1,size=4)+
  annotate("text",label='54',x=0.78,y=1.1,size=4)+
  annotate("text",label='45',x=1.23,y=1.1,size=4)+
  annotate("text",label='46',x=1.78,y=1.1,size=4)+
  annotate("text",label='58',x=2.23,y=1.1,size=4)+
  guides(colour = guide_legend(override.aes = list(size=4)))+
  fig_theme

p4.2<-ggplot(D_data, aes(x=Sex, y=as.numeric(Prop_MS),fill=TreatCarena, col=TreatCarena,alpha=TreatCarena)) +
  geom_point(position=position_jitterdodge(jitter.width=0.5,jitter.height = 0,dodge.width=1.2),shape=19, size = 2)+
  stat_summary(fun.min =lower_CI ,
               fun.max = upper_CI ,fun = mean,
               position=position_dodge2(0.3),col=c("#b2182b","#b2182b","#2166AC","#2166AC"),alpha=c(0.5,0.75,0.5,0.75),show.legend = F, linewidth = 1.15)+
  stat_summary(fun = mean,
               position=position_dodge2(0.3), size = 1,col=c("white","white","white","white"),alpha=c(1,1,1,1),show.legend = F, stroke = 0,linewidth = 1.2)+
  stat_summary(fun = mean,
               position=position_dodge2(0.3), size = 1,col=c("#b2182b","#b2182b","#2166AC","#2166AC"),alpha=c(0.5,0.75,0.5,0.75),show.legend = F, stroke = 0,linewidth = 1.2)+
  scale_color_manual(values=c(colpal2[1],colpal2[1],colpal2[2],colpal2[2]),name = "Treatment", labels = c('Small arena','Large arena','Small arena','Large arena'))+
  scale_fill_manual(values=c(colpal2[1],colpal2[1],colpal2[2],colpal2[2]),name = "Treatment", labels = c('Small arena','Large arena','Small arena','Large arena'))+
  scale_alpha_manual(values=c(0.5,0.75,0.5,0.75),name = "Treatment", labels = c('Small arena','Large arena','Small arena','Large arena'))+
  xlab('')+ylab("")+ggtitle('')+ theme(plot.title = element_text(hjust = 0.5))+
  scale_x_discrete(labels = c('Female','Male'),drop=FALSE)+ ylim(0,1.1)+labs(tag = "B")+
  annotate("text",label='n =',x=0.55,y=1.1,size=4)+
  annotate("text",label='51',x=0.78,y=1.1,size=4)+
  annotate("text",label='48',x=1.23,y=1.1,size=4)+
  annotate("text",label='55',x=1.78,y=1.1,size=4)+
  annotate("text",label='49',x=2.23,y=1.1,size=4)+
  guides(colour = guide_legend(override.aes = list(size=4)))+
  fig_theme

### Plot: Mating partners focal ####
p5<-ggplot(D_data, aes(x=Sex, y=as.numeric(MatingPartners_number),fill=TreatCgroup, col=TreatCgroup,alpha=TreatCgroup)) +
  geom_point(position=position_jitterdodge(jitter.width=0.5,jitter.height = 0,dodge.width=1.2),shape=19, size = 2)+
  stat_summary(fun.min =lower_CI ,
               fun.max = upper_CI ,fun = mean,
               position=position_dodge2(0.3),col=c("#b2182b","#b2182b","#2166AC","#2166AC"),alpha=c(0.5,0.75,0.5,0.75),show.legend = F, linewidth = 1.15)+
  stat_summary(fun = mean,
               position=position_dodge2(0.3), size = 1,col=c("white","white","white","white"),alpha=c(1,1,1,1),show.legend = F, stroke = 0,linewidth = 1.2)+
  stat_summary(fun = mean,
               position=position_dodge2(0.3), size = 1,col=c("#b2182b","#b2182b","#2166AC","#2166AC"),alpha=c(0.5,0.75,0.5,0.75),show.legend = F, stroke = 0,linewidth = 1.2)+
  scale_color_manual(values=c(colpal2[1],colpal2[1],colpal2[2],colpal2[2]),name = "Treatment", labels = c('Small group','Large group','Small group','Large group'))+
  scale_fill_manual(values=c(colpal2[1],colpal2[1],colpal2[2],colpal2[2]),name = "Treatment", labels = c('Small group','Large group','Small group','Large group'))+
  scale_alpha_manual(values=c(0.5,0.75,0.5,0.75),name = "Treatment", labels = c('Small group','Large group','Small group','Large group'))+
  xlab('')+ylab("Number of partners")+ggtitle('')+ theme(plot.title = element_text(hjust = 0.5))+
  scale_x_discrete(labels = c('Female','Male'),drop=FALSE)+ ylim(0,5.4)+labs(tag = "C")+
  annotate("text",label='n =',x=0.55,y=5.4,size=4)+
  annotate("text",label='54',x=0.78,y=5.4,size=4)+
  annotate("text",label='45',x=1.23,y=5.4,size=4)+
  annotate("text",label='46',x=1.78,y=5.4,size=4)+
  annotate("text",label='58',x=2.23,y=5.4,size=4)+
  guides(colour = guide_legend(override.aes = list(size=4)))+
  fig_theme

p5.2<-ggplot(D_data, aes(x=Sex, y=as.numeric(MatingPartners_number),fill=TreatCarena, col=TreatCarena,alpha=TreatCarena)) +
  geom_point(position=position_jitterdodge(jitter.width=0.5,jitter.height = 0,dodge.width=1.2),shape=19, size = 2)+
  stat_summary(fun.min =lower_CI ,
               fun.max = upper_CI ,fun = mean,
               position=position_dodge2(0.3),col=c("#b2182b","#b2182b","#2166AC","#2166AC"),alpha=c(0.5,0.75,0.5,0.75),show.legend = F, linewidth = 1.15)+
  stat_summary(fun = mean,
               position=position_dodge2(0.3), size = 1,col=c("white","white","white","white"),alpha=c(1,1,1,1),show.legend = F, stroke = 0,linewidth = 1.2)+
  stat_summary(fun = mean,
               position=position_dodge2(0.3), size = 1,col=c("#b2182b","#b2182b","#2166AC","#2166AC"),alpha=c(0.5,0.75,0.5,0.75),show.legend = F, stroke = 0,linewidth = 1.2)+
  scale_color_manual(values=c(colpal2[1],colpal2[1],colpal2[2],colpal2[2]),name = "Treatment", labels = c('Small arena','Large arena','Small arena','Large arena'))+
  scale_fill_manual(values=c(colpal2[1],colpal2[1],colpal2[2],colpal2[2]),name = "Treatment", labels = c('Small arena','Large arena','Small arena','Large arena'))+
  scale_alpha_manual(values=c(0.5,0.75,0.5,0.75),name = "Treatment", labels = c('Small arena','Large arena','Small arena','Large arena'))+
  xlab('')+ylab("")+ggtitle('')+ theme(plot.title = element_text(hjust = 0.5))+
  scale_x_discrete(labels = c('Female','Male'),drop=FALSE)+ ylim(0,5.4)+labs(tag = "D")+
  annotate("text",label='n =',x=0.55,y=5.4,size=4)+
  annotate("text",label='51',x=0.78,y=5.4,size=4)+
  annotate("text",label='48',x=1.23,y=5.4,size=4)+
  annotate("text",label='55',x=1.78,y=5.4,size=4)+
  annotate("text",label='49',x=2.23,y=5.4,size=4)+
  guides(colour = guide_legend(override.aes = list(size=4)))+
  fig_theme

### Plot: Number copulations ####
p6<-ggplot(D_data, aes(x=Sex, y=as.numeric(Matings_number),fill=TreatCgroup, col=TreatCgroup,alpha=TreatCgroup)) +
  geom_point(position=position_jitterdodge(jitter.width=0.5,jitter.height = 0,dodge.width=1.2),shape=19, size = 2)+
  stat_summary(fun.min =lower_CI ,
               fun.max = upper_CI ,fun = mean,
               position=position_dodge2(0.3),col=c("#b2182b","#b2182b","#2166AC","#2166AC"),alpha=c(0.5,0.75,0.5,0.75),show.legend = F, linewidth = 1.15)+
  stat_summary(fun = mean,
               position=position_dodge2(0.3), size = 1,col=c("white","white","white","white"),alpha=c(1,1,1,1),show.legend = F, stroke = 0,linewidth = 1.2)+
  stat_summary(fun = mean,
               position=position_dodge2(0.3), size = 1,col=c("#b2182b","#b2182b","#2166AC","#2166AC"),alpha=c(0.5,0.75,0.5,0.75),show.legend = F, stroke = 0,linewidth = 1.2)+
  scale_color_manual(values=c(colpal2[1],colpal2[1],colpal2[2],colpal2[2]),name = "Treatment", labels = c('Small group','Large group','Small group','Large group'))+
  scale_fill_manual(values=c(colpal2[1],colpal2[1],colpal2[2],colpal2[2]),name = "Treatment", labels = c('Small group','Large group','Small group','Large group'))+
  scale_alpha_manual(values=c(0.5,0.75,0.5,0.75),name = "Treatment", labels = c('Small group','Large group','Small group','Large group'))+
  xlab('')+ylab("Number of copulations")+ggtitle('')+ theme(plot.title = element_text(hjust = 0.5))+
  scale_x_discrete(labels = c('Female','Male'),drop=FALSE)+ ylim(0,12)+labs(tag = "A")+
  annotate("text",label='n =',x=0.55,y=12,size=4)+
  annotate("text",label='54',x=0.78,y=12,size=4)+
  annotate("text",label='45',x=1.23,y=12,size=4)+
  annotate("text",label='46',x=1.78,y=12,size=4)+
  annotate("text",label='58',x=2.23,y=12,size=4)+
  guides(colour = guide_legend(override.aes = list(size=4)))+
  fig_theme

p6.2<-ggplot(D_data, aes(x=Sex, y=as.numeric(Matings_number),fill=TreatCarena, col=TreatCarena,alpha=TreatCarena)) +
  geom_point(position=position_jitterdodge(jitter.width=0.5,jitter.height = 0,dodge.width=1.2),shape=19, size = 2)+
  stat_summary(fun.min =lower_CI ,
               fun.max = upper_CI ,fun = mean,
               position=position_dodge2(0.3),col=c("#b2182b","#b2182b","#2166AC","#2166AC"),alpha=c(0.5,0.75,0.5,0.75),show.legend = F, linewidth = 1.15)+
  stat_summary(fun = mean,
               position=position_dodge2(0.3), size = 1,col=c("white","white","white","white"),alpha=c(1,1,1,1),show.legend = F, stroke = 0,linewidth = 1.2)+
  stat_summary(fun = mean,
               position=position_dodge2(0.3), size = 1,col=c("#b2182b","#b2182b","#2166AC","#2166AC"),alpha=c(0.5,0.75,0.5,0.75),show.legend = F, stroke = 0,linewidth = 1.2)+
  scale_color_manual(values=c(colpal2[1],colpal2[1],colpal2[2],colpal2[2]),name = "Treatment", labels = c('Small arena','Large arena','Small arena','Large arena'))+
  scale_fill_manual(values=c(colpal2[1],colpal2[1],colpal2[2],colpal2[2]),name = "Treatment", labels = c('Small arena','Large arena','Small arena','Large arena'))+
  scale_alpha_manual(values=c(0.5,0.75,0.5,0.75),name = "Treatment", labels = c('Small arena','Large arena','Small arena','Large arena'))+
  xlab('')+ylab("")+ggtitle('')+ theme(plot.title = element_text(hjust = 0.5))+labs(tag = "B")+
  scale_x_discrete(labels = c('Female','Male'),drop=FALSE)+ ylim(0,12)+
  annotate("text",label='n =',x=0.55,y=12,size=4)+
  annotate("text",label='51',x=0.78,y=12,size=4)+
  annotate("text",label='48',x=1.23,y=12,size=4)+
  annotate("text",label='55',x=1.78,y=12,size=4)+
  annotate("text",label='49',x=2.23,y=12,size=4)+
  guides(colour = guide_legend(override.aes = list(size=4)))+
  fig_theme

###Plot: Copulations per partner ####
p7<-ggplot(D_data, aes(x=Sex, y=as.numeric(meanCop),fill=TreatCgroup, col=TreatCgroup,alpha=TreatCgroup)) +
  geom_point(position=position_jitterdodge(jitter.width=0.5,jitter.height = 0,dodge.width=1.2),shape=19, size = 2)+
  stat_summary(fun.min =lower_CI ,
               fun.max = upper_CI ,fun = mean,
               position=position_dodge2(0.3),col=c("#b2182b","#b2182b","#2166AC","#2166AC"),alpha=c(0.5,0.75,0.5,0.75),show.legend = F, linewidth = 1.15)+
  stat_summary(fun = mean,
               position=position_dodge2(0.3), size = 1,col=c("white","white","white","white"),alpha=c(1,1,1,1),show.legend = F, stroke = 0,linewidth = 1.2)+
  stat_summary(fun = mean,
               position=position_dodge2(0.3), size = 1,col=c("#b2182b","#b2182b","#2166AC","#2166AC"),alpha=c(0.5,0.75,0.5,0.75),show.legend = F, stroke = 0,linewidth = 1.2)+
  scale_color_manual(values=c(colpal2[1],colpal2[1],colpal2[2],colpal2[2]),name = "Treatment", labels = c('Small group','Large group','Small group','Large group'))+
  scale_fill_manual(values=c(colpal2[1],colpal2[1],colpal2[2],colpal2[2]),name = "Treatment", labels = c('Small group','Large group','Small group','Large group'))+
  scale_alpha_manual(values=c(0.5,0.75,0.5,0.75),name = "Treatment", labels = c('Small group','Large group','Small group','Large group'))+
  xlab('Sex')+ylab("Copulations per partner")+ggtitle('')+ theme(plot.title = element_text(hjust = 0.5))+
  scale_x_discrete(labels = c('Female','Male'),drop=FALSE)+ labs(tag = "C")+ylim(1,4.5)+
  annotate("text",label='n =',x=0.55,y=4.5,size=4)+
  annotate("text",label='54',x=0.78,y=4.5,size=4)+
  annotate("text",label='45',x=1.23,y=4.5,size=4)+
  annotate("text",label='46',x=1.78,y=4.5,size=4)+
  annotate("text",label='58',x=2.23,y=4.5,size=4)+
  guides(colour = guide_legend(override.aes = list(size=4)))+
  fig_theme

p7.2<-ggplot(D_data, aes(x=Sex, y=as.numeric(meanCop),fill=TreatCarena, col=TreatCarena,alpha=TreatCarena)) +
  geom_point(position=position_jitterdodge(jitter.width=0.5,jitter.height = 0,dodge.width=1.2),shape=19, size = 2)+
  stat_summary(fun.min =lower_CI ,
               fun.max = upper_CI ,fun = mean,
               position=position_dodge2(0.3),col=c("#b2182b","#b2182b","#2166AC","#2166AC"),alpha=c(0.5,0.75,0.5,0.75),show.legend = F, linewidth = 1.15)+
  stat_summary(fun = mean,
               position=position_dodge2(0.3), size = 1,col=c("white","white","white","white"),alpha=c(1,1,1,1),show.legend = F, stroke = 0,linewidth = 1.2)+
  stat_summary(fun = mean,
               position=position_dodge2(0.3), size = 1,col=c("#b2182b","#b2182b","#2166AC","#2166AC"),alpha=c(0.5,0.75,0.5,0.75),show.legend = F, stroke = 0,linewidth = 1.2)+
  scale_color_manual(values=c(colpal2[1],colpal2[1],colpal2[2],colpal2[2]),name = "Treatment", labels = c('Small arena','Large arena','Small arena','Large arena'))+
  scale_fill_manual(values=c(colpal2[1],colpal2[1],colpal2[2],colpal2[2]),name = "Treatment", labels = c('Small arena','Large arena','Small arena','Large arena'))+
  scale_alpha_manual(values=c(0.5,0.75,0.5,0.75),name = "Treatment", labels = c('Small arena','Large arena','Small arena','Large arena'))+
  xlab('Sex')+ylab("")+ggtitle('')+ theme(plot.title = element_text(hjust = 0.5))+
  scale_x_discrete(labels = c('Female','Male'),drop=FALSE)+ ylim(1,4.5)+labs(tag = "D")+
  annotate("text",label='n =',x=0.55,y=4.5,size=4)+
  annotate("text",label='51',x=0.78,y=4.5,size=4)+
  annotate("text",label='48',x=1.23,y=4.5,size=4)+
  annotate("text",label='55',x=1.78,y=4.5,size=4)+
  annotate("text",label='49',x=2.23,y=4.5,size=4)+
  guides(colour = guide_legend(override.aes = list(size=4)))+
  fig_theme

### Plot: Copulation duration ####
p8<-ggplot(D_data, aes(x=Sex, y=as.numeric(MatingDuration_av),fill=TreatCgroup, col=TreatCgroup,alpha=TreatCgroup)) +
  geom_point(position=position_jitterdodge(jitter.width=0.5,jitter.height = 0,dodge.width=1.2),shape=19, size = 2)+
  stat_summary(fun.min =lower_CI ,
               fun.max = upper_CI ,fun = mean,
               position=position_dodge2(0.3),col=c("#b2182b","#b2182b","#2166AC","#2166AC"),alpha=c(0.5,0.75,0.5,0.75),show.legend = F, linewidth = 1.15)+
  stat_summary(fun = mean,
               position=position_dodge2(0.3), size = 1,col=c("white","white","white","white"),alpha=c(1,1,1,1),show.legend = F, stroke = 0,linewidth = 1.2)+
  stat_summary(fun = mean,
               position=position_dodge2(0.3), size = 1,col=c("#b2182b","#b2182b","#2166AC","#2166AC"),alpha=c(0.5,0.75,0.5,0.75),show.legend = F, stroke = 0,linewidth = 1.2)+
  scale_color_manual(values=c(colpal2[1],colpal2[1],colpal2[2],colpal2[2]),name = "Treatment", labels = c('Small group','Large group','Small group','Large group'))+
  scale_fill_manual(values=c(colpal2[1],colpal2[1],colpal2[2],colpal2[2]),name = "Treatment", labels = c('Small group','Large group','Small group','Large group'))+
  scale_alpha_manual(values=c(0.5,0.75,0.5,0.75),name = "Treatment", labels = c('Small group','Large group','Small group','Large group'))+
  xlab('Sex')+ylab("Mean copulation duration")+ggtitle('')+ theme(plot.title = element_text(hjust = 0.5))+
  scale_x_discrete(labels = c('Female','Male'),drop=FALSE)+ ylim(0,390)+labs(tag = "E")+
  annotate("text",label='n =',x=0.55,y=390,size=4)+
  annotate("text",label='49',x=0.78,y=390,size=4)+
  annotate("text",label='34',x=1.23,y=390,size=4)+
  annotate("text",label='43',x=1.78,y=390,size=4)+
  annotate("text",label='51',x=2.23,y=390,size=4)+
  guides(colour = guide_legend(override.aes = list(size=4)))+
  fig_theme

p8.2<-ggplot(D_data, aes(x=Sex, y=as.numeric(MatingDuration_av),fill=TreatCarena, col=TreatCarena,alpha=TreatCarena)) +
  geom_point(position=position_jitterdodge(jitter.width=0.5,jitter.height = 0,dodge.width=1.2),shape=19, size = 2)+
  stat_summary(fun.min =lower_CI ,
               fun.max = upper_CI ,fun = mean,
               position=position_dodge2(0.3),col=c("#b2182b","#b2182b","#2166AC","#2166AC"),alpha=c(0.5,0.75,0.5,0.75),show.legend = F, linewidth = 1.15)+
  stat_summary(fun = mean,
               position=position_dodge2(0.3), size = 1,col=c("white","white","white","white"),alpha=c(1,1,1,1),show.legend = F, stroke = 0,linewidth = 1.2)+
  stat_summary(fun = mean,
               position=position_dodge2(0.3), size = 1,col=c("#b2182b","#b2182b","#2166AC","#2166AC"),alpha=c(0.5,0.75,0.5,0.75),show.legend = F, stroke = 0,linewidth = 1.2)+
  scale_color_manual(values=c(colpal2[1],colpal2[1],colpal2[2],colpal2[2]),name = "Treatment", labels = c('Small arena','Large arena','Small arena','Large arena'))+
  scale_fill_manual(values=c(colpal2[1],colpal2[1],colpal2[2],colpal2[2]),name = "Treatment", labels = c('Small arena','Large arena','Small arena','Large arena'))+
  scale_alpha_manual(values=c(0.5,0.75,0.5,0.75),name = "Treatment", labels = c('Small arena','Large arena','Small arena','Large arena'))+
  xlab('Sex')+ylab("")+ggtitle('')+ theme(plot.title = element_text(hjust = 0.5))+
  scale_x_discrete(labels = c('Female','Male'),drop=FALSE)+ ylim(0,390)+labs(tag = "F")+
  annotate("text",label='n =',x=0.55,y=390,size=4)+
  annotate("text",label='46',x=0.78,y=390,size=4)+
  annotate("text",label='37',x=1.23,y=390,size=4)+
  annotate("text",label='49',x=1.78,y=390,size=4)+
  annotate("text",label='45',x=2.23,y=390,size=4)+
  guides(colour = guide_legend(override.aes = list(size=4)))+
  fig_theme

###Plot: Reproductive success ####
p9<-ggplot(D_data, aes(x=Sex, y=as.numeric(Total_N_MTP1),fill=TreatCgroup, col=TreatCgroup,alpha=TreatCgroup)) +
  geom_point(position=position_jitterdodge(jitter.width=0.5,jitter.height = 0,dodge.width=1.2),shape=19, size = 2)+
  stat_summary(fun.min =lower_CI ,
               fun.max = upper_CI ,fun = mean,
               position=position_dodge2(0.3),col=c("#b2182b","#b2182b","#2166AC","#2166AC"),alpha=c(0.5,0.75,0.5,0.75),show.legend = F, linewidth = 1.15)+
  stat_summary(fun = mean,
               position=position_dodge2(0.3), size = 1,col=c("white","white","white","white"),alpha=c(1,1,1,1),show.legend = F, stroke = 0,linewidth = 1.2)+
  stat_summary(fun = mean,
               position=position_dodge2(0.3), size = 1,col=c("#b2182b","#b2182b","#2166AC","#2166AC"),alpha=c(0.5,0.75,0.5,0.75),show.legend = F, stroke = 0,linewidth = 1.2)+
 scale_color_manual(values=c(colpal2[1],colpal2[1],colpal2[2],colpal2[2]),name = "Treatment", labels = c('Small group','Large group','Small group','Large group'))+
  scale_fill_manual(values=c(colpal2[1],colpal2[1],colpal2[2],colpal2[2]),name = "Treatment", labels = c('Small group','Large group','Small group','Large group'))+
  scale_alpha_manual(values=c(0.5,0.75,0.5,0.75),name = "Treatment", labels = c('Small group','Large group','Small group','Large group'))+
  xlab('Sex')+ylab("Number of offspring")+ggtitle('')+ theme(plot.title = element_text(hjust = 0.5))+
  scale_x_discrete(labels = c('Female','Male'),drop=FALSE)+ ylim(0,320)+labs(tag = "A")+
  annotate("text",label='n =',x=0.55,y=320,size=4)+
  annotate("text",label='54',x=0.78,y=320,size=4)+
  annotate("text",label='45',x=1.23,y=320,size=4)+
  annotate("text",label='46',x=1.78,y=320,size=4)+
  annotate("text",label='58',x=2.23,y=320,size=4)+
  guides(colour = guide_legend(override.aes = list(size=4)))+
  fig_theme

p9.2<-ggplot(D_data, aes(x=Sex, y=as.numeric(Total_N_MTP1),fill=TreatCarena, col=TreatCarena,alpha=TreatCarena)) +
  geom_point(position=position_jitterdodge(jitter.width=0.5,jitter.height = 0,dodge.width=1.2),shape=19, size = 2)+
  stat_summary(fun.min =lower_CI ,
               fun.max = upper_CI ,fun = mean,
               position=position_dodge2(0.3),col=c("#b2182b","#b2182b","#2166AC","#2166AC"),alpha=c(0.5,0.75,0.5,0.75),show.legend = F, linewidth = 1.15)+
  stat_summary(fun = mean,
               position=position_dodge2(0.3), size = 1,col=c("white","white","white","white"),alpha=c(1,1,1,1),show.legend = F, stroke = 0,linewidth = 1.2)+
  stat_summary(fun = mean,
               position=position_dodge2(0.3), size = 1,col=c("#b2182b","#b2182b","#2166AC","#2166AC"),alpha=c(0.5,0.75,0.5,0.75),show.legend = F, stroke = 0,linewidth = 1.2)+
  scale_color_manual(values=c(colpal2[1],colpal2[1],colpal2[2],colpal2[2]),name = "Treatment", labels = c('Small arena','Large arena','Small arena','Large arena'))+
  scale_fill_manual(values=c(colpal2[1],colpal2[1],colpal2[2],colpal2[2]),name = "Treatment", labels = c('Small arena','Large arena','Small arena','Large arena'))+
  scale_alpha_manual(values=c(0.5,0.75,0.5,0.75),name = "Treatment", labels = c('Small arena','Large arena','Small arena','Large arena'))+
  xlab('Sex')+ylab("")+ggtitle('')+ theme(plot.title = element_text(hjust = 0.5))+
  scale_x_discrete(labels = c('Female','Male'),drop=FALSE)+ ylim(0,320)+labs(tag = "B")+
  annotate("text",label='n =',x=0.55,y=320,size=4)+
  annotate("text",label='51',x=0.78,y=320,size=4)+
  annotate("text",label='48',x=1.23,y=320,size=4)+
  annotate("text",label='55',x=1.78,y=320,size=4)+
  annotate("text",label='49',x=2.23,y=320,size=4)+
  guides(colour = guide_legend(override.aes = list(size=4)))+
  fig_theme
```

### Figure S2
```{r , warning=FALSE, message=FALSE, fig.align="left",fig.width = 9, fig.height=11, results='hide',fig.cap='Figure S2: Mating behavior of males and females under low and high density manipulation via group (left) and arena size (right). Bars indicate means and 95% CI.',fig.fullwidth=TRUE}
#Behaviour 1 (Figure S2)
Figure_S2<-grid.arrange(p3+labs(tag = "A")+xlab('')+theme(legend.position = c(1.25, 0.8),plot.margin = unit(c(0.2,3.5,0,0.1), "cm"),legend.text = element_text(size=9)),p3.2+
                          labs(tag = "B")+xlab('')+theme(legend.position = c(1.25, 0.8),plot.margin = unit(c(0.2,3.5,0,0.1), "cm"),legend.text = element_text(size=9)),
                        p4+labs(tag = "C")+xlab('')+theme(legend.position = 'none',plot.margin = unit(c(0.2,3.5,0,0.1), "cm")),p4.2+labs(tag = "D")+xlab('')+theme(legend.position = 'none',plot.margin = unit(c(0.2,3.5,0,0.1), "cm")),
                        p5+labs(tag = "E")+xlab('Sex')+theme(legend.position = 'none',plot.margin = unit(c(0.2,3.5,0,0.1), "cm")),p5.2+labs(tag = "F")+xlab('Sex')+theme(legend.position = 'none',plot.margin = unit(c(0.2,3.5,0,0.1), "cm"))
                        ,nrow = 3,ncol=2)
Figure_S2 = plot_grid(Figure_S2, ncol=1, rel_heights=c(0.1, 1)) # rel_heights values control title margins
```

### Figure S3
```{r , warning=FALSE, message=FALSE, fig.align="left",fig.width = 9, fig.height=11, results='hide',fig.cap='Figure S3: Mating behavior of males and females under low and high density manipulation via group (left) and arena size (right). Bars indicate means and 95% CI.',fig.fullwidth=TRUE}
#Behavior 2 (Figure S3)
Figure_S3<-grid.arrange(p6+labs(tag = "A")+xlab('')+theme(legend.position = c(1.25, 0.8),plot.margin = unit(c(0.2,3.5,0,0.1), "cm"),legend.text = element_text(size=9)),p6.2+labs(tag = "B")+xlab('')+theme(legend.position = c(1.25, 0.8),plot.margin = unit(c(0.2,3.5,0,0.1), "cm"),legend.text = element_text(size=9)),
                        p7+labs(tag = "C")+xlab('')+theme(legend.position = 'none',plot.margin = unit(c(0.2,3.5,0,0.1), "cm")),p7.2+labs(tag = "D")+xlab('')+theme(legend.position = 'none',plot.margin = unit(c(0.2,3.5,0,0.1), "cm")),
                        p8+labs(tag = "E")+xlab('Sex')+theme(legend.position = 'none',plot.margin = unit(c(0.2,3.5,0,0.1), "cm")),p8.2+labs(tag = "F")+xlab('Sex')+theme(legend.position = 'none',plot.margin = unit(c(0.2,3.5,0,0.1), "cm")),nrow = 3,ncol=2)
Figure_S3 = plot_grid(Figure_S3, ncol=1, rel_heights=c(0.1, 1)) # rel_heights values control title margins
```

### Figure S4
```{r , warning=FALSE, message=FALSE, fig.align="left",fig.width = 11,fig.height=6, results='hide',fig.cap='Figure S4: Reproductive success of males and females under density manipulation via group (left) and arena size (right). Bars indicate means and 95% CI.',fig.fullwidth=TRUE}
# Reproductive success (Figure S4)
Figure_S4<-grid.arrange(grobs = list(p9+theme(legend.position = c(1.2, 0.8),plot.margin = unit(c(0.2,4,0,0.3), "cm")),p9.2+theme(legend.position = c(1.2, 0.8),plot.margin = unit(c(0.2,4,0,0.3), "cm"))), nrow = 1,ncol=2, widths=c(2.3, 2.3))
Figure_S4 = plot_grid(Figure_S4, ncol=1, rel_heights=c(0.1, 1)) # rel_heights values control title margins
```
