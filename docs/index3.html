<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Lennart Winkler1, Ronja Eilhardt1 &amp; Tim Janicke1,2   1Applied Zoology, Technical University Dresden   2Centre d’Écologie Fonctionnelle et Évolutive, UMR 5175, CNRS, Université de Montpellier" />


<title>Population density affects sexual selection in the red flour beetle</title>

<script src="site_libs/header-attrs-2.14/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/yeti.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>

<link rel="icon" href="https://github.com/workflowr/workflowr-assets/raw/main/img/reproducible.png">
<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>



<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>







<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Population density affects sexual selection in the red flour beetle</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="start.html">Home</a>
</li>
<li>
  <a href="index.html">Analyses 1</a>
</li>
<li>
  <a href="index2.html">Analyses 2</a>
</li>
<li>
  <a href="index3.html">Analyses 3</a>
</li>
<li>
  <a href="index4.html">Analyses 4</a>
</li>
<li>
  <a href="index5.html">Analyses 5</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Population density affects sexual selection
in the red flour beetle</h1>
<h3 class="subtitle">Analyses on body mass of focal individuals</h3>
<h4 class="author">Lennart Winkler<sup>1</sup>, Ronja
Eilhardt<sup>1</sup> &amp; Tim Janicke<sup>1,2</sup> <br></br>
<sup>1</sup>Applied Zoology, Technical University Dresden <br>
<sup>2</sup>Centre d’Écologie Fonctionnelle et Évolutive, UMR 5175,
CNRS, Université de Montpellier</br></h4>

</div>


<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-report" data-toggle="collapse" data-target="#workflowr-report">
<span class="glyphicon glyphicon-list" aria-hidden="true"></span>
workflowr <span class="glyphicon glyphicon-exclamation-sign text-danger"
aria-hidden="true"></span>
</button>
</p>
<div id="workflowr-report" class="collapse">
<ul class="nav nav-tabs">
<li class="active">
<a data-toggle="tab" href="#summary">Summary</a>
</li>
<li>
<a data-toggle="tab" href="#checks"> Checks <span
class="glyphicon glyphicon-exclamation-sign text-danger"
aria-hidden="true"></span> </a>
</li>
<li>
<a data-toggle="tab" href="#versions">Past versions</a>
</li>
</ul>
<div class="tab-content">
<div id="summary" class="tab-pane fade in active">
<p>
<strong>Last updated:</strong> 2022-07-24
</p>
<p>
<strong>Checks:</strong> <span
class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> 6
<span class="glyphicon glyphicon-exclamation-sign text-danger"
aria-hidden="true"></span> 1
</p>
<p>
<strong>Knit directory:</strong>
<code>Density_and_sexual_selection_2022/</code> <span
class="glyphicon glyphicon-question-sign" aria-hidden="true"
title="This is the local directory in which the code in this file was executed.">
</span>
</p>
<p>
This reproducible <a href="https://rmarkdown.rstudio.com">R Markdown</a>
analysis was created with <a
  href="https://github.com/workflowr/workflowr">workflowr</a> (version
1.7.0). The <em>Checks</em> tab describes the reproducibility checks
that were applied when the results were created. The <em>Past
versions</em> tab lists the development history.
</p>
<hr>
</div>
<div id="checks" class="tab-pane fade">
<div id="workflowr-checks" class="panel-group">
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRMarkdownfilestronguncommittedchanges">
<span class="glyphicon glyphicon-exclamation-sign text-danger"
aria-hidden="true"></span> <strong>R Markdown file:</strong> uncommitted
changes </a>
</p>
</div>
<div id="strongRMarkdownfilestronguncommittedchanges"
class="panel-collapse collapse">
<div class="panel-body">
<p>The R Markdown is untracked by Git. To know which version of the R
Markdown file created these results, you’ll want to first commit it to
the Git repo. If you’re still working on the analysis, you can ignore
this warning. When you’re finished, you can run
<code>wflow_publish</code> to commit the R Markdown file and build the
HTML.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongEnvironmentstrongempty">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Environment:</strong> empty </a>
</p>
</div>
<div id="strongEnvironmentstrongempty" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! The global environment was empty. Objects defined in the
global environment can affect the analysis in your R Markdown file in
unknown ways. For reproduciblity it’s best to always run the code in an
empty environment.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSeedstrongcodesetseed20210613code">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Seed:</strong>
<code>set.seed(20210613)</code> </a>
</p>
</div>
<div id="strongSeedstrongcodesetseed20210613code"
class="panel-collapse collapse">
<div class="panel-body">
<p>The command <code>set.seed(20210613)</code> was run prior to running
the code in the R Markdown file. Setting a seed ensures that any results
that rely on randomness, e.g. subsampling or permutations, are
reproducible.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSessioninformationstrongrecorded">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Session information:</strong>
recorded </a>
</p>
</div>
<div id="strongSessioninformationstrongrecorded"
class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Recording the operating system, R version, and package
versions is critical for reproducibility.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongCachestrongnone">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Cache:</strong> none </a>
</p>
</div>
<div id="strongCachestrongnone" class="panel-collapse collapse">
<div class="panel-body">
<p>Nice! There were no cached chunks for this analysis, so you can be
confident that you successfully produced the results during this
run.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongFilepathsstrongrelative">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>File paths:</strong> relative </a>
</p>
</div>
<div id="strongFilepathsstrongrelative" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Using relative paths to the files within your workflowr
project makes it easier to run your code on other machines.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRepositoryversionstrongahrefhttpsgithubcomLennartWinklerDensityandsexualselection2022treea92075dda2bc9b3d7c6363c2b2c9521f2fea18eetargetblanka92075da">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Repository version:</strong>
<a href="https://github.com/LennartWinkler/Density_and_sexual_selection_2022/tree/a92075dda2bc9b3d7c6363c2b2c9521f2fea18ee" target="_blank">a92075d</a>
</a>
</p>
</div>
<div
id="strongRepositoryversionstrongahrefhttpsgithubcomLennartWinklerDensityandsexualselection2022treea92075dda2bc9b3d7c6363c2b2c9521f2fea18eetargetblanka92075da"
class="panel-collapse collapse">
<div class="panel-body">
<p>
Great! You are using Git for version control. Tracking code development
and connecting the code version to the results is critical for
reproducibility.
</p>
<p>
The results in this page were generated with repository version
<a href="https://github.com/LennartWinkler/Density_and_sexual_selection_2022/tree/a92075dda2bc9b3d7c6363c2b2c9521f2fea18ee" target="_blank">a92075d</a>.
See the <em>Past versions</em> tab to see a history of the changes made
to the R Markdown and HTML files.
</p>
<p>
Note that you need to be careful to ensure that all relevant files for
the analysis have been committed to Git prior to generating the results
(you can use <code>wflow_publish</code> or
<code>wflow_git_commit</code>). workflowr only checks the R Markdown
file, but you know if there are other scripts or data files that it
depends on. Below is the status of the Git repository when the results
were generated:
</p>
<pre><code>
Ignored files:
    Ignored:    .Rhistory
    Ignored:    .Rproj.user/

Untracked files:
    Untracked:  analysis/index2.Rmd
    Untracked:  analysis/index3.Rmd
    Untracked:  analysis/index4.Rmd
    Untracked:  analysis/index5.Rmd
    Untracked:  analysis/start.Rmd

Unstaged changes:
    Modified:   analysis/_site.yml
    Modified:   analysis/index.Rmd

</code></pre>
<p>
Note that any generated files, e.g. HTML, png, CSS, etc., are not
included in this status report because it is ok for generated content to
have uncommitted changes.
</p>
</div>
</div>
</div>
</div>
<hr>
</div>
<div id="versions" class="tab-pane fade">
<p>
There are no past versions. Publish this analysis with
<code>wflow_publish()</code> to start tracking its development.
</p>
<hr>
</div>
</div>
</div>
<p>Supplementary material reporting R code for the manuscript
‘Population density affects sexual selection in the red flour
beetle’.</p>
<div id="load-and-prepare-data" class="section level1">
<h1>Load and prepare data</h1>
<p>Before we started the analyses, we loaded all necessary packages and
data.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#load packages</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggeffects)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(EnvStats)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridGraphics)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(base)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ICC)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="co">#load data</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>DB_data<span class="ot">=</span><span class="fu">read_delim</span>(<span class="st">&quot;./data/DB_AllData_V04.CSV&quot;</span>,<span class="st">&quot;;&quot;</span>, <span class="at">escape_double =</span> <span class="cn">FALSE</span>, <span class="at">trim_ws =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="co">#Set factors and level factors</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>Week<span class="ot">=</span><span class="fu">as.factor</span>(DB_data<span class="sc">$</span>Week)</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>Date<span class="ot">=</span><span class="fu">as.factor</span>(DB_data<span class="sc">$</span>Date)</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>Sex<span class="ot">=</span><span class="fu">as.factor</span>(DB_data<span class="sc">$</span>Sex)</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>Gr_size<span class="ot">=</span><span class="fu">as.factor</span>(DB_data<span class="sc">$</span>Gr_size)</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>Gr_size <span class="ot">&lt;-</span> <span class="fu">factor</span>(DB_data<span class="sc">$</span>Gr_size, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;SG&quot;</span>,<span class="st">&quot;LG&quot;</span>))</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>Area<span class="ot">=</span><span class="fu">as.factor</span>(DB_data<span class="sc">$</span>Area)</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a><span class="co">#Load Body mass data</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>DB_BM_female <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="st">&quot;./data/DB_mass_focals_female.CSV&quot;</span>, </span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;;&quot;</span>, <span class="at">escape_double =</span> <span class="cn">FALSE</span>, <span class="at">trim_ws =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>DB_BM_male <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="st">&quot;./data/DB_mass_focals_males.CSV&quot;</span>, </span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;;&quot;</span>, <span class="at">escape_double =</span> <span class="cn">FALSE</span>, <span class="at">trim_ws =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>DB_data_m<span class="ot">=</span><span class="fu">merge</span>(DB_data,DB_BM_male,<span class="at">by.x =</span> <span class="st">&#39;Well_ID&#39;</span>,<span class="at">by.y =</span> <span class="st">&#39;ID_male_focals&#39;</span>)</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>DB_data_f<span class="ot">=</span><span class="fu">merge</span>(DB_data,DB_BM_female,<span class="at">by.x =</span> <span class="st">&#39;F1_ID&#39;</span>,<span class="at">by.y =</span> <span class="st">&#39;ID_female_focals&#39;</span>)</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>DB_data<span class="ot">=</span><span class="fu">rbind</span>(DB_data_m,DB_data_f)</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a><span class="do">###Exclude incomplete data</span></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>DB_data<span class="ot">=</span>DB_data[DB_data<span class="sc">$</span>excluded<span class="sc">!=</span><span class="dv">1</span>,]</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculate total offspring number ####</span></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>Total_N_MTP1<span class="ot">=</span><span class="fu">colSums</span>(<span class="fu">rbind</span>(DB_data<span class="sc">$</span>N_MTP1_1,DB_data<span class="sc">$</span>N_MTP1_2,DB_data<span class="sc">$</span>N_MTP1_3,DB_data<span class="sc">$</span>N_MTP1_4,DB_data<span class="sc">$</span>N_MTP1_5,DB_data<span class="sc">$</span>N_MTP1_6), <span class="at">na.rm =</span> T)</span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>Total_N_Rd<span class="ot">=</span><span class="fu">colSums</span>(<span class="fu">rbind</span>(DB_data<span class="sc">$</span>N_RD_1,DB_data<span class="sc">$</span>N_RD_2,DB_data<span class="sc">$</span>N_RD_3,DB_data<span class="sc">$</span>N_RD_4,DB_data<span class="sc">$</span>N_RD_5,DB_data<span class="sc">$</span>N_RD_6), <span class="at">na.rm =</span> T)<span class="sc">/</span>DB_data<span class="sc">$</span>N_comp</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculate proportional RS ####</span></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a><span class="co">#Percentage focal offspring</span></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>m_prop_RS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>m_prop_RS<span class="ot">=</span>(DB_data<span class="sc">$</span>Total_N_MTP1<span class="sc">/</span>(DB_data<span class="sc">$</span>Total_N_MTP1<span class="sc">+</span>DB_data<span class="sc">$</span>Total_N_Rd))<span class="sc">*</span><span class="dv">100</span></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>m_prop_RS[DB_data<span class="sc">$</span>Sex<span class="sc">==</span><span class="st">&#39;F&#39;</span>]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>f_prop_RS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>f_prop_RS<span class="ot">=</span>(DB_data<span class="sc">$</span>Total_N_MTP1<span class="sc">/</span>(DB_data<span class="sc">$</span>Total_N_MTP1<span class="sc">+</span>DB_data<span class="sc">$</span>Total_N_Rd))<span class="sc">*</span><span class="dv">100</span></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>f_prop_RS[DB_data<span class="sc">$</span>Sex<span class="sc">==</span><span class="st">&#39;M&#39;</span>]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculate proportion of successful matings ####</span></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>Prop_MS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>Prop_MS<span class="ot">=</span>DB_data<span class="sc">$</span>Matings_number<span class="sc">/</span>(DB_data<span class="sc">$</span>Attempts_number<span class="sc">+</span>DB_data<span class="sc">$</span>Matings_number)</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>Prop_MS[DB_data<span class="sc">$</span>Prop_MS<span class="sc">==</span><span class="dv">0</span>]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculate total encounters ####</span></span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>Total_Encounters<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>Total_Encounters<span class="ot">=</span>DB_data<span class="sc">$</span>Attempts_number<span class="sc">+</span>DB_data<span class="sc">$</span>Matings_number</span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a><span class="co"># Treatment identifier for each density ####</span></span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>Treatment<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(n <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data<span class="sc">$</span>Sex)){<span class="cf">if</span>(DB_data<span class="sc">$</span>Gr_size[n]<span class="sc">==</span><span class="st">&#39;SG&#39;</span> <span class="sc">&amp;&amp;</span> DB_data<span class="sc">$</span>Area[n]<span class="sc">==</span><span class="st">&#39;Large&#39;</span>){DB_data<span class="sc">$</span>Treatment[n]<span class="ot">=</span><span class="st">&#39;D = 0.26&#39;</span></span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>}<span class="cf">else</span> <span class="cf">if</span>(DB_data<span class="sc">$</span>Gr_size[n]<span class="sc">==</span><span class="st">&#39;LG&#39;</span> <span class="sc">&amp;&amp;</span> DB_data<span class="sc">$</span>Area[n]<span class="sc">==</span><span class="st">&#39;Large&#39;</span>){DB_data<span class="sc">$</span>Treatment[n]<span class="ot">=</span><span class="st">&#39;D = 0.52&#39;</span></span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>}<span class="cf">else</span> <span class="cf">if</span>(DB_data<span class="sc">$</span>Gr_size[n]<span class="sc">==</span><span class="st">&#39;SG&#39;</span> <span class="sc">&amp;&amp;</span> DB_data<span class="sc">$</span>Area[n]<span class="sc">==</span><span class="st">&#39;Small&#39;</span>){DB_data<span class="sc">$</span>Treatment[n]<span class="ot">=</span><span class="st">&#39;D = 0.67&#39;</span></span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>}<span class="cf">else</span> <span class="cf">if</span>(DB_data<span class="sc">$</span>Gr_size[n]<span class="sc">==</span><span class="st">&#39;LG&#39;</span> <span class="sc">&amp;&amp;</span> DB_data<span class="sc">$</span>Area[n]<span class="sc">==</span><span class="st">&#39;Small&#39;</span>){DB_data<span class="sc">$</span>Treatment[n]<span class="ot">=</span><span class="st">&#39;D = 1.33&#39;</span></span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>}<span class="cf">else</span>{DB_data<span class="sc">$</span>Treatment[n]<span class="ot">=</span><span class="cn">NA</span>}}</span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>Treatment<span class="ot">=</span><span class="fu">as.factor</span>(DB_data<span class="sc">$</span>Treatment)</span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a><span class="co"># Exclude Incubator 3 data #### -&gt; poor performance </span></span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>DB_data_clean<span class="ot">=</span>DB_data[DB_data<span class="sc">$</span>Incu3<span class="sc">!=</span><span class="dv">1</span>,]</span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate genetic MS ####</span></span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a><span class="co"># Only clean data</span></span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a>DB_data_clean<span class="sc">$</span>gMS<span class="ot">=</span><span class="cn">NA</span> </span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data_clean<span class="sc">$</span>Sex)) {<span class="cf">if</span> (DB_data_clean<span class="sc">$</span>N_MTP1_1[i]<span class="sc">&gt;=</span><span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>N_MTP1_1[i])){</span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>  DB_data_clean<span class="sc">$</span>gMS[i]<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a>}<span class="cf">else</span>{DB_data_clean<span class="sc">$</span>gMS[i]<span class="ot">=</span><span class="dv">0</span>}}</span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data_clean<span class="sc">$</span>Sex)) {<span class="cf">if</span> (DB_data_clean<span class="sc">$</span>N_MTP1_2[i]<span class="sc">&gt;=</span><span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>N_MTP1_2[i])){</span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>  DB_data_clean<span class="sc">$</span>gMS[i]<span class="ot">=</span>DB_data_clean<span class="sc">$</span>gMS[i]<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>}<span class="cf">else</span>{}}</span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data_clean<span class="sc">$</span>Sex)) {<span class="cf">if</span> (DB_data_clean<span class="sc">$</span>N_MTP1_3[i]<span class="sc">&gt;=</span><span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>N_MTP1_3[i])){</span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a>  DB_data_clean<span class="sc">$</span>gMS[i]<span class="ot">=</span>DB_data_clean<span class="sc">$</span>gMS[i]<span class="sc">+</span><span class="dv">1</span>}<span class="cf">else</span>{}}</span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data_clean<span class="sc">$</span>Sex)) {<span class="cf">if</span> (DB_data_clean<span class="sc">$</span>N_MTP1_4[i]<span class="sc">&gt;=</span><span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>N_MTP1_4[i])){</span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a>  DB_data_clean<span class="sc">$</span>gMS[i]<span class="ot">=</span>DB_data_clean<span class="sc">$</span>gMS[i]<span class="sc">+</span><span class="dv">1</span>}<span class="cf">else</span>{}}</span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data_clean<span class="sc">$</span>Sex)) {<span class="cf">if</span> (DB_data_clean<span class="sc">$</span>N_MTP1_5[i]<span class="sc">&gt;=</span><span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>N_MTP1_5[i])){</span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a>  DB_data_clean<span class="sc">$</span>gMS[i]<span class="ot">=</span>DB_data_clean<span class="sc">$</span>gMS[i]<span class="sc">+</span><span class="dv">1</span>}<span class="cf">else</span>{}}</span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data_clean<span class="sc">$</span>Sex)) {<span class="cf">if</span> (DB_data_clean<span class="sc">$</span>N_MTP1_6[i]<span class="sc">&gt;=</span><span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>N_MTP1_6[i])){</span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a>  DB_data_clean<span class="sc">$</span>gMS[i]<span class="ot">=</span>DB_data_clean<span class="sc">$</span>gMS[i]<span class="sc">+</span><span class="dv">1</span>}<span class="cf">else</span>{}}</span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a><span class="co"># All data</span></span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>gMS<span class="ot">=</span><span class="cn">NA</span> </span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data<span class="sc">$</span>Sex)) {<span class="cf">if</span> (DB_data<span class="sc">$</span>N_MTP1_1[i]<span class="sc">&gt;=</span><span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data<span class="sc">$</span>N_MTP1_1[i])){</span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a>  DB_data<span class="sc">$</span>gMS[i]<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a>}<span class="cf">else</span>{DB_data<span class="sc">$</span>gMS[i]<span class="ot">=</span><span class="dv">0</span>}}</span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data<span class="sc">$</span>Sex)) {<span class="cf">if</span> (DB_data<span class="sc">$</span>N_MTP1_2[i]<span class="sc">&gt;=</span><span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data<span class="sc">$</span>N_MTP1_2[i])){</span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a>  DB_data<span class="sc">$</span>gMS[i]<span class="ot">=</span>DB_data<span class="sc">$</span>gMS[i]<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a>}<span class="cf">else</span>{}}</span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data<span class="sc">$</span>Sex)) {<span class="cf">if</span> (DB_data<span class="sc">$</span>N_MTP1_3[i]<span class="sc">&gt;=</span><span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data<span class="sc">$</span>N_MTP1_3[i])){</span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a>  DB_data<span class="sc">$</span>gMS[i]<span class="ot">=</span>DB_data<span class="sc">$</span>gMS[i]<span class="sc">+</span><span class="dv">1</span>}<span class="cf">else</span>{}}</span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data<span class="sc">$</span>Sex)) {<span class="cf">if</span> (DB_data<span class="sc">$</span>N_MTP1_4[i]<span class="sc">&gt;=</span><span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data<span class="sc">$</span>N_MTP1_4[i])){</span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a>  DB_data<span class="sc">$</span>gMS[i]<span class="ot">=</span>DB_data<span class="sc">$</span>gMS[i]<span class="sc">+</span><span class="dv">1</span>}<span class="cf">else</span>{}}</span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data<span class="sc">$</span>Sex)) {<span class="cf">if</span> (DB_data<span class="sc">$</span>N_MTP1_5[i]<span class="sc">&gt;=</span><span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data<span class="sc">$</span>N_MTP1_5[i])){</span>
<span id="cb1-119"><a href="#cb1-119" aria-hidden="true" tabindex="-1"></a>  DB_data<span class="sc">$</span>gMS[i]<span class="ot">=</span>DB_data<span class="sc">$</span>gMS[i]<span class="sc">+</span><span class="dv">1</span>}<span class="cf">else</span>{}}</span>
<span id="cb1-120"><a href="#cb1-120" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data<span class="sc">$</span>Sex)) {<span class="cf">if</span> (DB_data<span class="sc">$</span>N_MTP1_6[i]<span class="sc">&gt;=</span><span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data<span class="sc">$</span>N_MTP1_6[i])){</span>
<span id="cb1-121"><a href="#cb1-121" aria-hidden="true" tabindex="-1"></a>  DB_data<span class="sc">$</span>gMS[i]<span class="ot">=</span>DB_data<span class="sc">$</span>gMS[i]<span class="sc">+</span><span class="dv">1</span>}<span class="cf">else</span>{}}</span>
<span id="cb1-122"><a href="#cb1-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-123"><a href="#cb1-123" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculate Rd competition RS ####</span></span>
<span id="cb1-124"><a href="#cb1-124" aria-hidden="true" tabindex="-1"></a>DB_data_clean<span class="sc">$</span>m_RS_Rd_comp<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-125"><a href="#cb1-125" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data_clean<span class="sc">$</span>Sex)) {<span class="cf">if</span> (DB_data_clean<span class="sc">$</span>N_MTP1_1[i]<span class="sc">&gt;=</span><span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>N_MTP1_1[i])){</span>
<span id="cb1-126"><a href="#cb1-126" aria-hidden="true" tabindex="-1"></a>  DB_data_clean<span class="sc">$</span>m_RS_Rd_comp[i]<span class="ot">=</span>DB_data_clean<span class="sc">$</span>N_RD_1[i]</span>
<span id="cb1-127"><a href="#cb1-127" aria-hidden="true" tabindex="-1"></a>}<span class="cf">else</span>{DB_data_clean<span class="sc">$</span>m_RS_Rd_comp[i]<span class="ot">=</span><span class="dv">0</span>}}</span>
<span id="cb1-128"><a href="#cb1-128" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data_clean<span class="sc">$</span>Sex)) {<span class="cf">if</span> (DB_data_clean<span class="sc">$</span>N_MTP1_2[i]<span class="sc">&gt;=</span><span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>N_MTP1_2[i])){</span>
<span id="cb1-129"><a href="#cb1-129" aria-hidden="true" tabindex="-1"></a>  DB_data_clean<span class="sc">$</span>m_RS_Rd_comp[i]<span class="ot">=</span>DB_data_clean<span class="sc">$</span>m_RS_Rd_comp[i]<span class="sc">+</span>DB_data_clean<span class="sc">$</span>N_RD_2[i]</span>
<span id="cb1-130"><a href="#cb1-130" aria-hidden="true" tabindex="-1"></a>}<span class="cf">else</span>{}}</span>
<span id="cb1-131"><a href="#cb1-131" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data_clean<span class="sc">$</span>Sex)) {<span class="cf">if</span> (DB_data_clean<span class="sc">$</span>N_MTP1_3[i]<span class="sc">&gt;=</span><span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>N_MTP1_3[i])){</span>
<span id="cb1-132"><a href="#cb1-132" aria-hidden="true" tabindex="-1"></a>  DB_data_clean<span class="sc">$</span>m_RS_Rd_comp[i]<span class="ot">=</span>DB_data_clean<span class="sc">$</span>m_RS_Rd_comp[i]<span class="sc">+</span>DB_data_clean<span class="sc">$</span>N_RD_3[i]</span>
<span id="cb1-133"><a href="#cb1-133" aria-hidden="true" tabindex="-1"></a>}<span class="cf">else</span>{}}</span>
<span id="cb1-134"><a href="#cb1-134" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data_clean<span class="sc">$</span>Sex)) {<span class="cf">if</span> (DB_data_clean<span class="sc">$</span>N_MTP1_4[i]<span class="sc">&gt;=</span><span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>N_MTP1_4[i])){</span>
<span id="cb1-135"><a href="#cb1-135" aria-hidden="true" tabindex="-1"></a>  DB_data_clean<span class="sc">$</span>m_RS_Rd_comp[i]<span class="ot">=</span>DB_data_clean<span class="sc">$</span>m_RS_Rd_comp[i]<span class="sc">+</span>DB_data_clean<span class="sc">$</span>N_RD_4[i]</span>
<span id="cb1-136"><a href="#cb1-136" aria-hidden="true" tabindex="-1"></a>}<span class="cf">else</span>{}}</span>
<span id="cb1-137"><a href="#cb1-137" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data_clean<span class="sc">$</span>Sex)) {<span class="cf">if</span> (DB_data_clean<span class="sc">$</span>N_MTP1_5[i]<span class="sc">&gt;=</span><span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>N_MTP1_5[i])){</span>
<span id="cb1-138"><a href="#cb1-138" aria-hidden="true" tabindex="-1"></a>  DB_data_clean<span class="sc">$</span>m_RS_Rd_comp[i]<span class="ot">=</span>DB_data_clean<span class="sc">$</span>m_RS_Rd_comp[i]<span class="sc">+</span>DB_data_clean<span class="sc">$</span>N_RD_5[i]</span>
<span id="cb1-139"><a href="#cb1-139" aria-hidden="true" tabindex="-1"></a>}<span class="cf">else</span>{}}</span>
<span id="cb1-140"><a href="#cb1-140" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data_clean<span class="sc">$</span>Sex)) {<span class="cf">if</span> (DB_data_clean<span class="sc">$</span>N_MTP1_6[i]<span class="sc">&gt;=</span><span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>N_MTP1_6[i])){</span>
<span id="cb1-141"><a href="#cb1-141" aria-hidden="true" tabindex="-1"></a>  DB_data_clean<span class="sc">$</span>m_RS_Rd_comp[i]<span class="ot">=</span>DB_data_clean<span class="sc">$</span>m_RS_Rd_comp[i]<span class="sc">+</span>DB_data_clean<span class="sc">$</span>N_RD_6[i]</span>
<span id="cb1-142"><a href="#cb1-142" aria-hidden="true" tabindex="-1"></a>}<span class="cf">else</span>{}}</span>
<span id="cb1-143"><a href="#cb1-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-144"><a href="#cb1-144" aria-hidden="true" tabindex="-1"></a><span class="co"># Check matings of males #### -&gt; add copulations where offspring found but no copulation registered</span></span>
<span id="cb1-145"><a href="#cb1-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-146"><a href="#cb1-146" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data_clean<span class="sc">$</span>Sex)) {<span class="cf">if</span> (DB_data_clean<span class="sc">$</span>N_MTP1_1[i]<span class="sc">&gt;=</span><span class="dv">1</span> <span class="sc">&amp;&amp;</span> DB_data_clean<span class="sc">$</span>Cop_Fe_1[i]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>Cop_Fe_1[i])<span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>N_MTP1_1[i])){</span>
<span id="cb1-147"><a href="#cb1-147" aria-hidden="true" tabindex="-1"></a>  DB_data_clean<span class="sc">$</span>Cop_Fe_1[i]<span class="ot">=</span><span class="dv">1</span>}<span class="cf">else</span>{}}</span>
<span id="cb1-148"><a href="#cb1-148" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data_clean<span class="sc">$</span>Sex)) {<span class="cf">if</span> (DB_data_clean<span class="sc">$</span>N_MTP1_2[i]<span class="sc">&gt;=</span><span class="dv">1</span> <span class="sc">&amp;&amp;</span> DB_data_clean<span class="sc">$</span>Cop_Fe_2[i]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>Cop_Fe_2[i])<span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>N_MTP1_2[i])){</span>
<span id="cb1-149"><a href="#cb1-149" aria-hidden="true" tabindex="-1"></a>  DB_data_clean<span class="sc">$</span>Cop_Fe_2[i]<span class="ot">=</span><span class="dv">1</span>}<span class="cf">else</span>{}}</span>
<span id="cb1-150"><a href="#cb1-150" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data_clean<span class="sc">$</span>Sex)) {<span class="cf">if</span> (DB_data_clean<span class="sc">$</span>N_MTP1_3[i]<span class="sc">&gt;=</span><span class="dv">1</span> <span class="sc">&amp;&amp;</span> DB_data_clean<span class="sc">$</span>Cop_Fe_3[i]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>Cop_Fe_3[i])<span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>N_MTP1_3[i])){</span>
<span id="cb1-151"><a href="#cb1-151" aria-hidden="true" tabindex="-1"></a>  DB_data_clean<span class="sc">$</span>Cop_Fe_3[i]<span class="ot">=</span><span class="dv">1</span>}<span class="cf">else</span>{}}</span>
<span id="cb1-152"><a href="#cb1-152" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data_clean<span class="sc">$</span>Sex)) {<span class="cf">if</span> (DB_data_clean<span class="sc">$</span>N_MTP1_4[i]<span class="sc">&gt;=</span><span class="dv">1</span> <span class="sc">&amp;&amp;</span> DB_data_clean<span class="sc">$</span>Cop_Fe_4[i]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>Cop_Fe_4[i])<span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>N_MTP1_4[i])){</span>
<span id="cb1-153"><a href="#cb1-153" aria-hidden="true" tabindex="-1"></a>  DB_data_clean<span class="sc">$</span>Cop_Fe_4[i]<span class="ot">=</span><span class="dv">1</span>}<span class="cf">else</span>{}}</span>
<span id="cb1-154"><a href="#cb1-154" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data_clean<span class="sc">$</span>Sex)) {<span class="cf">if</span> (DB_data_clean<span class="sc">$</span>N_MTP1_5[i]<span class="sc">&gt;=</span><span class="dv">1</span> <span class="sc">&amp;&amp;</span> DB_data_clean<span class="sc">$</span>Cop_Fe_5[i]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>Cop_Fe_5[i])<span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>N_MTP1_5[i])){</span>
<span id="cb1-155"><a href="#cb1-155" aria-hidden="true" tabindex="-1"></a>  DB_data_clean<span class="sc">$</span>Cop_Fe_5[i]<span class="ot">=</span><span class="dv">1</span>}<span class="cf">else</span>{}}</span>
<span id="cb1-156"><a href="#cb1-156" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data_clean<span class="sc">$</span>Sex)) {<span class="cf">if</span> (DB_data_clean<span class="sc">$</span>N_MTP1_6[i]<span class="sc">&gt;=</span><span class="dv">1</span> <span class="sc">&amp;&amp;</span> DB_data_clean<span class="sc">$</span>Cop_Fe_6[i]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>Cop_Fe_6[i])<span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>N_MTP1_6[i])){</span>
<span id="cb1-157"><a href="#cb1-157" aria-hidden="true" tabindex="-1"></a>  DB_data_clean<span class="sc">$</span>Cop_Fe_6[i]<span class="ot">=</span><span class="dv">1</span>}<span class="cf">else</span>{}}</span>
<span id="cb1-158"><a href="#cb1-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-159"><a href="#cb1-159" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Rd competition RS of all copulations with potential sperm competition with the  focal ####</span></span>
<span id="cb1-160"><a href="#cb1-160" aria-hidden="true" tabindex="-1"></a>DB_data_clean<span class="sc">$</span>m_RS_Rd_comp_full<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-161"><a href="#cb1-161" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data_clean<span class="sc">$</span>Sex)) {<span class="cf">if</span> (DB_data_clean<span class="sc">$</span>Cop_Fe_1[i]<span class="sc">&gt;=</span><span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>Cop_Fe_1[i])){</span>
<span id="cb1-162"><a href="#cb1-162" aria-hidden="true" tabindex="-1"></a>  DB_data_clean<span class="sc">$</span>m_RS_Rd_comp_full[i]<span class="ot">=</span>DB_data_clean<span class="sc">$</span>N_RD_1[i]</span>
<span id="cb1-163"><a href="#cb1-163" aria-hidden="true" tabindex="-1"></a>}<span class="cf">else</span>{DB_data_clean<span class="sc">$</span>m_RS_Rd_comp_full[i]<span class="ot">=</span><span class="dv">0</span>}}</span>
<span id="cb1-164"><a href="#cb1-164" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data_clean<span class="sc">$</span>Sex)) {<span class="cf">if</span> (DB_data_clean<span class="sc">$</span>Cop_Fe_2[i]<span class="sc">&gt;=</span><span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>Cop_Fe_2[i])){</span>
<span id="cb1-165"><a href="#cb1-165" aria-hidden="true" tabindex="-1"></a>  DB_data_clean<span class="sc">$</span>m_RS_Rd_comp_full[i]<span class="ot">=</span>DB_data_clean<span class="sc">$</span>m_RS_Rd_comp_full[i]<span class="sc">+</span>DB_data_clean<span class="sc">$</span>N_RD_2[i]</span>
<span id="cb1-166"><a href="#cb1-166" aria-hidden="true" tabindex="-1"></a>}<span class="cf">else</span>{}}</span>
<span id="cb1-167"><a href="#cb1-167" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data_clean<span class="sc">$</span>Sex)) {<span class="cf">if</span> (DB_data_clean<span class="sc">$</span>Cop_Fe_3[i]<span class="sc">&gt;=</span><span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>Cop_Fe_3[i])){</span>
<span id="cb1-168"><a href="#cb1-168" aria-hidden="true" tabindex="-1"></a>  DB_data_clean<span class="sc">$</span>m_RS_Rd_comp_full[i]<span class="ot">=</span>DB_data_clean<span class="sc">$</span>m_RS_Rd_comp_full[i]<span class="sc">+</span>DB_data_clean<span class="sc">$</span>N_RD_3[i]</span>
<span id="cb1-169"><a href="#cb1-169" aria-hidden="true" tabindex="-1"></a>}<span class="cf">else</span>{}}</span>
<span id="cb1-170"><a href="#cb1-170" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data_clean<span class="sc">$</span>Sex)) {<span class="cf">if</span> (DB_data_clean<span class="sc">$</span>Cop_Fe_4[i]<span class="sc">&gt;=</span><span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>Cop_Fe_4[i])){</span>
<span id="cb1-171"><a href="#cb1-171" aria-hidden="true" tabindex="-1"></a>  DB_data_clean<span class="sc">$</span>m_RS_Rd_comp_full[i]<span class="ot">=</span>DB_data_clean<span class="sc">$</span>m_RS_Rd_comp_full[i]<span class="sc">+</span>DB_data_clean<span class="sc">$</span>N_RD_4[i]</span>
<span id="cb1-172"><a href="#cb1-172" aria-hidden="true" tabindex="-1"></a>}<span class="cf">else</span>{}}</span>
<span id="cb1-173"><a href="#cb1-173" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data_clean<span class="sc">$</span>Sex)) {<span class="cf">if</span> (DB_data_clean<span class="sc">$</span>Cop_Fe_5[i]<span class="sc">&gt;=</span><span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>Cop_Fe_5[i])){</span>
<span id="cb1-174"><a href="#cb1-174" aria-hidden="true" tabindex="-1"></a>  DB_data_clean<span class="sc">$</span>m_RS_Rd_comp_full[i]<span class="ot">=</span>DB_data_clean<span class="sc">$</span>m_RS_Rd_comp_full[i]<span class="sc">+</span>DB_data_clean<span class="sc">$</span>N_RD_5[i]</span>
<span id="cb1-175"><a href="#cb1-175" aria-hidden="true" tabindex="-1"></a>}<span class="cf">else</span>{}}</span>
<span id="cb1-176"><a href="#cb1-176" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data_clean<span class="sc">$</span>Sex)) {<span class="cf">if</span> (DB_data_clean<span class="sc">$</span>Cop_Fe_6[i]<span class="sc">&gt;=</span><span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>Cop_Fe_6[i])){</span>
<span id="cb1-177"><a href="#cb1-177" aria-hidden="true" tabindex="-1"></a>  DB_data_clean<span class="sc">$</span>m_RS_Rd_comp_full[i]<span class="ot">=</span>DB_data_clean<span class="sc">$</span>m_RS_Rd_comp_full[i]<span class="sc">+</span>DB_data_clean<span class="sc">$</span>N_RD_6[i]</span>
<span id="cb1-178"><a href="#cb1-178" aria-hidden="true" tabindex="-1"></a>}<span class="cf">else</span>{}}</span>
<span id="cb1-179"><a href="#cb1-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-180"><a href="#cb1-180" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate trait values ####</span></span>
<span id="cb1-181"><a href="#cb1-181" aria-hidden="true" tabindex="-1"></a><span class="co"># Males ####</span></span>
<span id="cb1-182"><a href="#cb1-182" aria-hidden="true" tabindex="-1"></a><span class="co"># Total number of matings (all data)</span></span>
<span id="cb1-183"><a href="#cb1-183" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>m_TotMatings<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-184"><a href="#cb1-184" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>m_TotMatings<span class="ot">=</span>DB_data<span class="sc">$</span>Matings_number</span>
<span id="cb1-185"><a href="#cb1-185" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>m_TotMatings[DB_data<span class="sc">$</span>Sex<span class="sc">==</span><span class="st">&#39;F&#39;</span>]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-186"><a href="#cb1-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-187"><a href="#cb1-187" aria-hidden="true" tabindex="-1"></a><span class="co"># Avarage mating duration (all data)</span></span>
<span id="cb1-188"><a href="#cb1-188" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>MatingDuration_av[DB_data<span class="sc">$</span>MatingDuration_av<span class="sc">==</span><span class="dv">0</span>]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-189"><a href="#cb1-189" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>m_MatingDuration_av<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-190"><a href="#cb1-190" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>m_MatingDuration_av<span class="ot">=</span>DB_data<span class="sc">$</span>MatingDuration_av</span>
<span id="cb1-191"><a href="#cb1-191" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>m_MatingDuration_av[DB_data<span class="sc">$</span>Sex<span class="sc">==</span><span class="st">&#39;F&#39;</span>]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-192"><a href="#cb1-192" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>MatingDuration_av[DB_data<span class="sc">$</span>MatingDuration_av<span class="sc">==</span><span class="dv">0</span>]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-193"><a href="#cb1-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-194"><a href="#cb1-194" aria-hidden="true" tabindex="-1"></a><span class="co"># Total number of mating attempts (all data)</span></span>
<span id="cb1-195"><a href="#cb1-195" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>m_Attempts_number<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-196"><a href="#cb1-196" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>m_Attempts_number<span class="ot">=</span>DB_data<span class="sc">$</span>Attempts_number</span>
<span id="cb1-197"><a href="#cb1-197" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>m_Attempts_number[DB_data<span class="sc">$</span>Sex<span class="sc">==</span><span class="st">&#39;F&#39;</span>]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-198"><a href="#cb1-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-199"><a href="#cb1-199" aria-hidden="true" tabindex="-1"></a><span class="co"># Proportional mating success (all data)</span></span>
<span id="cb1-200"><a href="#cb1-200" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>m_Prop_MS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-201"><a href="#cb1-201" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>m_Prop_MS<span class="ot">=</span>DB_data<span class="sc">$</span>Prop_MS</span>
<span id="cb1-202"><a href="#cb1-202" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>m_Prop_MS[DB_data<span class="sc">$</span>Sex<span class="sc">==</span><span class="st">&#39;F&#39;</span>]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-203"><a href="#cb1-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-204"><a href="#cb1-204" aria-hidden="true" tabindex="-1"></a><span class="co">#Total encounters (all data)</span></span>
<span id="cb1-205"><a href="#cb1-205" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>m_Total_Encounters<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-206"><a href="#cb1-206" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>m_Total_Encounters<span class="ot">=</span>DB_data<span class="sc">$</span>Total_Encounters</span>
<span id="cb1-207"><a href="#cb1-207" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>m_Total_Encounters[DB_data<span class="sc">$</span>Sex<span class="sc">==</span><span class="st">&#39;F&#39;</span>]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-208"><a href="#cb1-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-209"><a href="#cb1-209" aria-hidden="true" tabindex="-1"></a><span class="co"># Reproductive success</span></span>
<span id="cb1-210"><a href="#cb1-210" aria-hidden="true" tabindex="-1"></a>DB_data_clean<span class="sc">$</span>m_RS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-211"><a href="#cb1-211" aria-hidden="true" tabindex="-1"></a>DB_data_clean<span class="sc">$</span>m_RS<span class="ot">=</span>DB_data_clean<span class="sc">$</span>Total_N_MTP1</span>
<span id="cb1-212"><a href="#cb1-212" aria-hidden="true" tabindex="-1"></a>DB_data_clean<span class="sc">$</span>m_RS[DB_data_clean<span class="sc">$</span>Sex<span class="sc">==</span><span class="st">&#39;F&#39;</span>]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-213"><a href="#cb1-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-214"><a href="#cb1-214" aria-hidden="true" tabindex="-1"></a><span class="co"># Mating success (number of different partners)</span></span>
<span id="cb1-215"><a href="#cb1-215" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean data</span></span>
<span id="cb1-216"><a href="#cb1-216" aria-hidden="true" tabindex="-1"></a>DB_data_clean<span class="sc">$</span>m_cMS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-217"><a href="#cb1-217" aria-hidden="true" tabindex="-1"></a>DB_data_clean<span class="sc">$</span>m_cMS<span class="ot">=</span>DB_data_clean<span class="sc">$</span>MatingPartners_number</span>
<span id="cb1-218"><a href="#cb1-218" aria-hidden="true" tabindex="-1"></a>DB_data_clean<span class="sc">$</span>m_cMS[DB_data_clean<span class="sc">$</span>Sex<span class="sc">==</span><span class="st">&#39;F&#39;</span>]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-219"><a href="#cb1-219" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data_clean<span class="sc">$</span>m_cMS)) {<span class="cf">if</span> (DB_data_clean<span class="sc">$</span>gMS[i]<span class="sc">&gt;</span>DB_data_clean<span class="sc">$</span>m_cMS[i] <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>m_cMS[i])){</span>
<span id="cb1-220"><a href="#cb1-220" aria-hidden="true" tabindex="-1"></a>  DB_data_clean<span class="sc">$</span>m_cMS[i]<span class="ot">=</span>DB_data_clean<span class="sc">$</span>gMS[i]}<span class="cf">else</span>{}}</span>
<span id="cb1-221"><a href="#cb1-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-222"><a href="#cb1-222" aria-hidden="true" tabindex="-1"></a><span class="co"># All data</span></span>
<span id="cb1-223"><a href="#cb1-223" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>m_cMS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-224"><a href="#cb1-224" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>m_cMS<span class="ot">=</span>DB_data<span class="sc">$</span>MatingPartners_number</span>
<span id="cb1-225"><a href="#cb1-225" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>m_cMS[DB_data<span class="sc">$</span>Sex<span class="sc">==</span><span class="st">&#39;F&#39;</span>]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-226"><a href="#cb1-226" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data<span class="sc">$</span>m_cMS)) {<span class="cf">if</span> (DB_data<span class="sc">$</span>gMS[i]<span class="sc">&gt;</span>DB_data<span class="sc">$</span>m_cMS[i] <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data<span class="sc">$</span>m_cMS[i])){</span>
<span id="cb1-227"><a href="#cb1-227" aria-hidden="true" tabindex="-1"></a>  DB_data<span class="sc">$</span>m_cMS[i]<span class="ot">=</span>DB_data<span class="sc">$</span>gMS[i]}<span class="cf">else</span>{}}</span>
<span id="cb1-228"><a href="#cb1-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-229"><a href="#cb1-229" aria-hidden="true" tabindex="-1"></a><span class="co"># Insemination success</span></span>
<span id="cb1-230"><a href="#cb1-230" aria-hidden="true" tabindex="-1"></a>DB_data_clean<span class="sc">$</span>m_InSuc<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-231"><a href="#cb1-231" aria-hidden="true" tabindex="-1"></a>DB_data_clean<span class="sc">$</span>m_InSuc<span class="ot">=</span>DB_data_clean<span class="sc">$</span>gMS<span class="sc">/</span>DB_data_clean<span class="sc">$</span>m_cMS</span>
<span id="cb1-232"><a href="#cb1-232" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data_clean<span class="sc">$</span>m_InSuc)) {<span class="cf">if</span> (DB_data_clean<span class="sc">$</span>m_cMS[i]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>m_cMS[i])){</span>
<span id="cb1-233"><a href="#cb1-233" aria-hidden="true" tabindex="-1"></a>  DB_data_clean<span class="sc">$</span>m_InSuc[i]<span class="ot">=</span><span class="cn">NA</span>}<span class="cf">else</span>{}}</span>
<span id="cb1-234"><a href="#cb1-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-235"><a href="#cb1-235" aria-hidden="true" tabindex="-1"></a><span class="co"># Fertilization success</span></span>
<span id="cb1-236"><a href="#cb1-236" aria-hidden="true" tabindex="-1"></a>DB_data_clean<span class="sc">$</span>m_feSuc<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-237"><a href="#cb1-237" aria-hidden="true" tabindex="-1"></a>DB_data_clean<span class="sc">$</span>m_feSuc<span class="ot">=</span>DB_data_clean<span class="sc">$</span>m_RS<span class="sc">/</span>(DB_data_clean<span class="sc">$</span>m_RS<span class="sc">+</span>DB_data_clean<span class="sc">$</span>m_RS_Rd_comp)</span>
<span id="cb1-238"><a href="#cb1-238" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data_clean<span class="sc">$</span>m_feSuc)) {<span class="cf">if</span> (DB_data_clean<span class="sc">$</span>m_InSuc[i]<span class="sc">==</span><span class="dv">0</span> <span class="sc">|</span> <span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>m_InSuc[i])){</span>
<span id="cb1-239"><a href="#cb1-239" aria-hidden="true" tabindex="-1"></a>  DB_data_clean<span class="sc">$</span>m_feSuc[i]<span class="ot">=</span><span class="cn">NA</span>}<span class="cf">else</span>{}}</span>
<span id="cb1-240"><a href="#cb1-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-241"><a href="#cb1-241" aria-hidden="true" tabindex="-1"></a><span class="co"># Fecundicty of partners</span></span>
<span id="cb1-242"><a href="#cb1-242" aria-hidden="true" tabindex="-1"></a>DB_data_clean<span class="sc">$</span>m_pFec<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-243"><a href="#cb1-243" aria-hidden="true" tabindex="-1"></a>DB_data_clean<span class="sc">$</span>m_pFec<span class="ot">=</span>(DB_data_clean<span class="sc">$</span>m_RS<span class="sc">+</span>DB_data_clean<span class="sc">$</span>m_RS_Rd_comp)<span class="sc">/</span>DB_data_clean<span class="sc">$</span>gMS</span>
<span id="cb1-244"><a href="#cb1-244" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data_clean<span class="sc">$</span>m_pFec)) {<span class="cf">if</span> (DB_data_clean<span class="sc">$</span>gMS[i]<span class="sc">==</span><span class="dv">0</span>){</span>
<span id="cb1-245"><a href="#cb1-245" aria-hidden="true" tabindex="-1"></a>  DB_data_clean<span class="sc">$</span>m_pFec[i]<span class="ot">=</span><span class="cn">NA</span>}<span class="cf">else</span>{}}</span>
<span id="cb1-246"><a href="#cb1-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-247"><a href="#cb1-247" aria-hidden="true" tabindex="-1"></a><span class="co"># Paternity success</span></span>
<span id="cb1-248"><a href="#cb1-248" aria-hidden="true" tabindex="-1"></a>DB_data_clean<span class="sc">$</span>m_PS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-249"><a href="#cb1-249" aria-hidden="true" tabindex="-1"></a>DB_data_clean<span class="sc">$</span>m_PS<span class="ot">=</span>DB_data_clean<span class="sc">$</span>m_RS<span class="sc">/</span>(DB_data_clean<span class="sc">$</span>m_RS<span class="sc">+</span>DB_data_clean<span class="sc">$</span>m_RS_Rd_comp_full)</span>
<span id="cb1-250"><a href="#cb1-250" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data_clean<span class="sc">$</span>m_PS)) {<span class="cf">if</span> (DB_data_clean<span class="sc">$</span>m_RS[i]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>m_RS[i])){</span>
<span id="cb1-251"><a href="#cb1-251" aria-hidden="true" tabindex="-1"></a>  DB_data_clean<span class="sc">$</span>m_PS[i]<span class="ot">=</span><span class="cn">NA</span>}<span class="cf">else</span>{}}</span>
<span id="cb1-252"><a href="#cb1-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-253"><a href="#cb1-253" aria-hidden="true" tabindex="-1"></a><span class="co"># Fecundity of partners in all females the focal copulated with</span></span>
<span id="cb1-254"><a href="#cb1-254" aria-hidden="true" tabindex="-1"></a>DB_data_clean<span class="sc">$</span>m_pFec_compl<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-255"><a href="#cb1-255" aria-hidden="true" tabindex="-1"></a>DB_data_clean<span class="sc">$</span>m_pFec_compl<span class="ot">=</span>(DB_data_clean<span class="sc">$</span>m_RS<span class="sc">+</span>DB_data_clean<span class="sc">$</span>m_RS_Rd_comp_full)<span class="sc">/</span>DB_data_clean<span class="sc">$</span>m_cMS</span>
<span id="cb1-256"><a href="#cb1-256" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data_clean<span class="sc">$</span>m_pFec)) {<span class="cf">if</span> (DB_data_clean<span class="sc">$</span>m_cMS[i]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>m_cMS[i])){</span>
<span id="cb1-257"><a href="#cb1-257" aria-hidden="true" tabindex="-1"></a>  DB_data_clean<span class="sc">$</span>m_pFec[i]<span class="ot">=</span><span class="cn">NA</span>}<span class="cf">else</span>{}}</span>
<span id="cb1-258"><a href="#cb1-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-259"><a href="#cb1-259" aria-hidden="true" tabindex="-1"></a><span class="co"># Females ####</span></span>
<span id="cb1-260"><a href="#cb1-260" aria-hidden="true" tabindex="-1"></a><span class="co"># Total number of matings (all data)</span></span>
<span id="cb1-261"><a href="#cb1-261" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>f_TotMatings<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-262"><a href="#cb1-262" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>f_TotMatings<span class="ot">=</span>DB_data<span class="sc">$</span>Matings_number</span>
<span id="cb1-263"><a href="#cb1-263" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>f_TotMatings[DB_data<span class="sc">$</span>Sex<span class="sc">==</span><span class="st">&#39;M&#39;</span>]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-264"><a href="#cb1-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-265"><a href="#cb1-265" aria-hidden="true" tabindex="-1"></a><span class="co"># Avarage mating duration (all data)</span></span>
<span id="cb1-266"><a href="#cb1-266" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>f_MatingDuration_av<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-267"><a href="#cb1-267" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>f_MatingDuration_av<span class="ot">=</span>DB_data<span class="sc">$</span>MatingDuration_av</span>
<span id="cb1-268"><a href="#cb1-268" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>f_MatingDuration_av[DB_data<span class="sc">$</span>Sex<span class="sc">==</span><span class="st">&#39;M&#39;</span>]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-269"><a href="#cb1-269" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>MatingDuration_av[DB_data<span class="sc">$</span>MatingDuration_av<span class="sc">==</span><span class="dv">0</span>]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-270"><a href="#cb1-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-271"><a href="#cb1-271" aria-hidden="true" tabindex="-1"></a><span class="co"># Total number of mating attempts (all data)</span></span>
<span id="cb1-272"><a href="#cb1-272" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>f_Attempts_number<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-273"><a href="#cb1-273" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>f_Attempts_number<span class="ot">=</span>DB_data<span class="sc">$</span>Attempts_number</span>
<span id="cb1-274"><a href="#cb1-274" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>f_Attempts_number[DB_data<span class="sc">$</span>Sex<span class="sc">==</span><span class="st">&#39;M&#39;</span>]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-275"><a href="#cb1-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-276"><a href="#cb1-276" aria-hidden="true" tabindex="-1"></a><span class="co"># Proportional mating success (all data)</span></span>
<span id="cb1-277"><a href="#cb1-277" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>f_Prop_MS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-278"><a href="#cb1-278" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>f_Prop_MS<span class="ot">=</span>DB_data<span class="sc">$</span>Prop_MS</span>
<span id="cb1-279"><a href="#cb1-279" aria-hidden="true" tabindex="-1"></a>DB_data_clean<span class="sc">$</span>f_Prop_MS[DB_data_clean<span class="sc">$</span>Sex<span class="sc">==</span><span class="st">&#39;M&#39;</span>]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-280"><a href="#cb1-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-281"><a href="#cb1-281" aria-hidden="true" tabindex="-1"></a><span class="co">#Total encounters (all data)</span></span>
<span id="cb1-282"><a href="#cb1-282" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>f_Total_Encounters<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-283"><a href="#cb1-283" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>f_Total_Encounters<span class="ot">=</span>DB_data<span class="sc">$</span>Total_Encounters</span>
<span id="cb1-284"><a href="#cb1-284" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>f_Total_Encounters[DB_data<span class="sc">$</span>Sex<span class="sc">==</span><span class="st">&#39;M&#39;</span>]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-285"><a href="#cb1-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-286"><a href="#cb1-286" aria-hidden="true" tabindex="-1"></a><span class="co"># Reproductive success</span></span>
<span id="cb1-287"><a href="#cb1-287" aria-hidden="true" tabindex="-1"></a>DB_data_clean<span class="sc">$</span>f_RS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-288"><a href="#cb1-288" aria-hidden="true" tabindex="-1"></a>DB_data_clean<span class="sc">$</span>f_RS<span class="ot">=</span>DB_data_clean<span class="sc">$</span>Total_N_MTP1</span>
<span id="cb1-289"><a href="#cb1-289" aria-hidden="true" tabindex="-1"></a>DB_data_clean<span class="sc">$</span>f_RS[DB_data_clean<span class="sc">$</span>Sex<span class="sc">==</span><span class="st">&#39;M&#39;</span>]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-290"><a href="#cb1-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-291"><a href="#cb1-291" aria-hidden="true" tabindex="-1"></a><span class="co"># Mating success (number of different partners)</span></span>
<span id="cb1-292"><a href="#cb1-292" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean data</span></span>
<span id="cb1-293"><a href="#cb1-293" aria-hidden="true" tabindex="-1"></a>DB_data_clean<span class="sc">$</span>f_cMS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-294"><a href="#cb1-294" aria-hidden="true" tabindex="-1"></a>DB_data_clean<span class="sc">$</span>f_cMS<span class="ot">=</span>DB_data_clean<span class="sc">$</span>MatingPartners_number</span>
<span id="cb1-295"><a href="#cb1-295" aria-hidden="true" tabindex="-1"></a>DB_data_clean<span class="sc">$</span>f_cMS[DB_data_clean<span class="sc">$</span>Sex<span class="sc">==</span><span class="st">&#39;M&#39;</span>]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-296"><a href="#cb1-296" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data_clean<span class="sc">$</span>f_cMS)) {<span class="cf">if</span> (DB_data_clean<span class="sc">$</span>gMS[i]<span class="sc">&gt;</span>DB_data_clean<span class="sc">$</span>f_cMS[i] <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>f_cMS[i])){</span>
<span id="cb1-297"><a href="#cb1-297" aria-hidden="true" tabindex="-1"></a>  DB_data_clean<span class="sc">$</span>f_cMS[i]<span class="ot">=</span>DB_data_clean<span class="sc">$</span>gMS[i]}<span class="cf">else</span>{}}</span>
<span id="cb1-298"><a href="#cb1-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-299"><a href="#cb1-299" aria-hidden="true" tabindex="-1"></a><span class="co"># All data</span></span>
<span id="cb1-300"><a href="#cb1-300" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>f_cMS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-301"><a href="#cb1-301" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>f_cMS<span class="ot">=</span>DB_data<span class="sc">$</span>MatingPartners_number</span>
<span id="cb1-302"><a href="#cb1-302" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>f_cMS[DB_data<span class="sc">$</span>Sex<span class="sc">==</span><span class="st">&#39;M&#39;</span>]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-303"><a href="#cb1-303" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data<span class="sc">$</span>f_cMS)) {<span class="cf">if</span> (DB_data<span class="sc">$</span>gMS[i]<span class="sc">&gt;</span>DB_data<span class="sc">$</span>f_cMS[i] <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data<span class="sc">$</span>f_cMS[i])){</span>
<span id="cb1-304"><a href="#cb1-304" aria-hidden="true" tabindex="-1"></a>  DB_data<span class="sc">$</span>f_cMS[i]<span class="ot">=</span>DB_data<span class="sc">$</span>gMS[i]}<span class="cf">else</span>{}}</span>
<span id="cb1-305"><a href="#cb1-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-306"><a href="#cb1-306" aria-hidden="true" tabindex="-1"></a><span class="co"># Fecundity per mating partner</span></span>
<span id="cb1-307"><a href="#cb1-307" aria-hidden="true" tabindex="-1"></a>DB_data_clean<span class="sc">$</span>f_fec_pMate<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-308"><a href="#cb1-308" aria-hidden="true" tabindex="-1"></a>DB_data_clean<span class="sc">$</span>f_fec_pMate<span class="ot">=</span>DB_data_clean<span class="sc">$</span>f_RS<span class="sc">/</span>DB_data_clean<span class="sc">$</span>f_cMS</span>
<span id="cb1-309"><a href="#cb1-309" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data_clean<span class="sc">$</span>f_fec_pMate)) {<span class="cf">if</span> (DB_data_clean<span class="sc">$</span>f_RS[i]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>f_RS[i])){</span>
<span id="cb1-310"><a href="#cb1-310" aria-hidden="true" tabindex="-1"></a>  DB_data_clean<span class="sc">$</span>f_fec_pMate[i]<span class="ot">=</span><span class="dv">0</span>}<span class="cf">else</span>{}}</span>
<span id="cb1-311"><a href="#cb1-311" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data_clean<span class="sc">$</span>f_fec_pMate)) {<span class="cf">if</span> (DB_data_clean<span class="sc">$</span>f_cMS[i]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>f_cMS[i])){</span>
<span id="cb1-312"><a href="#cb1-312" aria-hidden="true" tabindex="-1"></a>  DB_data_clean<span class="sc">$</span>f_fec_pMate[i]<span class="ot">=</span><span class="cn">NA</span>}<span class="cf">else</span>{}}</span>
<span id="cb1-313"><a href="#cb1-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-314"><a href="#cb1-314" aria-hidden="true" tabindex="-1"></a><span class="co"># Relativize data per treatment and sex ####</span></span>
<span id="cb1-315"><a href="#cb1-315" aria-hidden="true" tabindex="-1"></a><span class="co"># Small group + large Area</span></span>
<span id="cb1-316"><a href="#cb1-316" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.26</span><span class="ot">=</span>DB_data_clean[DB_data_clean<span class="sc">$</span>Treatment<span class="sc">==</span><span class="st">&#39;D = 0.26&#39;</span>,]</span>
<span id="cb1-317"><a href="#cb1-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-318"><a href="#cb1-318" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>rel_m_RS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-319"><a href="#cb1-319" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>rel_m_prop_RS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-320"><a href="#cb1-320" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>rel_m_cMS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-321"><a href="#cb1-321" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>rel_m_InSuc<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-322"><a href="#cb1-322" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>rel_m_feSuc<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-323"><a href="#cb1-323" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>rel_m_pFec<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-324"><a href="#cb1-324" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>rel_m_PS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-325"><a href="#cb1-325" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>rel_m_pFec_compl<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-326"><a href="#cb1-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-327"><a href="#cb1-327" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>rel_f_RS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-328"><a href="#cb1-328" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>rel_f_prop_RS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-329"><a href="#cb1-329" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>rel_f_cMS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-330"><a href="#cb1-330" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>rel_f_fec_pMate<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-331"><a href="#cb1-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-332"><a href="#cb1-332" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>rel_m_RS<span class="ot">=</span>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>m_RS,<span class="at">na.rm=</span>T)</span>
<span id="cb1-333"><a href="#cb1-333" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>rel_m_prop_RS<span class="ot">=</span>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>m_prop_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>m_prop_RS,<span class="at">na.rm=</span>T)</span>
<span id="cb1-334"><a href="#cb1-334" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>rel_m_cMS<span class="ot">=</span>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>m_cMS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>m_cMS,<span class="at">na.rm=</span>T)</span>
<span id="cb1-335"><a href="#cb1-335" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>rel_m_InSuc<span class="ot">=</span>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>m_InSuc<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>m_InSuc,<span class="at">na.rm=</span>T)</span>
<span id="cb1-336"><a href="#cb1-336" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>rel_m_feSuc<span class="ot">=</span>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>m_feSuc<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>m_feSuc,<span class="at">na.rm=</span>T)</span>
<span id="cb1-337"><a href="#cb1-337" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>rel_m_pFec<span class="ot">=</span>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>m_pFec<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>m_pFec,<span class="at">na.rm=</span>T)</span>
<span id="cb1-338"><a href="#cb1-338" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>rel_m_PS<span class="ot">=</span>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>m_PS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>m_PS,<span class="at">na.rm=</span>T)</span>
<span id="cb1-339"><a href="#cb1-339" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>rel_m_pFec_compl<span class="ot">=</span>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>m_pFec_compl<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>m_pFec_compl,<span class="at">na.rm=</span>T)</span>
<span id="cb1-340"><a href="#cb1-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-341"><a href="#cb1-341" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>rel_f_RS<span class="ot">=</span>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>f_RS,<span class="at">na.rm=</span>T)</span>
<span id="cb1-342"><a href="#cb1-342" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>rel_f_prop_RS<span class="ot">=</span>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>f_prop_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>f_prop_RS,<span class="at">na.rm=</span>T)</span>
<span id="cb1-343"><a href="#cb1-343" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>rel_f_cMS<span class="ot">=</span>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>f_cMS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>f_cMS,<span class="at">na.rm=</span>T)</span>
<span id="cb1-344"><a href="#cb1-344" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>rel_f_fec_pMate<span class="ot">=</span>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>f_fec_pMate<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>f_fec_pMate,<span class="at">na.rm=</span>T)</span>
<span id="cb1-345"><a href="#cb1-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-346"><a href="#cb1-346" aria-hidden="true" tabindex="-1"></a><span class="co"># Large group + large Area</span></span>
<span id="cb1-347"><a href="#cb1-347" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.52</span><span class="ot">=</span>DB_data_clean[DB_data_clean<span class="sc">$</span>Treatment<span class="sc">==</span><span class="st">&#39;D = 0.52&#39;</span>,]</span>
<span id="cb1-348"><a href="#cb1-348" aria-hidden="true" tabindex="-1"></a><span class="co">#Relativize data</span></span>
<span id="cb1-349"><a href="#cb1-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-350"><a href="#cb1-350" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>rel_m_RS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-351"><a href="#cb1-351" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>rel_m_prop_RS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-352"><a href="#cb1-352" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>rel_m_cMS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-353"><a href="#cb1-353" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>rel_m_InSuc<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-354"><a href="#cb1-354" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>rel_m_feSuc<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-355"><a href="#cb1-355" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>rel_m_pFec<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-356"><a href="#cb1-356" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>rel_m_PS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-357"><a href="#cb1-357" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>rel_m_pFec_compl<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-358"><a href="#cb1-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-359"><a href="#cb1-359" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>rel_f_RS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-360"><a href="#cb1-360" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>rel_f_prop_RS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-361"><a href="#cb1-361" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>rel_f_cMS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-362"><a href="#cb1-362" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>rel_f_fec_pMate<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-363"><a href="#cb1-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-364"><a href="#cb1-364" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>rel_m_RS<span class="ot">=</span>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>m_RS,<span class="at">na.rm=</span>T)</span>
<span id="cb1-365"><a href="#cb1-365" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>rel_m_prop_RS<span class="ot">=</span>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>m_prop_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>m_prop_RS,<span class="at">na.rm=</span>T)</span>
<span id="cb1-366"><a href="#cb1-366" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>rel_m_cMS<span class="ot">=</span>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>m_cMS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>m_cMS,<span class="at">na.rm=</span>T)</span>
<span id="cb1-367"><a href="#cb1-367" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>rel_m_InSuc<span class="ot">=</span>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>m_InSuc<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>m_InSuc,<span class="at">na.rm=</span>T)</span>
<span id="cb1-368"><a href="#cb1-368" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>rel_m_feSuc<span class="ot">=</span>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>m_feSuc<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>m_feSuc,<span class="at">na.rm=</span>T)</span>
<span id="cb1-369"><a href="#cb1-369" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>rel_m_pFec<span class="ot">=</span>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>m_pFec<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>m_pFec,<span class="at">na.rm=</span>T)</span>
<span id="cb1-370"><a href="#cb1-370" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>rel_m_PS<span class="ot">=</span>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>m_PS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>m_PS,<span class="at">na.rm=</span>T)</span>
<span id="cb1-371"><a href="#cb1-371" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>rel_m_pFec_compl<span class="ot">=</span>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>m_pFec_compl<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>m_pFec_compl,<span class="at">na.rm=</span>T)</span>
<span id="cb1-372"><a href="#cb1-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-373"><a href="#cb1-373" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>rel_f_RS<span class="ot">=</span>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>f_RS,<span class="at">na.rm=</span>T)</span>
<span id="cb1-374"><a href="#cb1-374" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>rel_f_prop_RS<span class="ot">=</span>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>f_prop_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>f_prop_RS,<span class="at">na.rm=</span>T)</span>
<span id="cb1-375"><a href="#cb1-375" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>rel_f_cMS<span class="ot">=</span>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>f_cMS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>f_cMS,<span class="at">na.rm=</span>T)</span>
<span id="cb1-376"><a href="#cb1-376" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>rel_f_fec_pMate<span class="ot">=</span>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>f_fec_pMate<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>f_fec_pMate,<span class="at">na.rm=</span>T)</span>
<span id="cb1-377"><a href="#cb1-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-378"><a href="#cb1-378" aria-hidden="true" tabindex="-1"></a><span class="co"># Small group + small Area</span></span>
<span id="cb1-379"><a href="#cb1-379" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.67</span><span class="ot">=</span>DB_data_clean[DB_data_clean<span class="sc">$</span>Treatment<span class="sc">==</span><span class="st">&#39;D = 0.67&#39;</span>,]</span>
<span id="cb1-380"><a href="#cb1-380" aria-hidden="true" tabindex="-1"></a><span class="co">#Relativize data</span></span>
<span id="cb1-381"><a href="#cb1-381" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>rel_m_RS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-382"><a href="#cb1-382" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>rel_m_prop_RS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-383"><a href="#cb1-383" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>rel_m_cMS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-384"><a href="#cb1-384" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>rel_m_InSuc<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-385"><a href="#cb1-385" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>rel_m_feSuc<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-386"><a href="#cb1-386" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>rel_m_pFec<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-387"><a href="#cb1-387" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>rel_m_PS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-388"><a href="#cb1-388" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>rel_m_pFec_compl<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-389"><a href="#cb1-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-390"><a href="#cb1-390" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>rel_f_RS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-391"><a href="#cb1-391" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>rel_f_prop_RS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-392"><a href="#cb1-392" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>rel_f_cMS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-393"><a href="#cb1-393" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>rel_f_fec_pMate<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-394"><a href="#cb1-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-395"><a href="#cb1-395" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>rel_m_RS<span class="ot">=</span>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>m_RS,<span class="at">na.rm=</span>T)</span>
<span id="cb1-396"><a href="#cb1-396" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>rel_m_prop_RS<span class="ot">=</span>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>m_prop_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>m_prop_RS,<span class="at">na.rm=</span>T)</span>
<span id="cb1-397"><a href="#cb1-397" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>rel_m_cMS<span class="ot">=</span>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>m_cMS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>m_cMS,<span class="at">na.rm=</span>T)</span>
<span id="cb1-398"><a href="#cb1-398" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>rel_m_InSuc<span class="ot">=</span>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>m_InSuc<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>m_InSuc,<span class="at">na.rm=</span>T)</span>
<span id="cb1-399"><a href="#cb1-399" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>rel_m_feSuc<span class="ot">=</span>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>m_feSuc<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>m_feSuc,<span class="at">na.rm=</span>T)</span>
<span id="cb1-400"><a href="#cb1-400" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>rel_m_pFec<span class="ot">=</span>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>m_pFec<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>m_pFec,<span class="at">na.rm=</span>T)</span>
<span id="cb1-401"><a href="#cb1-401" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>rel_m_PS<span class="ot">=</span>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>m_PS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>m_PS,<span class="at">na.rm=</span>T)</span>
<span id="cb1-402"><a href="#cb1-402" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>rel_m_pFec_compl<span class="ot">=</span>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>m_pFec_compl<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>m_pFec_compl,<span class="at">na.rm=</span>T)</span>
<span id="cb1-403"><a href="#cb1-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-404"><a href="#cb1-404" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>rel_f_RS<span class="ot">=</span>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>f_RS,<span class="at">na.rm=</span>T)</span>
<span id="cb1-405"><a href="#cb1-405" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>rel_f_prop_RS<span class="ot">=</span>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>f_prop_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>f_prop_RS,<span class="at">na.rm=</span>T)</span>
<span id="cb1-406"><a href="#cb1-406" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>rel_f_cMS<span class="ot">=</span>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>f_cMS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>f_cMS,<span class="at">na.rm=</span>T)</span>
<span id="cb1-407"><a href="#cb1-407" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>rel_f_fec_pMate<span class="ot">=</span>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>f_fec_pMate<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>f_fec_pMate,<span class="at">na.rm=</span>T)</span>
<span id="cb1-408"><a href="#cb1-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-409"><a href="#cb1-409" aria-hidden="true" tabindex="-1"></a><span class="co"># Large group + small Area</span></span>
<span id="cb1-410"><a href="#cb1-410" aria-hidden="true" tabindex="-1"></a>DB_data_clean_1<span class="fl">.33</span><span class="ot">=</span>DB_data_clean[DB_data_clean<span class="sc">$</span>Treatment<span class="sc">==</span><span class="st">&#39;D = 1.33&#39;</span>,]</span>
<span id="cb1-411"><a href="#cb1-411" aria-hidden="true" tabindex="-1"></a><span class="co">#Relativize data</span></span>
<span id="cb1-412"><a href="#cb1-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-413"><a href="#cb1-413" aria-hidden="true" tabindex="-1"></a>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>rel_m_RS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-414"><a href="#cb1-414" aria-hidden="true" tabindex="-1"></a>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>rel_m_prop_RS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-415"><a href="#cb1-415" aria-hidden="true" tabindex="-1"></a>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>rel_m_cMS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-416"><a href="#cb1-416" aria-hidden="true" tabindex="-1"></a>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>rel_m_InSuc<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-417"><a href="#cb1-417" aria-hidden="true" tabindex="-1"></a>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>rel_m_feSuc<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-418"><a href="#cb1-418" aria-hidden="true" tabindex="-1"></a>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>rel_m_pFec<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-419"><a href="#cb1-419" aria-hidden="true" tabindex="-1"></a>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>rel_m_PS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-420"><a href="#cb1-420" aria-hidden="true" tabindex="-1"></a>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>rel_m_pFec_compl<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-421"><a href="#cb1-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-422"><a href="#cb1-422" aria-hidden="true" tabindex="-1"></a>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>rel_f_RS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-423"><a href="#cb1-423" aria-hidden="true" tabindex="-1"></a>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>rel_f_prop_RS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-424"><a href="#cb1-424" aria-hidden="true" tabindex="-1"></a>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>rel_f_cMS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-425"><a href="#cb1-425" aria-hidden="true" tabindex="-1"></a>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>rel_f_fec_pMate<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-426"><a href="#cb1-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-427"><a href="#cb1-427" aria-hidden="true" tabindex="-1"></a>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>rel_m_RS<span class="ot">=</span>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>m_RS,<span class="at">na.rm=</span>T)</span>
<span id="cb1-428"><a href="#cb1-428" aria-hidden="true" tabindex="-1"></a>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>rel_m_prop_RS<span class="ot">=</span>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>m_prop_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>m_prop_RS,<span class="at">na.rm=</span>T)</span>
<span id="cb1-429"><a href="#cb1-429" aria-hidden="true" tabindex="-1"></a>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>rel_m_cMS<span class="ot">=</span>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>m_cMS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>m_cMS,<span class="at">na.rm=</span>T)</span>
<span id="cb1-430"><a href="#cb1-430" aria-hidden="true" tabindex="-1"></a>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>rel_m_InSuc<span class="ot">=</span>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>m_InSuc<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>m_InSuc,<span class="at">na.rm=</span>T)</span>
<span id="cb1-431"><a href="#cb1-431" aria-hidden="true" tabindex="-1"></a>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>rel_m_feSuc<span class="ot">=</span>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>m_feSuc<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>m_feSuc,<span class="at">na.rm=</span>T)</span>
<span id="cb1-432"><a href="#cb1-432" aria-hidden="true" tabindex="-1"></a>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>rel_m_pFec<span class="ot">=</span>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>m_pFec<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>m_pFec,<span class="at">na.rm=</span>T)</span>
<span id="cb1-433"><a href="#cb1-433" aria-hidden="true" tabindex="-1"></a>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>rel_m_PS<span class="ot">=</span>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>m_PS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>m_PS,<span class="at">na.rm=</span>T)</span>
<span id="cb1-434"><a href="#cb1-434" aria-hidden="true" tabindex="-1"></a>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>rel_m_pFec_compl<span class="ot">=</span>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>m_pFec_compl<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>m_pFec_compl,<span class="at">na.rm=</span>T)</span>
<span id="cb1-435"><a href="#cb1-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-436"><a href="#cb1-436" aria-hidden="true" tabindex="-1"></a>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>rel_f_RS<span class="ot">=</span>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>f_RS,<span class="at">na.rm=</span>T)</span>
<span id="cb1-437"><a href="#cb1-437" aria-hidden="true" tabindex="-1"></a>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>rel_f_prop_RS<span class="ot">=</span>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>f_prop_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>f_prop_RS,<span class="at">na.rm=</span>T)</span>
<span id="cb1-438"><a href="#cb1-438" aria-hidden="true" tabindex="-1"></a>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>rel_f_cMS<span class="ot">=</span>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>f_cMS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>f_cMS,<span class="at">na.rm=</span>T)</span>
<span id="cb1-439"><a href="#cb1-439" aria-hidden="true" tabindex="-1"></a>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>rel_f_fec_pMate<span class="ot">=</span>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>f_fec_pMate<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>f_fec_pMate,<span class="at">na.rm=</span>T)</span>
<span id="cb1-440"><a href="#cb1-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-441"><a href="#cb1-441" aria-hidden="true" tabindex="-1"></a><span class="co"># Set colors for figures</span></span>
<span id="cb1-442"><a href="#cb1-442" aria-hidden="true" tabindex="-1"></a>colpal<span class="ot">=</span><span class="fu">brewer.pal</span>(<span class="dv">4</span>, <span class="st">&#39;Dark2&#39;</span>)</span>
<span id="cb1-443"><a href="#cb1-443" aria-hidden="true" tabindex="-1"></a>colpal2<span class="ot">=</span><span class="fu">brewer.pal</span>(<span class="dv">3</span>, <span class="st">&#39;Set1&#39;</span>)</span>
<span id="cb1-444"><a href="#cb1-444" aria-hidden="true" tabindex="-1"></a>colpal3<span class="ot">=</span><span class="fu">brewer.pal</span>(<span class="dv">4</span>, <span class="st">&#39;Paired&#39;</span>)</span>
<span id="cb1-445"><a href="#cb1-445" aria-hidden="true" tabindex="-1"></a>slava_ukrajini<span class="ot">=</span>(<span class="fu">c</span>(<span class="st">&#39;#0057B8&#39;</span>,<span class="st">&#39;#FFD700&#39;</span>))</span>
<span id="cb1-446"><a href="#cb1-446" aria-hidden="true" tabindex="-1"></a>colorESEB<span class="ot">=</span><span class="fu">c</span>(<span class="st">&#39;#01519c&#39;</span>,<span class="st">&#39;#ffdf33&#39;</span>)</span>
<span id="cb1-447"><a href="#cb1-447" aria-hidden="true" tabindex="-1"></a>colorESEB2<span class="ot">=</span><span class="fu">c</span>(<span class="st">&#39;#1DA1F2&#39;</span>,<span class="st">&#39;#ffec69&#39;</span>)</span>
<span id="cb1-448"><a href="#cb1-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-449"><a href="#cb1-449" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge data according to treatment #### -&gt; Reduce treatments to area and population size</span></span>
<span id="cb1-450"><a href="#cb1-450" aria-hidden="true" tabindex="-1"></a><span class="co">#Area</span></span>
<span id="cb1-451"><a href="#cb1-451" aria-hidden="true" tabindex="-1"></a>DB_data_clean_Large_area<span class="ot">=</span><span class="fu">rbind</span>(DB_data_clean_0<span class="fl">.26</span>,DB_data_clean_0<span class="fl">.52</span>)</span>
<span id="cb1-452"><a href="#cb1-452" aria-hidden="true" tabindex="-1"></a>DB_data_clean_Small_area<span class="ot">=</span><span class="fu">rbind</span>(DB_data_clean_0<span class="fl">.67</span>,DB_data_clean_1<span class="fl">.33</span>)</span>
<span id="cb1-453"><a href="#cb1-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-454"><a href="#cb1-454" aria-hidden="true" tabindex="-1"></a><span class="co">#Population size</span></span>
<span id="cb1-455"><a href="#cb1-455" aria-hidden="true" tabindex="-1"></a>DB_data_clean_Small_pop<span class="ot">=</span><span class="fu">rbind</span>(DB_data_clean_0<span class="fl">.26</span>,DB_data_clean_0<span class="fl">.67</span>)</span>
<span id="cb1-456"><a href="#cb1-456" aria-hidden="true" tabindex="-1"></a>DB_data_clean_Large_pop<span class="ot">=</span><span class="fu">rbind</span>(DB_data_clean_0<span class="fl">.52</span>,DB_data_clean_1<span class="fl">.33</span>)</span>
<span id="cb1-457"><a href="#cb1-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-458"><a href="#cb1-458" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge data according to treatment full data set #### -&gt; Reduce treatments to area and population size</span></span>
<span id="cb1-459"><a href="#cb1-459" aria-hidden="true" tabindex="-1"></a>DB_data_0<span class="fl">.26</span><span class="ot">=</span>DB_data[DB_data<span class="sc">$</span>Treatment<span class="sc">==</span><span class="st">&#39;D = 0.26&#39;</span>,]</span>
<span id="cb1-460"><a href="#cb1-460" aria-hidden="true" tabindex="-1"></a>DB_data_0<span class="fl">.52</span><span class="ot">=</span>DB_data[DB_data<span class="sc">$</span>Treatment<span class="sc">==</span><span class="st">&#39;D = 0.52&#39;</span>,]</span>
<span id="cb1-461"><a href="#cb1-461" aria-hidden="true" tabindex="-1"></a>DB_data_0<span class="fl">.67</span><span class="ot">=</span>DB_data[DB_data<span class="sc">$</span>Treatment<span class="sc">==</span><span class="st">&#39;D = 0.67&#39;</span>,]</span>
<span id="cb1-462"><a href="#cb1-462" aria-hidden="true" tabindex="-1"></a>DB_data_1<span class="fl">.33</span><span class="ot">=</span>DB_data[DB_data<span class="sc">$</span>Treatment<span class="sc">==</span><span class="st">&#39;D = 1.33&#39;</span>,]</span>
<span id="cb1-463"><a href="#cb1-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-464"><a href="#cb1-464" aria-hidden="true" tabindex="-1"></a><span class="co">#Area</span></span>
<span id="cb1-465"><a href="#cb1-465" aria-hidden="true" tabindex="-1"></a>DB_data_Large_area_full<span class="ot">=</span><span class="fu">rbind</span>(DB_data_0<span class="fl">.26</span>,DB_data_0<span class="fl">.52</span>)</span>
<span id="cb1-466"><a href="#cb1-466" aria-hidden="true" tabindex="-1"></a>DB_data_Small_area_full<span class="ot">=</span><span class="fu">rbind</span>(DB_data_0<span class="fl">.67</span>,DB_data_1<span class="fl">.33</span>)</span>
<span id="cb1-467"><a href="#cb1-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-468"><a href="#cb1-468" aria-hidden="true" tabindex="-1"></a><span class="co">#Population size</span></span>
<span id="cb1-469"><a href="#cb1-469" aria-hidden="true" tabindex="-1"></a>DB_data_Small_pop_full<span class="ot">=</span><span class="fu">rbind</span>(DB_data_0<span class="fl">.26</span>,DB_data_0<span class="fl">.67</span>)</span>
<span id="cb1-470"><a href="#cb1-470" aria-hidden="true" tabindex="-1"></a>DB_data_Large_pop_full<span class="ot">=</span><span class="fu">rbind</span>(DB_data_0<span class="fl">.52</span>,DB_data_1<span class="fl">.33</span>)</span></code></pre></div>
</div>
<div id="repeatability" class="section level1">
<h1>Repeatability</h1>
<p>Repeatability of body mass measures.<br> Intra-class correlation
coefficient:<br> - Males</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ICCest</span>(DB_data<span class="sc">$</span>Body_mass_mg_focal[DB_data<span class="sc">$</span>Sex<span class="sc">==</span><span class="st">&#39;M&#39;</span>], DB_data<span class="sc">$</span>Mass_reproducibility_mg_focal[DB_data<span class="sc">$</span>Sex<span class="sc">==</span><span class="st">&#39;M&#39;</span>])</span></code></pre></div>
<pre><code>NAs removed from rows:
 1 2 3 4 5 6 7 8 9 10 13 16 17 19 20 22 23 24 25 26 27 28 30 31 32 33 34 35 37 38 39 40 41 43 44 45 46 49 50 51 52 55 56 58 59 60 61 63 64 66 67 68 69 70 71 72 73 74 77 78 79 81 82 85 86 87 93 94 96 99 101 105 106 107 108 110 114 116 118 119 121 122 123 124 125 126 127 128 130 131 133 134 135 136 138 139 140 141 142 144 145 146 147 148 149 151 152 153 157 158 159 160 161 </code></pre>
<pre><code>$ICC
[1] 0.9742984

$LowerCI
[1] 0.9286547

$UpperCI
[1] 0.9888462

$N
[1] 35

$k
[1] 1.363971

$varw
[1] 0.0009358974

$vara
[1] 0.03547804</code></pre>
<ul>
<li>Females</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ICCest</span>(DB_data<span class="sc">$</span>Body_mass_mg_focal[DB_data<span class="sc">$</span>Sex<span class="sc">==</span><span class="st">&#39;F&#39;</span>], DB_data<span class="sc">$</span>Mass_reproducibility_mg_focal[DB_data<span class="sc">$</span>Sex<span class="sc">==</span><span class="st">&#39;F&#39;</span>])</span></code></pre></div>
<pre><code>NAs removed from rows:
 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 19 20 21 24 25 26 27 28 29 30 31 32 34 35 36 37 38 39 41 45 47 48 49 51 53 54 61 63 66 75 76 77 78 79 80 82 83 84 86 87 91 92 93 94 95 96 97 98 99 100 101 103 104 105 107 108 109 110 111 112 113 114 115 116 117 118 119 121 123 124 125 126 127 128 129 130 132 133 134 137 138 141 142 143 144 145 147 149 150 151 152 153 </code></pre>
<pre><code>$ICC
[1] 0.9813802

$LowerCI
[1] 0.9479268

$UpperCI
[1] 0.9920222

$N
[1] 33

$k
[1] 1.384511

$varw
[1] 0.0007602564

$vara
[1] 0.0400702</code></pre>
</div>
<div id="effect-of-body-mass-on-reproductive-success"
class="section level1">
<h1>Effect of body mass on reproductive success</h1>
<p>Correlation between body mass and reproductive success (selection
gradient).</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Effect of body mass on reproductive success - Selection gradient ####</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Male</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>DB_data_clean_M<span class="ot">=</span>DB_data_clean[DB_data_clean<span class="sc">$</span>Sex<span class="sc">==</span><span class="st">&#39;M&#39;</span>,]</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Standardize body mass</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>DB_data_clean_M<span class="sc">$</span>stder_BM_focal<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>DB_data_clean_M<span class="sc">$</span>stder_BM_focal<span class="ot">=</span>DB_data_clean_M<span class="sc">$</span>Body_mass_mg_focal<span class="sc">-</span><span class="fu">mean</span>(DB_data_clean_M<span class="sc">$</span>Body_mass_mg_focal)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>DB_data_clean_M<span class="sc">$</span>stder_BM_focal<span class="ot">=</span>DB_data_clean_M<span class="sc">$</span>stder_BM_focal<span class="sc">/</span><span class="fu">sd</span>(DB_data_clean_M<span class="sc">$</span>Body_mass_mg_focal)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Model treatment</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>treat1M<span class="ot">=</span><span class="fu">glm</span>(m_RS<span class="sc">~</span>Gr_size<span class="sc">*</span>Area,<span class="at">data=</span>DB_data_clean_M,<span class="at">family =</span> quasipoisson)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>DB_data_clean_M<span class="sc">$</span>res_RS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>DB_data_clean_M<span class="sc">$</span>res_RS<span class="ot">=</span><span class="fu">residuals</span>(treat1M)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Males</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>p3<span class="ot">=</span><span class="fu">ggplot</span>(DB_data_clean_M, <span class="fu">aes</span>(<span class="at">x=</span>stder_BM_focal, <span class="at">y=</span>res_RS)) <span class="sc">+</span> </span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>)<span class="sc">+</span><span class="fu">xlab</span>(<span class="st">&#39;Standardized male body mass&#39;</span>)<span class="sc">+</span><span class="fu">ylab</span>(<span class="st">&#39;Res. offspring number&#39;</span>)<span class="sc">+</span><span class="fu">labs</span>(<span class="at">tag =</span> <span class="st">&quot;A&quot;</span>)<span class="sc">+</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span>lm,<span class="at">color=</span><span class="st">&quot;black&quot;</span>)<span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">13</span>),<span class="at">axis.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>)) <span class="sc">+</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),<span class="at">panel.background =</span> <span class="fu">element_blank</span>(), <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>))<span class="sc">+</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">3</span>,<span class="fl">2.3</span>)<span class="sc">+</span><span class="fu">ylim</span>(<span class="sc">-</span><span class="dv">13</span>,<span class="dv">23</span>)</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="co">#Females</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>DB_data_clean_F<span class="ot">=</span>DB_data_clean[DB_data_clean<span class="sc">$</span>Sex<span class="sc">==</span><span class="st">&#39;F&#39;</span>,]</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a><span class="co">#Standardize body mass</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>DB_data_clean_F<span class="sc">$</span>stder_BM_focal<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>DB_data_clean_F<span class="sc">$</span>stder_BM_focal<span class="ot">=</span>DB_data_clean_F<span class="sc">$</span>Body_mass_mg_focal<span class="sc">-</span><span class="fu">mean</span>(DB_data_clean_F<span class="sc">$</span>Body_mass_mg_focal)</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>DB_data_clean_F<span class="sc">$</span>stder_BM_focal<span class="ot">=</span>DB_data_clean_F<span class="sc">$</span>stder_BM_focal<span class="sc">/</span><span class="fu">sd</span>(DB_data_clean_F<span class="sc">$</span>Body_mass_mg_focal)</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a><span class="co">#Model treatment</span></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>treat1F<span class="ot">=</span><span class="fu">glm</span>(f_RS<span class="sc">~</span>Gr_size<span class="sc">*</span>Area,<span class="at">data=</span>DB_data_clean_F,<span class="at">family =</span> quasipoisson)</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>DB_data_clean_F<span class="sc">$</span>res_RS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>DB_data_clean_F<span class="sc">$</span>res_RS<span class="ot">=</span><span class="fu">residuals</span>(treat1F)</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>p4<span class="ot">=</span><span class="fu">ggplot</span>(DB_data_clean_F, <span class="fu">aes</span>(<span class="at">x=</span>stder_BM_focal, <span class="at">y=</span>res_RS)) <span class="sc">+</span> </span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>)<span class="sc">+</span><span class="fu">xlab</span>(<span class="st">&#39;Standardized female body mass&#39;</span>)<span class="sc">+</span><span class="fu">ylab</span>(<span class="st">&#39;Res. offspring number&#39;</span>)<span class="sc">+</span><span class="fu">labs</span>(<span class="at">tag =</span> <span class="st">&quot;B&quot;</span>)<span class="sc">+</span></span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span>lm,<span class="at">color=</span><span class="st">&quot;black&quot;</span>)<span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">13</span>),<span class="at">axis.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>)) <span class="sc">+</span></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),<span class="at">panel.background =</span> <span class="fu">element_blank</span>(), <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>))<span class="sc">+</span></span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">3</span>,<span class="fl">2.3</span>)<span class="sc">+</span><span class="fu">ylim</span>(<span class="sc">-</span><span class="dv">13</span>,<span class="dv">23</span>)</span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p3,p4, <span class="at">nrow =</span> <span class="dv">1</span>,<span class="at">ncol=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="figure/index3.Rmd/unnamed-chunk-4-1.png" width="960" style="display: block; margin: auto;" />
Figure 1: Scatter plots of relationship between standardized body mass
and residual offspring number for males (A) and females (B).<br><br>
Statistical tests<br> Selection gradient for males</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>mod2<span class="ot">=</span><span class="fu">glm</span>(res_RS<span class="sc">~</span>stder_BM_focal,<span class="at">data=</span>DB_data_clean_M,<span class="at">family =</span> gaussian)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod2)</span></code></pre></div>
<pre><code>
Call:
glm(formula = res_RS ~ stder_BM_focal, family = gaussian, data = DB_data_clean_M)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-11.394   -7.822    1.084    5.700   21.803  

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)     -1.4484     0.7408  -1.955   0.0533 .
stder_BM_focal   0.4628     0.7444   0.622   0.5355  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for gaussian family taken to be 57.07626)

    Null deviance: 5843.8  on 103  degrees of freedom
Residual deviance: 5821.8  on 102  degrees of freedom
AIC: 719.74

Number of Fisher Scoring iterations: 2</code></pre>
<p>Selection gradient for females</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>mod3<span class="ot">=</span><span class="fu">glm</span>(res_RS<span class="sc">~</span>stder_BM_focal,<span class="at">data=</span>DB_data_clean_F,<span class="at">family =</span> gaussian)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod3)</span></code></pre></div>
<pre><code>
Call:
glm(formula = res_RS ~ stder_BM_focal, family = gaussian, data = DB_data_clean_F)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-12.723   -6.899    1.355    6.902   12.972  

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)     -1.6909     0.7503  -2.254  0.02647 * 
stder_BM_focal   2.2394     0.7541   2.970  0.00376 **
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for gaussian family taken to be 55.73024)

    Null deviance: 5897.3  on 98  degrees of freedom
Residual deviance: 5405.8  on 97  degrees of freedom
AIC: 682.96

Number of Fisher Scoring iterations: 2</code></pre>
<p>Testing for a sex difference (sex x treatment interaction).</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>DB_data_clean_C<span class="ot">=</span><span class="fu">rbind</span>(DB_data_clean_F,DB_data_clean_M)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>mod4<span class="ot">=</span><span class="fu">glm</span>(res_RS<span class="sc">~</span>stder_BM_focal<span class="sc">*</span>Sex,<span class="at">data=</span>DB_data_clean_C,<span class="at">family =</span> gaussian)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod4)</span></code></pre></div>
<pre><code>
Call:
glm(formula = res_RS ~ stder_BM_focal * Sex, family = gaussian, 
    data = DB_data_clean_C)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-12.723   -7.614    1.355    6.488   21.803  

Coefficients:
                    Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)          -1.6909     0.7549  -2.240  0.02621 * 
stder_BM_focal        2.2394     0.7588   2.951  0.00354 **
SexM                  0.2425     1.0547   0.230  0.81839   
stder_BM_focal:SexM  -1.7766     1.0599  -1.676  0.09528 . 
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for gaussian family taken to be 56.42016)

    Null deviance: 11744  on 202  degrees of freedom
Residual deviance: 11228  on 199  degrees of freedom
AIC: 1400.7

Number of Fisher Scoring iterations: 2</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Anova(mod4,type=3) #If the interactions are not significant, type II gives a more powerful test.</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(mod4,<span class="at">type=</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>Analysis of Deviance Table (Type II tests)

Response: res_RS
                   LR Chisq Df Pr(&gt;Chisq)  
stder_BM_focal       6.2924  1    0.01213 *
Sex                  0.0529  1    0.81815  
stder_BM_focal:Sex   2.8095  1    0.09371 .
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="effect-of-body-mass-on-reproductive-behaviour"
class="section level1">
<h1>Effect of body mass on reproductive behaviour</h1>
<p>Correlation between body mass and reproductive behaviour:<br> -
Number of matings<br> - Number of mating partners (mating success)<br> -
Proportion of successful matings<br></p>
<div id="number-of-matings" class="section level2">
<h2>Number of matings</h2>
<p>Correlation between body mass and the number of matings.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Effect of body mass on mating number ####</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Males</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>DB_data_M<span class="ot">=</span>DB_data[DB_data<span class="sc">$</span>Sex<span class="sc">==</span><span class="st">&#39;M&#39;</span>,]</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Standardize body mass</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>DB_data_M<span class="sc">$</span>stder_BM_focal<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>DB_data_M<span class="sc">$</span>stder_BM_focal<span class="ot">=</span>DB_data_M<span class="sc">$</span>Body_mass_mg_focal<span class="sc">-</span><span class="fu">mean</span>(DB_data_M<span class="sc">$</span>Body_mass_mg_focal)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>DB_data_M<span class="sc">$</span>stder_BM_focal<span class="ot">=</span>DB_data_M<span class="sc">$</span>stder_BM_focal<span class="sc">/</span><span class="fu">sd</span>(DB_data_M<span class="sc">$</span>Body_mass_mg_focal)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Model treatment</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>treat1M_MR<span class="ot">=</span><span class="fu">glm</span>(m_TotMatings<span class="sc">~</span>Gr_size<span class="sc">*</span>Area,<span class="at">data=</span>DB_data_M,<span class="at">family =</span> quasipoisson)</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>DB_data_M<span class="sc">$</span>res_MR<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>DB_data_M<span class="sc">$</span>res_MR<span class="ot">=</span><span class="fu">residuals</span>(treat1M_MR)</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>p5<span class="ot">=</span><span class="fu">ggplot</span>(DB_data_M, <span class="fu">aes</span>(<span class="at">x=</span>stder_BM_focal, <span class="at">y=</span>res_MR)) <span class="sc">+</span> </span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>)<span class="sc">+</span><span class="fu">xlab</span>(<span class="st">&#39;Standardized male body mass&#39;</span>)<span class="sc">+</span><span class="fu">ylab</span>(<span class="st">&#39;Res. number of matings&#39;</span>)<span class="sc">+</span><span class="fu">labs</span>(<span class="at">tag =</span> <span class="st">&quot;A&quot;</span>)<span class="sc">+</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span>lm,<span class="at">color=</span><span class="st">&quot;black&quot;</span>)<span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">13</span>),<span class="at">axis.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>)) <span class="sc">+</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),<span class="at">panel.background =</span> <span class="fu">element_blank</span>(), <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>))<span class="sc">+</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="fl">3.1</span>,<span class="fl">2.4</span>)<span class="sc">+</span><span class="fu">ylim</span>(<span class="sc">-</span><span class="fl">2.7</span>,<span class="fl">4.2</span>)</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a><span class="co">#Females</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>DB_data_F<span class="ot">=</span>DB_data[DB_data<span class="sc">$</span>Sex<span class="sc">==</span><span class="st">&#39;F&#39;</span>,]</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a><span class="co">#Standardize body mass</span></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>DB_data_F<span class="sc">$</span>stder_BM_focal<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>DB_data_F<span class="sc">$</span>stder_BM_focal<span class="ot">=</span>DB_data_F<span class="sc">$</span>Body_mass_mg_focal<span class="sc">-</span><span class="fu">mean</span>(DB_data_F<span class="sc">$</span>Body_mass_mg_focal)</span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>DB_data_F<span class="sc">$</span>stder_BM_focal<span class="ot">=</span>DB_data_F<span class="sc">$</span>stder_BM_focal<span class="sc">/</span><span class="fu">sd</span>(DB_data_F<span class="sc">$</span>Body_mass_mg_focal)</span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a><span class="co">#Model treatment</span></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>treat1F_MR<span class="ot">=</span><span class="fu">glm</span>(f_TotMatings<span class="sc">~</span>Gr_size<span class="sc">*</span>Area,<span class="at">data=</span>DB_data_F,<span class="at">family =</span> quasipoisson)</span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>DB_data_F<span class="sc">$</span>res_MR<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>DB_data_F<span class="sc">$</span>res_MR<span class="ot">=</span><span class="fu">residuals</span>(treat1F_MR)</span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>p6<span class="ot">=</span><span class="fu">ggplot</span>(DB_data_F, <span class="fu">aes</span>(<span class="at">x=</span>stder_BM_focal, <span class="at">y=</span>res_MR)) <span class="sc">+</span> </span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>)<span class="sc">+</span><span class="fu">xlab</span>(<span class="st">&#39;Standardized female body mass&#39;</span>)<span class="sc">+</span><span class="fu">ylab</span>(<span class="st">&#39;Res. number of matings&#39;</span>)<span class="sc">+</span><span class="fu">labs</span>(<span class="at">tag =</span> <span class="st">&quot;B&quot;</span>)<span class="sc">+</span></span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span>lm,<span class="at">color=</span><span class="st">&quot;black&quot;</span>)<span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">13</span>),<span class="at">axis.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>)) <span class="sc">+</span></span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),<span class="at">panel.background =</span> <span class="fu">element_blank</span>(), <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>))<span class="sc">+</span></span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="fl">3.1</span>,<span class="fl">2.4</span>)<span class="sc">+</span><span class="fu">ylim</span>(<span class="sc">-</span><span class="fl">2.7</span>,<span class="fl">4.2</span>)</span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p5,p6, <span class="at">nrow =</span> <span class="dv">1</span>,<span class="at">ncol=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="figure/index3.Rmd/unnamed-chunk-8-1.png" width="960" style="display: block; margin: auto;" />
Figure 2: Scatter plots of relationship between standardized body mass
and residual number of matings for males (A) and females (B).<br><br>
Statistical tests<br> Males</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>mod5<span class="ot">=</span><span class="fu">glm</span>(res_MR<span class="sc">~</span>stder_BM_focal,<span class="at">data=</span>DB_data_M,<span class="at">family =</span> gaussian)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod5)</span></code></pre></div>
<pre><code>
Call:
glm(formula = res_MR ~ stder_BM_focal, family = gaussian, data = DB_data_M)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.3383  -0.6797   0.0964   0.7216   3.3582  

Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)    -0.141687   0.089096  -1.590    0.114
stder_BM_focal -0.002149   0.089374  -0.024    0.981

(Dispersion parameter for gaussian family taken to be 1.278027)

    Null deviance: 203.21  on 160  degrees of freedom
Residual deviance: 203.21  on 159  degrees of freedom
AIC: 500.38

Number of Fisher Scoring iterations: 2</code></pre>
<p>Females</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>mod6<span class="ot">=</span><span class="fu">glm</span>(res_MR<span class="sc">~</span>stder_BM_focal,<span class="at">data=</span>DB_data_F,<span class="at">family =</span> gaussian)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod6)</span></code></pre></div>
<pre><code>
Call:
glm(formula = res_MR ~ stder_BM_focal, family = gaussian, data = DB_data_F)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.3550  -1.0704  -0.0556   0.7454   4.3127  

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)     -0.2062     0.1035  -1.993   0.0481 * 
stder_BM_focal   0.3178     0.1038   3.061   0.0026 **
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for gaussian family taken to be 1.659158)

    Null deviance: 269.40  on 154  degrees of freedom
Residual deviance: 253.85  on 153  degrees of freedom
AIC: 522.34

Number of Fisher Scoring iterations: 2</code></pre>
<p>Testing for a sex difference (sex x treatment interaction).</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Sex difference?</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>DB_data_clean_C<span class="ot">=</span><span class="fu">rbind</span>(DB_data_F,DB_data_M)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>mod4<span class="ot">=</span><span class="fu">glm</span>(res_MR<span class="sc">~</span>stder_BM_focal<span class="sc">*</span>Sex,<span class="at">data=</span>DB_data_clean_C,<span class="at">family =</span> gaussian)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod4)</span></code></pre></div>
<pre><code>
Call:
glm(formula = res_MR ~ stder_BM_focal * Sex, family = gaussian, 
    data = DB_data_clean_C)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.3550  -0.7234   0.0215   0.7283   4.3127  

Coefficients:
                    Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)         -0.20618    0.09722  -2.121  0.03472 * 
stder_BM_focal       0.31775    0.09753   3.258  0.00125 **
SexM                 0.06450    0.13620   0.474  0.63615   
stder_BM_focal:SexM -0.31990    0.13663  -2.341  0.01984 * 
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for gaussian family taken to be 1.464928)

    Null deviance: 472.94  on 315  degrees of freedom
Residual deviance: 457.06  on 312  degrees of freedom
AIC: 1023.4

Number of Fisher Scoring iterations: 2</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(mod4,<span class="at">type=</span><span class="dv">3</span>) <span class="co">#If the interactions are not significant, type II gives a more powerful test.</span></span></code></pre></div>
<pre><code>Analysis of Deviance Table (Type III tests)

Response: res_MR
                   LR Chisq Df Pr(&gt;Chisq)   
stder_BM_focal      10.6142  1   0.001122 **
Sex                  0.2242  1   0.635821   
stder_BM_focal:Sex   5.4819  1   0.019214 * 
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Anova(mod4,type=2)</span></span></code></pre></div>
</div>
<div id="number-of-mating-partners" class="section level2">
<h2>Number of mating partners</h2>
<p>Correlation between body mass and the number of mating partners.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Effect of body mass on mating success ####</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Males</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Model treatment</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>treat1M_MS<span class="ot">=</span><span class="fu">glm</span>(m_cMS<span class="sc">~</span>Gr_size<span class="sc">*</span>Area,<span class="at">data=</span>DB_data_M,<span class="at">family =</span> quasipoisson)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>DB_data_M<span class="sc">$</span>res_MS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>DB_data_M<span class="sc">$</span>res_MS<span class="ot">=</span><span class="fu">residuals</span>(treat1M_MS)</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>p7<span class="ot">=</span><span class="fu">ggplot</span>(DB_data_M, <span class="fu">aes</span>(<span class="at">x=</span>stder_BM_focal, <span class="at">y=</span>res_MS)) <span class="sc">+</span> </span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>)<span class="sc">+</span><span class="fu">xlab</span>(<span class="st">&#39;Standardized male body mass&#39;</span>)<span class="sc">+</span><span class="fu">ylab</span>(<span class="st">&#39;Res. number of mating partners&#39;</span>)<span class="sc">+</span><span class="fu">labs</span>(<span class="at">tag =</span> <span class="st">&quot;A&quot;</span>)<span class="sc">+</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span>lm,<span class="at">color=</span><span class="st">&quot;black&quot;</span>)<span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">13</span>),<span class="at">axis.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>)) <span class="sc">+</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),<span class="at">panel.background =</span> <span class="fu">element_blank</span>(), <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>))<span class="sc">+</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="fl">3.1</span>,<span class="fl">2.4</span>)<span class="sc">+</span><span class="fu">ylim</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="fl">2.5</span>)</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a><span class="co">#Females</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a><span class="co">#Model treatment</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>treat1F_MS<span class="ot">=</span><span class="fu">glm</span>(f_cMS<span class="sc">~</span>Gr_size<span class="sc">*</span>Area,<span class="at">data=</span>DB_data_F,<span class="at">family =</span> quasipoisson)</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>DB_data_F<span class="sc">$</span>res_MS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>DB_data_F<span class="sc">$</span>res_MS<span class="ot">=</span><span class="fu">residuals</span>(treat1F_MS)</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>p8<span class="ot">=</span><span class="fu">ggplot</span>(DB_data_F, <span class="fu">aes</span>(<span class="at">x=</span>stder_BM_focal, <span class="at">y=</span>res_MS)) <span class="sc">+</span> </span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>)<span class="sc">+</span><span class="fu">xlab</span>(<span class="st">&#39;Standardized female body mass&#39;</span>)<span class="sc">+</span><span class="fu">ylab</span>(<span class="st">&#39;Res. number of mating partners&#39;</span>)<span class="sc">+</span><span class="fu">labs</span>(<span class="at">tag =</span> <span class="st">&quot;B&quot;</span>)<span class="sc">+</span></span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span>lm,<span class="at">color=</span><span class="st">&quot;black&quot;</span>)<span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">13</span>),<span class="at">axis.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>)) <span class="sc">+</span></span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),<span class="at">panel.background =</span> <span class="fu">element_blank</span>(), <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>))<span class="sc">+</span></span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="fl">3.1</span>,<span class="fl">2.4</span>)<span class="sc">+</span><span class="fu">ylim</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="fl">2.5</span>)</span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p7,p8, <span class="at">nrow =</span> <span class="dv">1</span>,<span class="at">ncol=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="figure/index3.Rmd/unnamed-chunk-12-1.png" width="960" style="display: block; margin: auto;" />
Figure 3: Scatter plots of relationship between standardized body mass
and residual number of mating partners for males (A) and females
(B).<br><br> Statistical tests<br> Males</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>mod7<span class="ot">=</span><span class="fu">glm</span>(res_MS<span class="sc">~</span>stder_BM_focal,<span class="at">data=</span>DB_data_M,<span class="at">family =</span> gaussian)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod7)</span></code></pre></div>
<pre><code>
Call:
glm(formula = res_MS ~ stder_BM_focal, family = gaussian, data = DB_data_M)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.8428  -0.4506   0.2713   0.3866   2.2196  

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)    -0.08519    0.06108  -1.395    0.165
stder_BM_focal -0.05431    0.06127  -0.886    0.377

(Dispersion parameter for gaussian family taken to be 0.6006104)

    Null deviance: 95.969  on 160  degrees of freedom
Residual deviance: 95.497  on 159  degrees of freedom
AIC: 378.81

Number of Fisher Scoring iterations: 2</code></pre>
<p>Females</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>mod7<span class="ot">=</span><span class="fu">glm</span>(res_MS<span class="sc">~</span>stder_BM_focal,<span class="at">data=</span>DB_data_F,<span class="at">family =</span> gaussian)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod7)</span></code></pre></div>
<pre><code>
Call:
glm(formula = res_MS ~ stder_BM_focal, family = gaussian, data = DB_data_F)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.0623  -0.5118   0.1379   0.6399   2.1628  

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)    -0.12575    0.07105   -1.77  0.07872 . 
stder_BM_focal  0.23592    0.07128    3.31  0.00116 **
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for gaussian family taken to be 0.7823699)

    Null deviance: 128.27  on 154  degrees of freedom
Residual deviance: 119.70  on 153  degrees of freedom
AIC: 405.82

Number of Fisher Scoring iterations: 2</code></pre>
<p>Testing for a sex difference (sex x treatment interaction).</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Sex difference?</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>DB_data_clean_C<span class="ot">=</span><span class="fu">rbind</span>(DB_data_F,DB_data_M)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>mod4<span class="ot">=</span><span class="fu">glm</span>(res_MS<span class="sc">~</span>stder_BM_focal<span class="sc">*</span>Sex,<span class="at">data=</span>DB_data_clean_C,<span class="at">family =</span> gaussian)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod4)</span></code></pre></div>
<pre><code>
Call:
glm(formula = res_MS ~ stder_BM_focal * Sex, family = gaussian, 
    data = DB_data_clean_C)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.0623  -0.4644   0.2046   0.4252   2.2196  

Coefficients:
                    Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)         -0.12575    0.06671  -1.885 0.060342 .  
stder_BM_focal       0.23592    0.06692   3.525 0.000487 ***
SexM                 0.04056    0.09346   0.434 0.664594    
stder_BM_focal:SexM -0.29023    0.09375  -3.096 0.002142 ** 
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for gaussian family taken to be 0.6897425)

    Null deviance: 224.37  on 315  degrees of freedom
Residual deviance: 215.20  on 312  degrees of freedom
AIC: 785.37

Number of Fisher Scoring iterations: 2</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Anova(mod4,type=3) #If the interactions are not significant, type II gives a more powerful test.</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(mod4,<span class="at">type=</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>Analysis of Deviance Table (Type II tests)

Response: res_MS
                   LR Chisq Df Pr(&gt;Chisq)   
stder_BM_focal       3.5281  1   0.060336 . 
Sex                  0.1883  1   0.664294   
stder_BM_focal:Sex   9.5830  1   0.001964 **
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="proportion-of-successful-matings" class="section level2">
<h2>Proportion of successful matings</h2>
<p>Correlation between body mass and the proportion of successful
matings.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Effect of BM on proportion successful matings ####</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Males</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Model treatment</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>treat1M_Prop_MS<span class="ot">=</span><span class="fu">glm</span>(Prop_MS<span class="sc">~</span>Gr_size<span class="sc">*</span>Area,<span class="at">data=</span>DB_data_M,<span class="at">family =</span> quasibinomial,<span class="at">na.action=</span>na.exclude)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>DB_data_M<span class="sc">$</span>res_Prop_MS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>DB_data_M<span class="sc">$</span>res_Prop_MS<span class="ot">=</span><span class="fu">residuals</span>(treat1M_Prop_MS)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>p9<span class="ot">=</span><span class="fu">ggplot</span>(DB_data_M, <span class="fu">aes</span>(<span class="at">x=</span>stder_BM_focal, <span class="at">y=</span>res_Prop_MS)) <span class="sc">+</span> </span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>)<span class="sc">+</span><span class="fu">xlab</span>(<span class="st">&#39;Standardized male body mass&#39;</span>)<span class="sc">+</span><span class="fu">ylab</span>(<span class="st">&#39;Res. prop. of successful matings&#39;</span>)<span class="sc">+</span><span class="fu">labs</span>(<span class="at">tag =</span> <span class="st">&quot;A&quot;</span>)<span class="sc">+</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span>lm,<span class="at">color=</span><span class="st">&quot;black&quot;</span>)<span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">13</span>),<span class="at">axis.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>)) <span class="sc">+</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),<span class="at">panel.background =</span> <span class="fu">element_blank</span>(), <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>))<span class="sc">+</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="fl">3.1</span>,<span class="fl">2.4</span>)<span class="sc">+</span><span class="fu">ylim</span>(<span class="sc">-</span><span class="fl">0.8</span>,<span class="fl">1.6</span>)</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a><span class="co">#Females</span></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a><span class="co">#Model treatment</span></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>treat1F_Prop_MS<span class="ot">=</span><span class="fu">glm</span>(Prop_MS<span class="sc">~</span>Gr_size<span class="sc">*</span>Area,<span class="at">data=</span>DB_data_F,<span class="at">family =</span> quasibinomial,<span class="at">na.action=</span>na.exclude)</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>DB_data_F<span class="sc">$</span>res_Prop_MS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>DB_data_F<span class="sc">$</span>res_Prop_MS<span class="ot">=</span><span class="fu">residuals</span>(treat1F_Prop_MS)</span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>p10<span class="ot">=</span><span class="fu">ggplot</span>(DB_data_F, <span class="fu">aes</span>(<span class="at">x=</span>stder_BM_focal, <span class="at">y=</span>res_Prop_MS)) <span class="sc">+</span> </span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>)<span class="sc">+</span><span class="fu">xlab</span>(<span class="st">&#39;Standardized female body mass&#39;</span>)<span class="sc">+</span><span class="fu">ylab</span>(<span class="st">&#39;Res. prop. of successful matings&#39;</span>)<span class="sc">+</span><span class="fu">labs</span>(<span class="at">tag =</span> <span class="st">&quot;B&quot;</span>)<span class="sc">+</span></span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span>lm,<span class="at">color=</span><span class="st">&quot;black&quot;</span>)<span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">13</span>),<span class="at">axis.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>)) <span class="sc">+</span></span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),<span class="at">panel.background =</span> <span class="fu">element_blank</span>(), <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>))<span class="sc">+</span></span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="fl">3.1</span>,<span class="fl">2.4</span>)<span class="sc">+</span><span class="fu">ylim</span>(<span class="sc">-</span><span class="fl">0.8</span>,<span class="fl">1.6</span>)</span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p9,p10, <span class="at">nrow =</span> <span class="dv">1</span>,<span class="at">ncol=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="figure/index3.Rmd/unnamed-chunk-16-1.png" width="960" style="display: block; margin: auto;" />
Figure 4: Scatter plots of relationship between standardized body mass
and residual proportion of successful matings for males (A) and females
(B).<br><br> Statistical tests<br> Males</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>mod7<span class="ot">=</span><span class="fu">glm</span>(res_Prop_MS<span class="sc">~</span>stder_BM_focal,<span class="at">data=</span>DB_data_M,<span class="at">family =</span> gaussian)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod7)</span></code></pre></div>
<pre><code>
Call:
glm(formula = res_Prop_MS ~ stder_BM_focal, family = gaussian, 
    data = DB_data_M)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-0.68186  -0.27630  -0.04741   0.22588   1.43708  

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)    -0.01261    0.03208  -0.393    0.695
stder_BM_focal -0.03442    0.03238  -1.063    0.290

(Dispersion parameter for gaussian family taken to be 0.1521604)

    Null deviance: 22.387  on 147  degrees of freedom
Residual deviance: 22.215  on 146  degrees of freedom
  (13 observations deleted due to missingness)
AIC: 145.33

Number of Fisher Scoring iterations: 2</code></pre>
<p>Females</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>mod7<span class="ot">=</span><span class="fu">glm</span>(res_Prop_MS<span class="sc">~</span>stder_BM_focal,<span class="at">data=</span>DB_data_F,<span class="at">family =</span> gaussian)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod7)</span></code></pre></div>
<pre><code>
Call:
glm(formula = res_Prop_MS ~ stder_BM_focal, family = gaussian, 
    data = DB_data_F)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-0.73785  -0.35714  -0.07916   0.23794   1.49479  

Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)    -0.003811   0.041903  -0.091    0.928
stder_BM_focal -0.031200   0.044334  -0.704    0.483

(Dispersion parameter for gaussian family taken to be 0.2254128)

    Null deviance: 28.964  on 129  degrees of freedom
Residual deviance: 28.853  on 128  degrees of freedom
  (25 observations deleted due to missingness)
AIC: 179.23

Number of Fisher Scoring iterations: 2</code></pre>
<p>Testing for a sex difference (sex x treatment interaction).</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Sex difference?</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>DB_data_clean_C<span class="ot">=</span><span class="fu">rbind</span>(DB_data_F,DB_data_M)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>mod4<span class="ot">=</span><span class="fu">glm</span>(res_Prop_MS<span class="sc">~</span>stder_BM_focal<span class="sc">*</span>Sex,<span class="at">data=</span>DB_data_clean_C,<span class="at">family =</span> gaussian)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod4)</span></code></pre></div>
<pre><code>
Call:
glm(formula = res_Prop_MS ~ stder_BM_focal * Sex, family = gaussian, 
    data = DB_data_clean_C)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.7379  -0.3174  -0.0581   0.2367   1.4948  

Coefficients:
                     Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)         -0.003811   0.038103  -0.100    0.920
stder_BM_focal      -0.031200   0.040313  -0.774    0.440
SexM                -0.008798   0.052083  -0.169    0.866
stder_BM_focal:SexM -0.003218   0.053939  -0.060    0.952

(Dispersion parameter for gaussian family taken to be 0.1863805)

    Null deviance: 51.355  on 277  degrees of freedom
Residual deviance: 51.068  on 274  degrees of freedom
  (38 observations deleted due to missingness)
AIC: 327.87

Number of Fisher Scoring iterations: 2</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Anova(mod4,type=3) #If the interactions are not significant, type II gives a more powerful test.</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(mod4,<span class="at">type=</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>Analysis of Deviance Table (Type II tests)

Response: res_Prop_MS
                   LR Chisq Df Pr(&gt;Chisq)
stder_BM_focal      1.51780  1     0.2180
Sex                 0.03029  1     0.8618
stder_BM_focal:Sex  0.00356  1     0.9524</code></pre>
</div>
</div>
<div id="density-treatment-and-body-mass" class="section level1">
<h1>Density treatment and body mass</h1>
<p>Here we tested the interaction of the density treatment and body
mass. ## Reproductive success Males</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Males</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Model treatment</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>ModT1<span class="ot">=</span><span class="fu">glm</span>(m_RS<span class="sc">~</span>stder_BM_focal<span class="sc">*</span>Gr_size<span class="sc">*</span>Area,<span class="at">data=</span>DB_data_clean_M,<span class="at">family =</span> quasipoisson)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ModT1)</span></code></pre></div>
<pre><code>
Call:
glm(formula = m_RS ~ stder_BM_focal * Gr_size * Area, family = quasipoisson, 
    data = DB_data_clean_M)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-12.9828   -9.2345   -0.1822    3.9908   19.7971  

Coefficients:
                                     Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                         3.9365122  0.2752815  14.300   &lt;2e-16 ***
stder_BM_focal                     -0.0201361  0.2598560  -0.077    0.938    
Gr_sizeLG                          -0.1123254  0.3462061  -0.324    0.746    
AreaSmall                           0.3657216  0.3223165   1.135    0.259    
stder_BM_focal:Gr_sizeLG            0.2210450  0.3246145   0.681    0.498    
stder_BM_focal:AreaSmall           -0.1194431  0.3108891  -0.384    0.702    
Gr_sizeLG:AreaSmall                -0.3239441  0.4473036  -0.724    0.471    
stder_BM_focal:Gr_sizeLG:AreaSmall  0.0007873  0.4426930   0.002    0.999    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for quasipoisson family taken to be 53.71862)

    Null deviance: 6253.5  on 103  degrees of freedom
Residual deviance: 5961.8  on  96  degrees of freedom
AIC: NA

Number of Fisher Scoring iterations: 6</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Anova(ModT1,type=3) #If the interactions are not significant, type II gives a more powerful test.</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(ModT1,<span class="at">type=</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>Analysis of Deviance Table (Type II tests)

Response: m_RS
                            LR Chisq Df Pr(&gt;Chisq)
stder_BM_focal               0.03629  1     0.8489
Gr_size                      2.49466  1     0.1142
Area                         1.18691  1     0.2760
stder_BM_focal:Gr_size       1.01929  1     0.3127
stder_BM_focal:Area          0.28702  1     0.5921
Gr_size:Area                 0.54260  1     0.4614
stder_BM_focal:Gr_size:Area  0.00000  1     0.9986</code></pre>
<p>Females</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Females</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Model treatment</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>ModT2<span class="ot">=</span><span class="fu">glm</span>(f_RS<span class="sc">~</span>stder_BM_focal<span class="sc">*</span>Gr_size<span class="sc">*</span>Area,<span class="at">data=</span>DB_data_clean_F,<span class="at">family =</span> quasipoisson)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ModT2)</span></code></pre></div>
<pre><code>
Call:
glm(formula = f_RS ~ stder_BM_focal * Gr_size * Area, family = quasipoisson, 
    data = DB_data_clean_F)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-12.919   -8.886   -1.206    5.387   11.193  

Coefficients:
                                    Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                         4.051255   0.164331  24.653   &lt;2e-16 ***
stder_BM_focal                      0.088055   0.181067   0.486    0.628    
Gr_sizeLG                          -0.350207   0.308144  -1.137    0.259    
AreaSmall                          -0.323725   0.285456  -1.134    0.260    
stder_BM_focal:Gr_sizeLG            0.255679   0.309906   0.825    0.412    
stder_BM_focal:AreaSmall            0.193118   0.283134   0.682    0.497    
Gr_sizeLG:AreaSmall                 0.481967   0.440290   1.095    0.277    
stder_BM_focal:Gr_sizeLG:AreaSmall -0.001952   0.441307  -0.004    0.996    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for quasipoisson family taken to be 48.60039)

    Null deviance: 6268.7  on 98  degrees of freedom
Residual deviance: 5669.3  on 91  degrees of freedom
AIC: NA

Number of Fisher Scoring iterations: 6</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Anova(ModT2,type=3) #If the interactions are not significant, type II gives a more powerful test.</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(ModT2,<span class="at">type=</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>Analysis of Deviance Table (Type II tests)

Response: f_RS
                            LR Chisq Df Pr(&gt;Chisq)   
stder_BM_focal                7.9202  1   0.004889 **
Gr_size                       0.0416  1   0.838310   
Area                          0.0658  1   0.797609   
stder_BM_focal:Gr_size        1.3502  1   0.245243   
stder_BM_focal:Area           0.7930  1   0.373205   
Gr_size:Area                  1.3528  1   0.244782   
stder_BM_focal:Gr_size:Area   0.0000  1   0.996471   
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div id="number-of-matings-1" class="section level2">
<h2>Number of matings</h2>
<p>Males</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Males</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Model treatment</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>ModT1<span class="ot">=</span><span class="fu">glm</span>(m_TotMatings<span class="sc">~</span>stder_BM_focal<span class="sc">*</span>Gr_size<span class="sc">*</span>Area,<span class="at">data=</span>DB_data_M,<span class="at">family =</span> quasipoisson)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ModT1)</span></code></pre></div>
<pre><code>
Call:
glm(formula = m_TotMatings ~ stder_BM_focal * Gr_size * Area, 
    family = quasipoisson, data = DB_data_M)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.4755  -0.8581  -0.1191   0.5468   3.2217  

Coefficients:
                                   Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                         1.07096    0.12184   8.790 2.89e-15 ***
stder_BM_focal                     -0.02196    0.12344  -0.178   0.8591    
Gr_sizeLG                          -0.30669    0.16776  -1.828   0.0695 .  
AreaSmall                           0.03641    0.15782   0.231   0.8178    
stder_BM_focal:Gr_sizeLG           -0.12044    0.16544  -0.728   0.4677    
stder_BM_focal:AreaSmall            0.16486    0.16890   0.976   0.3306    
Gr_sizeLG:AreaSmall                -0.02603    0.23728  -0.110   0.9128    
stder_BM_focal:Gr_sizeLG:AreaSmall -0.03781    0.23897  -0.158   0.8745    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for quasipoisson family taken to be 1.28703)

    Null deviance: 219.60  on 160  degrees of freedom
Residual deviance: 202.24  on 153  degrees of freedom
AIC: NA

Number of Fisher Scoring iterations: 5</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Anova(ModT1,type=3) #If the interactions are not significant, type II gives a more powerful test.</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(ModT1,<span class="at">type=</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>Analysis of Deviance Table (Type II tests)

Response: m_TotMatings
                            LR Chisq Df Pr(&gt;Chisq)   
stder_BM_focal                0.0276  1   0.867939   
Gr_size                       6.9318  1   0.008468 **
Area                          0.0087  1   0.925775   
stder_BM_focal:Gr_size        1.3436  1   0.246400   
stder_BM_focal:Area           1.5029  1   0.220230   
Gr_size:Area                  0.0094  1   0.922607   
stder_BM_focal:Gr_size:Area   0.0250  1   0.874258   
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Females</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Females</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Model treatment</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>ModT2<span class="ot">=</span><span class="fu">glm</span>(f_TotMatings<span class="sc">~</span>stder_BM_focal<span class="sc">*</span>Gr_size<span class="sc">*</span>Area,<span class="at">data=</span>DB_data_F,<span class="at">family =</span> quasipoisson)</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ModT2)</span></code></pre></div>
<pre><code>
Call:
glm(formula = f_TotMatings ~ stder_BM_focal * Gr_size * Area, 
    family = quasipoisson, data = DB_data_F)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.3335  -1.2043  -0.2771   0.4441   3.9971  

Coefficients:
                                   Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                         1.15378    0.10889  10.596   &lt;2e-16 ***
stder_BM_focal                      0.18056    0.11456   1.576   0.1171    
Gr_sizeLG                          -0.53957    0.21028  -2.566   0.0113 *  
AreaSmall                          -0.23530    0.18107  -1.299   0.1958    
stder_BM_focal:Gr_sizeLG           -0.08486    0.21438  -0.396   0.6928    
stder_BM_focal:AreaSmall           -0.09025    0.17444  -0.517   0.6057    
Gr_sizeLG:AreaSmall                 0.19895    0.30459   0.653   0.5147    
stder_BM_focal:Gr_sizeLG:AreaSmall  0.36257    0.30775   1.178   0.2406    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for quasipoisson family taken to be 1.819396)

    Null deviance: 298.54  on 154  degrees of freedom
Residual deviance: 261.57  on 147  degrees of freedom
AIC: NA

Number of Fisher Scoring iterations: 5</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Anova(ModT2,type=3) #If the interactions are not significant, type II gives a more powerful test.</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(ModT2,<span class="at">type=</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>Analysis of Deviance Table (Type II tests)

Response: f_TotMatings
                            LR Chisq Df Pr(&gt;Chisq)   
stder_BM_focal                6.0743  1   0.013716 * 
Gr_size                       9.1006  1   0.002555 **
Area                          1.0495  1   0.305613   
stder_BM_focal:Gr_size        0.3787  1   0.538321   
stder_BM_focal:Area           0.0405  1   0.840530   
Gr_size:Area                  0.8158  1   0.366419   
stder_BM_focal:Gr_size:Area   1.3995  1   0.236807   
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="number-of-mating-partners-1" class="section level2">
<h2>Number of mating partners</h2>
<p>Males</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Males</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Model treatment</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>ModT1<span class="ot">=</span><span class="fu">glm</span>(m_cMS<span class="sc">~</span>stder_BM_focal<span class="sc">*</span>Gr_size<span class="sc">*</span>Area,<span class="at">data=</span>DB_data_M,<span class="at">family =</span> quasipoisson)</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ModT1)</span></code></pre></div>
<pre><code>
Call:
glm(formula = m_cMS ~ stder_BM_focal * Gr_size * Area, family = quasipoisson, 
    data = DB_data_M)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.9702  -0.5412   0.1364   0.2913   2.2159  

Coefficients:
                                    Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                         0.514699   0.102225   5.035 1.33e-06 ***
stder_BM_focal                      0.026405   0.104501   0.253    0.801    
Gr_sizeLG                           0.031385   0.131187   0.239    0.811    
AreaSmall                          -0.028294   0.134223  -0.211    0.833    
stder_BM_focal:Gr_sizeLG           -0.180778   0.130773  -1.382    0.169    
stder_BM_focal:AreaSmall           -0.009218   0.143795  -0.064    0.949    
Gr_sizeLG:AreaSmall                 0.017297   0.185207   0.093    0.926    
stder_BM_focal:Gr_sizeLG:AreaSmall  0.093090   0.187605   0.496    0.620    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for quasipoisson family taken to be 0.5272771)

    Null deviance: 97.278  on 160  degrees of freedom
Residual deviance: 94.769  on 153  degrees of freedom
AIC: NA

Number of Fisher Scoring iterations: 5</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Anova(ModT1,type=3) #If the interactions are not significant, type II gives a more powerful test.</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(ModT1,<span class="at">type=</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>Analysis of Deviance Table (Type II tests)

Response: m_cMS
                            LR Chisq Df Pr(&gt;Chisq)
stder_BM_focal               1.75424  1     0.1853
Gr_size                      0.41253  1     0.5207
Area                         0.05590  1     0.8131
stder_BM_focal:Gr_size       2.07280  1     0.1499
stder_BM_focal:Area          0.24321  1     0.6219
Gr_size:Area                 0.00100  1     0.9748
stder_BM_focal:Gr_size:Area  0.24579  1     0.6201</code></pre>
<p>Females</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Females</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Model treatment</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>ModT2<span class="ot">=</span><span class="fu">glm</span>(f_cMS<span class="sc">~</span>stder_BM_focal<span class="sc">*</span>Gr_size<span class="sc">*</span>Area,<span class="at">data=</span>DB_data_F,<span class="at">family =</span> quasipoisson)</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ModT2)</span></code></pre></div>
<pre><code>
Call:
glm(formula = f_cMS ~ stder_BM_focal * Gr_size * Area, family = quasipoisson, 
    data = DB_data_F)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-1.97428  -0.63095  -0.02418   0.50377   2.12530  

Coefficients:
                                    Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                         0.603441   0.087773   6.875 1.65e-10 ***
stder_BM_focal                      0.128619   0.093958   1.369    0.173    
Gr_sizeLG                          -0.222851   0.152270  -1.464    0.145    
AreaSmall                          -0.238617   0.146523  -1.629    0.106    
stder_BM_focal:Gr_sizeLG           -0.022745   0.156456  -0.145    0.885    
stder_BM_focal:AreaSmall            0.007264   0.142895   0.051    0.960    
Gr_sizeLG:AreaSmall                 0.273617   0.221386   1.236    0.218    
stder_BM_focal:Gr_sizeLG:AreaSmall  0.190087   0.222670   0.854    0.395    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for quasipoisson family taken to be 0.6879626)

    Null deviance: 133.68  on 154  degrees of freedom
Residual deviance: 122.81  on 147  degrees of freedom
AIC: NA

Number of Fisher Scoring iterations: 5</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Anova(ModT2,type=3) #If the interactions are not significant, type II gives a more powerful test.</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(ModT2,<span class="at">type=</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>Analysis of Deviance Table (Type II tests)

Response: f_cMS
                            LR Chisq Df Pr(&gt;Chisq)   
stder_BM_focal                9.5920  1   0.001954 **
Gr_size                       0.6508  1   0.419842   
Area                          0.8286  1   0.362677   
stder_BM_focal:Gr_size        0.4145  1   0.519688   
stder_BM_focal:Area           0.6226  1   0.430078   
Gr_size:Area                  1.9817  1   0.159216   
stder_BM_focal:Gr_size:Area   0.7299  1   0.392910   
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="proportion-of-successful-matings-1" class="section level2">
<h2>Proportion of successful matings</h2>
<p>Males</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Males</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Model treatment</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>ModT1<span class="ot">=</span><span class="fu">glm</span>(Prop_MS<span class="sc">~</span>stder_BM_focal<span class="sc">*</span>Gr_size<span class="sc">*</span>Area,<span class="at">data=</span>DB_data_M,<span class="at">family =</span> quasibinomial)</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ModT1)</span></code></pre></div>
<pre><code>
Call:
glm(formula = Prop_MS ~ stder_BM_focal * Gr_size * Area, family = quasibinomial, 
    data = DB_data_M)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-0.74502  -0.28399  -0.04377   0.21477   1.44401  

Coefficients:
                                   Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                         -0.7988     0.1573  -5.078  1.2e-06 ***
stder_BM_focal                      -0.2806     0.1794  -1.564    0.120    
Gr_sizeLG                            0.1350     0.2045   0.660    0.510    
AreaSmall                            0.1939     0.2020   0.960    0.339    
stder_BM_focal:Gr_sizeLG             0.2332     0.2154   1.083    0.281    
stder_BM_focal:AreaSmall             0.2863     0.2289   1.251    0.213    
Gr_sizeLG:AreaSmall                 -0.2348     0.2838  -0.827    0.409    
stder_BM_focal:Gr_sizeLG:AreaSmall  -0.2946     0.2940  -1.002    0.318    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for quasibinomial family taken to be 0.1493034)

    Null deviance: 22.477  on 147  degrees of freedom
Residual deviance: 21.992  on 140  degrees of freedom
  (13 observations deleted due to missingness)
AIC: NA

Number of Fisher Scoring iterations: 4</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Anova(ModT1,type=3) #If the interactions are not significant, type II gives a more powerful test.</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(ModT1,<span class="at">type=</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>Analysis of Deviance Table (Type II tests)

Response: Prop_MS
                            LR Chisq Df Pr(&gt;Chisq)
stder_BM_focal               1.09858  1     0.2946
Gr_size                      0.00190  1     0.9653
Area                         0.15658  1     0.6923
stder_BM_focal:Gr_size       0.27316  1     0.6012
stder_BM_focal:Area          0.57881  1     0.4468
Gr_size:Area                 0.55361  1     0.4568
stder_BM_focal:Gr_size:Area  1.00959  1     0.3150</code></pre>
<p>Females</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Females</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Model treatment</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>ModT2<span class="ot">=</span><span class="fu">glm</span>(Prop_MS<span class="sc">~</span>stder_BM_focal<span class="sc">*</span>Gr_size<span class="sc">*</span>Area,<span class="at">data=</span>DB_data_F,<span class="at">family =</span> quasibinomial)</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ModT2)</span></code></pre></div>
<pre><code>
Call:
glm(formula = Prop_MS ~ stder_BM_focal * Gr_size * Area, family = quasibinomial, 
    data = DB_data_F)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-0.74862  -0.35523  -0.06568   0.24476   1.49450  

Coefficients:
                                   Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)                        -0.32710    0.13682  -2.391   0.0183 *
stder_BM_focal                     -0.07715    0.15674  -0.492   0.6235  
Gr_sizeLG                          -0.11339    0.23708  -0.478   0.6333  
AreaSmall                          -0.39009    0.22154  -1.761   0.0808 .
stder_BM_focal:Gr_sizeLG           -0.33245    0.26922  -1.235   0.2193  
stder_BM_focal:AreaSmall            0.12255    0.22951   0.534   0.5943  
Gr_sizeLG:AreaSmall                 0.38651    0.34511   1.120   0.2649  
stder_BM_focal:Gr_sizeLG:AreaSmall  0.38963    0.36727   1.061   0.2908  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for quasibinomial family taken to be 0.2073228)

    Null deviance: 29.610  on 129  degrees of freedom
Residual deviance: 28.089  on 122  degrees of freedom
  (25 observations deleted due to missingness)
AIC: NA

Number of Fisher Scoring iterations: 3</code></pre>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Anova(ModT2,type=3) #If the interactions are not significant, type II gives a more powerful test.</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(ModT2,<span class="at">type=</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>Analysis of Deviance Table (Type II tests)

Response: Prop_MS
                            LR Chisq Df Pr(&gt;Chisq)
stder_BM_focal               0.43199  1     0.5110
Gr_size                      0.13451  1     0.7138
Area                         1.51521  1     0.2183
stder_BM_focal:Gr_size       0.46389  1     0.4958
stder_BM_focal:Area          2.42000  1     0.1198
Gr_size:Area                 1.49477  1     0.2215
stder_BM_focal:Gr_size:Area  1.13236  1     0.2873</code></pre>
</div>
</div>
<div id="selection-coefficients" class="section level1">
<h1>Selection coefficients</h1>
<p>Finally, we used bootstrapping to estimate treatment specific
selection coeficients on body mass.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Selection coefficients ####</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="co">#All </span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Males</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Bootstrap</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>selDif_BW_males <span class="ot">=</span> <span class="cf">function</span>(dataFrame, indexVector) { </span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Calculate relative fitness</span></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>  rel_fit_males<span class="ot">=</span>dataFrame[indexVector, <span class="fu">match</span>(<span class="st">&quot;m_RS&quot;</span>,<span class="fu">names</span>(dataFrame))]<span class="sc">/</span><span class="fu">mean</span>(dataFrame[indexVector, <span class="fu">match</span>(<span class="st">&quot;m_RS&quot;</span>,<span class="fu">names</span>(dataFrame))],<span class="at">na.rm=</span>T)</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Calculate selection differential</span></span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">=</span> <span class="fu">cov</span>(dataFrame[indexVector, <span class="fu">match</span>(<span class="st">&quot;stder_BM_focal&quot;</span>,<span class="fu">names</span>(dataFrame))],rel_fit_males,<span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(s)</span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a>boot_BW_males <span class="ot">=</span> <span class="fu">boot</span>(DB_data_clean_M, selDif_BW_males, <span class="at">R =</span> <span class="dv">10000</span>)</span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a><span class="co">#Females</span></span>
<span id="cb77-17"><a href="#cb77-17" aria-hidden="true" tabindex="-1"></a>selDif_BW_females <span class="ot">=</span> <span class="cf">function</span>(dataFrame, indexVector) { </span>
<span id="cb77-18"><a href="#cb77-18" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Calculate relative fitness</span></span>
<span id="cb77-19"><a href="#cb77-19" aria-hidden="true" tabindex="-1"></a>  rel_fit_females<span class="ot">=</span>dataFrame[indexVector, <span class="fu">match</span>(<span class="st">&quot;f_RS&quot;</span>,<span class="fu">names</span>(dataFrame))]<span class="sc">/</span><span class="fu">mean</span>(dataFrame[indexVector, <span class="fu">match</span>(<span class="st">&quot;f_RS&quot;</span>,<span class="fu">names</span>(dataFrame))],<span class="at">na.rm=</span>T)</span>
<span id="cb77-20"><a href="#cb77-20" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Calculate selection differential</span></span>
<span id="cb77-21"><a href="#cb77-21" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">=</span> <span class="fu">cov</span>(dataFrame[indexVector, <span class="fu">match</span>(<span class="st">&quot;stder_BM_focal&quot;</span>,<span class="fu">names</span>(dataFrame))],rel_fit_females,<span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb77-22"><a href="#cb77-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(s)</span>
<span id="cb77-23"><a href="#cb77-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb77-24"><a href="#cb77-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-25"><a href="#cb77-25" aria-hidden="true" tabindex="-1"></a>boot_BW_females <span class="ot">=</span> <span class="fu">boot</span>(DB_data_clean_F, selDif_BW_females, <span class="at">R =</span> <span class="dv">10000</span>)</span>
<span id="cb77-26"><a href="#cb77-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-27"><a href="#cb77-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-28"><a href="#cb77-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Selection coefficients for treatments</span></span>
<span id="cb77-29"><a href="#cb77-29" aria-hidden="true" tabindex="-1"></a><span class="co">#Males</span></span>
<span id="cb77-30"><a href="#cb77-30" aria-hidden="true" tabindex="-1"></a><span class="co">#Group size</span></span>
<span id="cb77-31"><a href="#cb77-31" aria-hidden="true" tabindex="-1"></a><span class="co">#Small group</span></span>
<span id="cb77-32"><a href="#cb77-32" aria-hidden="true" tabindex="-1"></a>boot_BW_males_group_size_small <span class="ot">=</span> <span class="fu">boot</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,], selDif_BW_males, <span class="at">R =</span> <span class="dv">10000</span>)</span>
<span id="cb77-33"><a href="#cb77-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-34"><a href="#cb77-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-35"><a href="#cb77-35" aria-hidden="true" tabindex="-1"></a><span class="co">#Large group</span></span>
<span id="cb77-36"><a href="#cb77-36" aria-hidden="true" tabindex="-1"></a>boot_BW_males_group_size_large <span class="ot">=</span> <span class="fu">boot</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,], selDif_BW_males, <span class="at">R =</span> <span class="dv">10000</span>)</span>
<span id="cb77-37"><a href="#cb77-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-38"><a href="#cb77-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-39"><a href="#cb77-39" aria-hidden="true" tabindex="-1"></a><span class="co">#Area</span></span>
<span id="cb77-40"><a href="#cb77-40" aria-hidden="true" tabindex="-1"></a><span class="co">#Large Area</span></span>
<span id="cb77-41"><a href="#cb77-41" aria-hidden="true" tabindex="-1"></a>boot_BW_males_area_large <span class="ot">=</span> <span class="fu">boot</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,], selDif_BW_males, <span class="at">R =</span> <span class="dv">10000</span>)</span>
<span id="cb77-42"><a href="#cb77-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-43"><a href="#cb77-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-44"><a href="#cb77-44" aria-hidden="true" tabindex="-1"></a><span class="co">#Small Area</span></span>
<span id="cb77-45"><a href="#cb77-45" aria-hidden="true" tabindex="-1"></a>boot_BW_males_area_small <span class="ot">=</span> <span class="fu">boot</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,], selDif_BW_males, <span class="at">R =</span> <span class="dv">10000</span>)</span>
<span id="cb77-46"><a href="#cb77-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-47"><a href="#cb77-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-48"><a href="#cb77-48" aria-hidden="true" tabindex="-1"></a><span class="co">#Females</span></span>
<span id="cb77-49"><a href="#cb77-49" aria-hidden="true" tabindex="-1"></a><span class="co">#Group size</span></span>
<span id="cb77-50"><a href="#cb77-50" aria-hidden="true" tabindex="-1"></a><span class="co">#Small group</span></span>
<span id="cb77-51"><a href="#cb77-51" aria-hidden="true" tabindex="-1"></a>boot_BW_females_group_size_small <span class="ot">=</span> <span class="fu">boot</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,], selDif_BW_females, <span class="at">R =</span> <span class="dv">10000</span>)</span>
<span id="cb77-52"><a href="#cb77-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-53"><a href="#cb77-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-54"><a href="#cb77-54" aria-hidden="true" tabindex="-1"></a><span class="co">#Large group</span></span>
<span id="cb77-55"><a href="#cb77-55" aria-hidden="true" tabindex="-1"></a>boot_BW_females_group_size_large <span class="ot">=</span> <span class="fu">boot</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,], selDif_BW_females, <span class="at">R =</span> <span class="dv">10000</span>)</span>
<span id="cb77-56"><a href="#cb77-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-57"><a href="#cb77-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-58"><a href="#cb77-58" aria-hidden="true" tabindex="-1"></a><span class="co">#Area</span></span>
<span id="cb77-59"><a href="#cb77-59" aria-hidden="true" tabindex="-1"></a><span class="co">#Large Area</span></span>
<span id="cb77-60"><a href="#cb77-60" aria-hidden="true" tabindex="-1"></a>boot_BW_females_area_large <span class="ot">=</span> <span class="fu">boot</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,], selDif_BW_females, <span class="at">R =</span> <span class="dv">10000</span>)</span>
<span id="cb77-61"><a href="#cb77-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-62"><a href="#cb77-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-63"><a href="#cb77-63" aria-hidden="true" tabindex="-1"></a><span class="co">#Small Area</span></span>
<span id="cb77-64"><a href="#cb77-64" aria-hidden="true" tabindex="-1"></a>boot_BW_females_area_small <span class="ot">=</span> <span class="fu">boot</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,], selDif_BW_females, <span class="at">R =</span> <span class="dv">10000</span>)</span>
<span id="cb77-65"><a href="#cb77-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-66"><a href="#cb77-66" aria-hidden="true" tabindex="-1"></a><span class="co">#Data table ####</span></span>
<span id="cb77-67"><a href="#cb77-67" aria-hidden="true" tabindex="-1"></a>boot_data_BW_males <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(<span class="st">&quot;Male&quot;</span>, <span class="st">&quot;Mass&quot;</span>, <span class="st">&quot;All&quot;</span>, <span class="fu">mean</span>(boot_BW_males<span class="sc">$</span>t,<span class="at">na.rm=</span>T), <span class="fu">quantile</span>(boot_BW_males<span class="sc">$</span>t,.<span class="dv">025</span>, <span class="at">names =</span> <span class="cn">FALSE</span>,<span class="at">na.rm=</span>T), <span class="fu">quantile</span>(boot_BW_males<span class="sc">$</span>t,.<span class="dv">975</span>, <span class="at">names =</span> <span class="cn">FALSE</span>,<span class="at">na.rm=</span>T)))</span>
<span id="cb77-68"><a href="#cb77-68" aria-hidden="true" tabindex="-1"></a>boot_data_BW_females <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(<span class="st">&quot;Female&quot;</span>, <span class="st">&quot;Mass&quot;</span>, <span class="st">&quot;All&quot;</span>, <span class="fu">mean</span>(boot_BW_females<span class="sc">$</span>t,<span class="at">na.rm=</span>T), <span class="fu">quantile</span>(boot_BW_females<span class="sc">$</span>t,.<span class="dv">025</span>, <span class="at">names =</span> <span class="cn">FALSE</span>,<span class="at">na.rm=</span>T), <span class="fu">quantile</span>(boot_BW_females<span class="sc">$</span>t,.<span class="dv">975</span>, <span class="at">names =</span> <span class="cn">FALSE</span>,<span class="at">na.rm=</span>T)))</span>
<span id="cb77-69"><a href="#cb77-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-70"><a href="#cb77-70" aria-hidden="true" tabindex="-1"></a>boot_data_BW_males_group_size_small <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(<span class="st">&quot;Male&quot;</span>, <span class="st">&quot;Mass&quot;</span>, <span class="st">&quot;Small group&quot;</span>, <span class="fu">mean</span>(boot_BW_males_group_size_small<span class="sc">$</span>t,<span class="at">na.rm=</span>T), <span class="fu">quantile</span>(boot_BW_males_group_size_small<span class="sc">$</span>t,.<span class="dv">025</span>, <span class="at">names =</span> <span class="cn">FALSE</span>,<span class="at">na.rm=</span>T), <span class="fu">quantile</span>(boot_BW_males_group_size_small<span class="sc">$</span>t,.<span class="dv">975</span>, <span class="at">names =</span> <span class="cn">FALSE</span>,<span class="at">na.rm=</span>T)))</span>
<span id="cb77-71"><a href="#cb77-71" aria-hidden="true" tabindex="-1"></a>boot_data_BW_females_group_size_small <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(<span class="st">&quot;Female&quot;</span>, <span class="st">&quot;Mass&quot;</span>, <span class="st">&quot;Small group&quot;</span>, <span class="fu">mean</span>(boot_BW_females_group_size_small<span class="sc">$</span>t,<span class="at">na.rm=</span>T), <span class="fu">quantile</span>(boot_BW_females_group_size_small<span class="sc">$</span>t,.<span class="dv">025</span>, <span class="at">names =</span> <span class="cn">FALSE</span>,<span class="at">na.rm=</span>T), <span class="fu">quantile</span>(boot_BW_females_group_size_small<span class="sc">$</span>t,.<span class="dv">975</span>, <span class="at">names =</span> <span class="cn">FALSE</span>,<span class="at">na.rm=</span>T)))</span>
<span id="cb77-72"><a href="#cb77-72" aria-hidden="true" tabindex="-1"></a>boot_data_BW_males_group_size_large <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(<span class="st">&quot;Male&quot;</span>, <span class="st">&quot;Mass&quot;</span>, <span class="st">&quot;large group&quot;</span>, <span class="fu">mean</span>(boot_BW_males_group_size_large<span class="sc">$</span>t,<span class="at">na.rm=</span>T), <span class="fu">quantile</span>(boot_BW_males_group_size_large<span class="sc">$</span>t,.<span class="dv">025</span>, <span class="at">names =</span> <span class="cn">FALSE</span>,<span class="at">na.rm=</span>T), <span class="fu">quantile</span>(boot_BW_males_group_size_large<span class="sc">$</span>t,.<span class="dv">975</span>, <span class="at">names =</span> <span class="cn">FALSE</span>,<span class="at">na.rm=</span>T)))</span>
<span id="cb77-73"><a href="#cb77-73" aria-hidden="true" tabindex="-1"></a>boot_data_BW_females_group_size_large <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(<span class="st">&quot;Female&quot;</span>, <span class="st">&quot;Mass&quot;</span>, <span class="st">&quot;large group&quot;</span>, <span class="fu">mean</span>(boot_BW_females_group_size_large<span class="sc">$</span>t,<span class="at">na.rm=</span>T), <span class="fu">quantile</span>(boot_BW_females_group_size_large<span class="sc">$</span>t,.<span class="dv">025</span>, <span class="at">names =</span> <span class="cn">FALSE</span>,<span class="at">na.rm=</span>T), <span class="fu">quantile</span>(boot_BW_females_group_size_large<span class="sc">$</span>t,.<span class="dv">975</span>, <span class="at">names =</span> <span class="cn">FALSE</span>,<span class="at">na.rm=</span>T)))</span>
<span id="cb77-74"><a href="#cb77-74" aria-hidden="true" tabindex="-1"></a>boot_data_BW_males_area_small <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(<span class="st">&quot;Male&quot;</span>, <span class="st">&quot;Mass&quot;</span>, <span class="st">&quot;Small area&quot;</span>, <span class="fu">mean</span>(boot_BW_males_area_small<span class="sc">$</span>t,<span class="at">na.rm=</span>T), <span class="fu">quantile</span>(boot_BW_males_area_small<span class="sc">$</span>t,.<span class="dv">025</span>, <span class="at">names =</span> <span class="cn">FALSE</span>,<span class="at">na.rm=</span>T), <span class="fu">quantile</span>(boot_BW_males_area_small<span class="sc">$</span>t,.<span class="dv">975</span>, <span class="at">names =</span> <span class="cn">FALSE</span>,<span class="at">na.rm=</span>T)))</span>
<span id="cb77-75"><a href="#cb77-75" aria-hidden="true" tabindex="-1"></a>boot_data_BW_females_area_small <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(<span class="st">&quot;Female&quot;</span>, <span class="st">&quot;Mass&quot;</span>, <span class="st">&quot;Small area&quot;</span>, <span class="fu">mean</span>(boot_BW_females_area_small<span class="sc">$</span>t,<span class="at">na.rm=</span>T), <span class="fu">quantile</span>(boot_BW_females_area_small<span class="sc">$</span>t,.<span class="dv">025</span>, <span class="at">names =</span> <span class="cn">FALSE</span>,<span class="at">na.rm=</span>T), <span class="fu">quantile</span>(boot_BW_females_area_small<span class="sc">$</span>t,.<span class="dv">975</span>, <span class="at">names =</span> <span class="cn">FALSE</span>,<span class="at">na.rm=</span>T)))</span>
<span id="cb77-76"><a href="#cb77-76" aria-hidden="true" tabindex="-1"></a>boot_data_BW_males_area_large <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(<span class="st">&quot;Male&quot;</span>, <span class="st">&quot;Mass&quot;</span>, <span class="st">&quot;large area&quot;</span>, <span class="fu">mean</span>(boot_BW_males_area_large<span class="sc">$</span>t,<span class="at">na.rm=</span>T), <span class="fu">quantile</span>(boot_BW_males_area_large<span class="sc">$</span>t,.<span class="dv">025</span>, <span class="at">names =</span> <span class="cn">FALSE</span>,<span class="at">na.rm=</span>T), <span class="fu">quantile</span>(boot_BW_males_area_large<span class="sc">$</span>t,.<span class="dv">975</span>, <span class="at">names =</span> <span class="cn">FALSE</span>,<span class="at">na.rm=</span>T)))</span>
<span id="cb77-77"><a href="#cb77-77" aria-hidden="true" tabindex="-1"></a>boot_data_BW_females_area_large <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(<span class="st">&quot;Female&quot;</span>, <span class="st">&quot;Mass&quot;</span>, <span class="st">&quot;large area&quot;</span>, <span class="fu">mean</span>(boot_BW_females_area_large<span class="sc">$</span>t,<span class="at">na.rm=</span>T), <span class="fu">quantile</span>(boot_BW_females_area_large<span class="sc">$</span>t,.<span class="dv">025</span>, <span class="at">names =</span> <span class="cn">FALSE</span>,<span class="at">na.rm=</span>T), <span class="fu">quantile</span>(boot_BW_females_area_large<span class="sc">$</span>t,.<span class="dv">975</span>, <span class="at">names =</span> <span class="cn">FALSE</span>,<span class="at">na.rm=</span>T)))</span>
<span id="cb77-78"><a href="#cb77-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-79"><a href="#cb77-79" aria-hidden="true" tabindex="-1"></a>SelDifBoot_Table <span class="ot">&lt;-</span> <span class="fu">as.table</span>(<span class="fu">as.matrix</span>(<span class="fu">rbind</span>(boot_data_BW_males,boot_data_BW_females,boot_data_BW_males_group_size_small,boot_data_BW_females_group_size_small,</span>
<span id="cb77-80"><a href="#cb77-80" aria-hidden="true" tabindex="-1"></a>                                             boot_data_BW_males_group_size_large,boot_data_BW_females_group_size_large,</span>
<span id="cb77-81"><a href="#cb77-81" aria-hidden="true" tabindex="-1"></a>                                             boot_data_BW_males_area_small,boot_data_BW_females_area_small,</span>
<span id="cb77-82"><a href="#cb77-82" aria-hidden="true" tabindex="-1"></a>                                             boot_data_BW_males_area_large,boot_data_BW_females_area_large)))</span>
<span id="cb77-83"><a href="#cb77-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-84"><a href="#cb77-84" aria-hidden="true" tabindex="-1"></a><span class="fu">is.table</span>(SelDifBoot_Table)</span>
<span id="cb77-85"><a href="#cb77-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-86"><a href="#cb77-86" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(SelDifBoot_Table)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Sex&quot;</span></span>
<span id="cb77-87"><a href="#cb77-87" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(SelDifBoot_Table)[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Trait&quot;</span></span>
<span id="cb77-88"><a href="#cb77-88" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(SelDifBoot_Table)[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Treatment&quot;</span></span>
<span id="cb77-89"><a href="#cb77-89" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(SelDifBoot_Table)[<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Coefficient&quot;</span></span>
<span id="cb77-90"><a href="#cb77-90" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(SelDifBoot_Table)[<span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="st">&quot;l95_CI&quot;</span></span>
<span id="cb77-91"><a href="#cb77-91" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(SelDifBoot_Table)[<span class="dv">6</span>] <span class="ot">&lt;-</span> <span class="st">&quot;u95_CI&quot;</span></span>
<span id="cb77-92"><a href="#cb77-92" aria-hidden="true" tabindex="-1"></a>SelDifBoot_Table<span class="ot">=</span><span class="fu">as.data.frame.matrix</span>(SelDifBoot_Table)</span>
<span id="cb77-93"><a href="#cb77-93" aria-hidden="true" tabindex="-1"></a>SelDifBoot_Table<span class="sc">$</span>Sex <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">as.character</span>(SelDifBoot_Table<span class="sc">$</span>Sex))</span>
<span id="cb77-94"><a href="#cb77-94" aria-hidden="true" tabindex="-1"></a>SelDifBoot_Table<span class="sc">$</span>Trait <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">as.character</span>(SelDifBoot_Table<span class="sc">$</span>Trait))</span>
<span id="cb77-95"><a href="#cb77-95" aria-hidden="true" tabindex="-1"></a>SelDifBoot_Table<span class="sc">$</span>Treatment <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">as.character</span>(SelDifBoot_Table<span class="sc">$</span>Treatment))</span>
<span id="cb77-96"><a href="#cb77-96" aria-hidden="true" tabindex="-1"></a>SelDifBoot_Table<span class="sc">$</span>Coefficient <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(SelDifBoot_Table<span class="sc">$</span>Coefficient))</span>
<span id="cb77-97"><a href="#cb77-97" aria-hidden="true" tabindex="-1"></a>SelDifBoot_Table<span class="sc">$</span>l95_CI <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(SelDifBoot_Table<span class="sc">$</span>l95_CI))</span>
<span id="cb77-98"><a href="#cb77-98" aria-hidden="true" tabindex="-1"></a>SelDifBoot_Table<span class="sc">$</span>u95_CI <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(SelDifBoot_Table<span class="sc">$</span>u95_CI))</span>
<span id="cb77-99"><a href="#cb77-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-100"><a href="#cb77-100" aria-hidden="true" tabindex="-1"></a>SelDifBoot_Table_round<span class="ot">=</span><span class="fu">cbind</span>(SelDifBoot_Table[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)],<span class="fu">round</span>(SelDifBoot_Table[,<span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>)],<span class="at">digit=</span><span class="dv">3</span>))</span></code></pre></div>
<p>Figure of section coefficients on body mass for different density
treatments.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Figures ####</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>SelDifBoot_Table<span class="sc">$</span>Treatment <span class="ot">&lt;-</span> <span class="fu">factor</span>(SelDifBoot_Table<span class="sc">$</span>Treatment, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;All&quot;</span>,<span class="st">&#39;Small group&#39;</span>,<span class="st">&#39;large group&#39;</span>,<span class="st">&#39;large area&#39;</span>,<span class="st">&#39;Small area&#39;</span>))</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>SelDifBoot_Table<span class="sc">$</span>Sex <span class="ot">&lt;-</span> <span class="fu">factor</span>(SelDifBoot_Table<span class="sc">$</span>Sex, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;Female&quot;</span>,<span class="st">&#39;Male&#39;</span>))</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>BarPlot_2<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(SelDifBoot_Table[<span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>,], <span class="fu">aes</span>(<span class="at">x=</span>Sex, <span class="at">y=</span>Coefficient, <span class="at">fill=</span>Treatment)) <span class="sc">+</span> </span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">27</span>, .<span class="dv">75</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span> ,<span class="dv">0</span>)) <span class="sc">+</span> </span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">0</span>, <span class="at">linetype=</span><span class="st">&quot;solid&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">position=</span><span class="fu">position_dodge</span>(), <span class="at">alpha=</span><span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>l95_CI, <span class="at">ymax=</span>u95_CI), <span class="at">width=</span>.<span class="dv">3</span>,<span class="at">size=</span><span class="dv">1</span>, <span class="at">position=</span><span class="fu">position_dodge</span>(.<span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Standardized selection differential (&quot;</span>,<span class="sc">~</span><span class="fu">italic</span>(<span class="st">&quot;s&#39;&quot;</span>),<span class="st">&quot;)&quot;</span>))) <span class="sc">+</span><span class="fu">xlab</span>(<span class="st">&#39;Sex&#39;</span>) <span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">&#39;Group size&#39;</span>)<span class="sc">+</span><span class="fu">labs</span>(<span class="at">tag =</span> <span class="st">&quot;A&quot;</span>)<span class="sc">+</span></span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">breaks=</span><span class="fu">waiver</span>(),<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Female&quot;</span>,<span class="st">&quot;Male&quot;</span>))<span class="sc">+</span> </span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="fl">0.1</span>,<span class="dv">2</span>,<span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="st">&quot;cm&quot;</span>),</span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb78-18"><a href="#cb78-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.tag.position=</span><span class="fu">c</span>(<span class="fl">0.01</span>,<span class="fl">0.98</span>),</span>
<span id="cb78-19"><a href="#cb78-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">1.05</span>, <span class="fl">0.8</span>),</span>
<span id="cb78-20"><a href="#cb78-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="dv">10</span>),</span>
<span id="cb78-21"><a href="#cb78-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb78-22"><a href="#cb78-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb78-23"><a href="#cb78-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;plain&quot;</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="dv">16</span>, <span class="at">angle=</span><span class="dv">0</span>),</span>
<span id="cb78-24"><a href="#cb78-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;plain&quot;</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="dv">16</span>, <span class="at">angle=</span><span class="dv">0</span>),</span>
<span id="cb78-25"><a href="#cb78-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>,<span class="at">face=</span><span class="st">&quot;plain&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">r=</span><span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">0</span>,<span class="dv">0</span>)),</span>
<span id="cb78-26"><a href="#cb78-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>,<span class="at">face=</span><span class="st">&quot;plain&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">r=</span><span class="dv">10</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)),</span>
<span id="cb78-27"><a href="#cb78-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb78-28"><a href="#cb78-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.length =</span> <span class="fu">unit</span>(.<span class="dv">3</span>, <span class="st">&quot;cm&quot;</span>))<span class="sc">+</span></span>
<span id="cb78-29"><a href="#cb78-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(slava_ukrajini[<span class="dv">1</span>],slava_ukrajini[<span class="dv">2</span>]),<span class="at">name =</span> <span class="st">&quot;&quot;</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Small group&quot;</span>,<span class="st">&#39;Large group&#39;</span>))</span>
<span id="cb78-30"><a href="#cb78-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-31"><a href="#cb78-31" aria-hidden="true" tabindex="-1"></a>BarPlot_3<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(SelDifBoot_Table[<span class="fu">c</span>(<span class="dv">9</span>,<span class="dv">10</span>,<span class="dv">7</span>,<span class="dv">8</span>),], <span class="fu">aes</span>(<span class="at">x=</span>Sex, <span class="at">y=</span>Coefficient, <span class="at">fill=</span>Treatment)) <span class="sc">+</span> </span>
<span id="cb78-32"><a href="#cb78-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">27</span>, .<span class="dv">75</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span>.<span class="dv">3</span>,.<span class="dv">7</span>,.<span class="dv">15</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span> ,<span class="dv">0</span>)) <span class="sc">+</span> </span>
<span id="cb78-33"><a href="#cb78-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">0</span>, <span class="at">linetype=</span><span class="st">&quot;solid&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb78-34"><a href="#cb78-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">position=</span><span class="fu">position_dodge</span>(), <span class="at">alpha=</span><span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb78-35"><a href="#cb78-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>l95_CI, <span class="at">ymax=</span>u95_CI), <span class="at">width=</span>.<span class="dv">3</span>,<span class="at">size=</span><span class="dv">1</span>, <span class="at">position=</span><span class="fu">position_dodge</span>(.<span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb78-36"><a href="#cb78-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;&#39;</span>) <span class="sc">+</span><span class="fu">xlab</span>(<span class="st">&#39;Sex&#39;</span>) <span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">&#39;Area&#39;</span>)<span class="sc">+</span><span class="fu">labs</span>(<span class="at">tag =</span> <span class="st">&quot;B&quot;</span>)<span class="sc">+</span></span>
<span id="cb78-37"><a href="#cb78-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">breaks=</span><span class="fu">waiver</span>(),<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Female&quot;</span>,<span class="st">&quot;Male&quot;</span>))<span class="sc">+</span> </span>
<span id="cb78-38"><a href="#cb78-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb78-39"><a href="#cb78-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="fl">0.1</span>,<span class="dv">2</span>,<span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="st">&quot;cm&quot;</span>),</span>
<span id="cb78-40"><a href="#cb78-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb78-41"><a href="#cb78-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb78-42"><a href="#cb78-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb78-43"><a href="#cb78-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb78-44"><a href="#cb78-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.tag.position=</span><span class="fu">c</span>(<span class="fl">0.01</span>,<span class="fl">0.98</span>),</span>
<span id="cb78-45"><a href="#cb78-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">1.05</span>, <span class="fl">0.8</span>),</span>
<span id="cb78-46"><a href="#cb78-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="dv">10</span>),</span>
<span id="cb78-47"><a href="#cb78-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb78-48"><a href="#cb78-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb78-49"><a href="#cb78-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;plain&quot;</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="dv">16</span>, <span class="at">angle=</span><span class="dv">0</span>),</span>
<span id="cb78-50"><a href="#cb78-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;plain&quot;</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="dv">16</span>, <span class="at">angle=</span><span class="dv">0</span>),</span>
<span id="cb78-51"><a href="#cb78-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>,<span class="at">face=</span><span class="st">&quot;plain&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">r=</span><span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">0</span>,<span class="dv">0</span>)),</span>
<span id="cb78-52"><a href="#cb78-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>,<span class="at">face=</span><span class="st">&quot;plain&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">r=</span><span class="dv">10</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)),</span>
<span id="cb78-53"><a href="#cb78-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb78-54"><a href="#cb78-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.length =</span> <span class="fu">unit</span>(.<span class="dv">3</span>, <span class="st">&quot;cm&quot;</span>))<span class="sc">+</span></span>
<span id="cb78-55"><a href="#cb78-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(slava_ukrajini[<span class="dv">1</span>],slava_ukrajini[<span class="dv">2</span>]),<span class="at">name =</span> <span class="st">&quot;&quot;</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Large area&quot;</span>,<span class="st">&#39;Small area&#39;</span>))</span>
<span id="cb78-56"><a href="#cb78-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-57"><a href="#cb78-57" aria-hidden="true" tabindex="-1"></a>plot1<span class="ot">&lt;-</span><span class="fu">grid.arrange</span>(BarPlot_2,BarPlot_3, <span class="at">nrow =</span> <span class="dv">1</span>,<span class="at">ncol=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="figure/index3.Rmd/unnamed-chunk-29-1.png" width="672" style="display: block; margin: auto;" />
Figure 5: Effect of density on sex-specific standardized selection
differential (s’) for population size (A) and area treatment
(B).<br><br></p>
<p>Permutation tests for differences in density dependent standardized
selection differentials.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Permutation test ####</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Sex bias ####</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="co">#population size ####</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Small</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>Sex_diff_Small_male_pop<span class="ot">=</span><span class="fu">c</span>(boot_BW_males_group_size_small<span class="sc">$</span>t)<span class="sc">-</span><span class="fu">c</span>(boot_BW_females_group_size_small<span class="sc">$</span>t)</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>t_Sex_diff_Small_male_pop<span class="ot">=</span><span class="fu">mean</span>(Sex_diff_Small_male_pop,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>t_Sex_diff_Small_male_pop_lower<span class="ot">=</span><span class="fu">quantile</span>(Sex_diff_Small_male_pop,.<span class="dv">025</span>,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>t_Sex_diff_Small_male_pop_upper<span class="ot">=</span><span class="fu">quantile</span>(Sex_diff_Small_male_pop,.<span class="dv">975</span>,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a><span class="co">#Permutation test to calculate p value</span></span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>comb_data_RS<span class="ot">=</span><span class="fu">c</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>m_RS),</span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>            DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>f_RS))</span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a>comb_data_BM<span class="ot">=</span><span class="fu">c</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>stder_BM_focal,</span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a>               DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>stder_BM_focal)</span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a>diff.observed_Small_pop <span class="ot">=</span> <span class="fu">cov</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>stder_BM_focal,DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>m_RS),<span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>) <span class="sc">-</span> <span class="fu">cov</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>stder_BM_focal,DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>f_RS),<span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>) </span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a>diff.observed_Small_pop</span></code></pre></div>
<pre><code>[1] -0.2106987</code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>number_of_permutations <span class="ot">=</span> <span class="dv">100000</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>diff.random_Small_pop <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span> <span class="sc">:</span> number_of_permutations) {</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Sample from the combined dataset</span></span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>  a.random <span class="ot">=</span> <span class="fu">sample</span> (<span class="fu">na.omit</span>(comb_data_RS), <span class="fu">length</span>(<span class="fu">c</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>m_RS))), <span class="cn">TRUE</span>)</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>  b.random <span class="ot">=</span> <span class="fu">sample</span> (<span class="fu">na.omit</span>(comb_data_BM), <span class="fu">length</span>(<span class="fu">c</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>m_RS))), <span class="cn">TRUE</span>)</span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>  c.random <span class="ot">=</span> <span class="fu">sample</span> (<span class="fu">na.omit</span>(comb_data_RS), <span class="fu">length</span>(<span class="fu">c</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>f_RS))), <span class="cn">TRUE</span>)</span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>  d.random <span class="ot">=</span> <span class="fu">sample</span> (<span class="fu">na.omit</span>(comb_data_BM), <span class="fu">length</span>(<span class="fu">c</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>f_RS))), <span class="cn">TRUE</span>)</span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Null (permuated) difference</span></span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a>  diff.random_Small_pop[i] <span class="ot">=</span> <span class="fu">cov</span>(b.random,a.random,<span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>) <span class="sc">-</span> <span class="fu">cov</span>(d.random,c.random,<span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb81-14"><a href="#cb81-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-15"><a href="#cb81-15" aria-hidden="true" tabindex="-1"></a><span class="co"># P-value is the fraction of how many times the permuted difference is</span></span>
<span id="cb81-16"><a href="#cb81-16" aria-hidden="true" tabindex="-1"></a><span class="co"># equal or more extreme than the observed difference</span></span>
<span id="cb81-17"><a href="#cb81-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-18"><a href="#cb81-18" aria-hidden="true" tabindex="-1"></a>p_Sex_diff_Small_pop <span class="ot">=</span> <span class="fu">sum</span>((diff.random_Small_pop) <span class="sc">&gt;=</span> <span class="fu">as.numeric</span>((diff.observed_Small_pop)))<span class="sc">/</span>   number_of_permutations</span>
<span id="cb81-19"><a href="#cb81-19" aria-hidden="true" tabindex="-1"></a>p_Sex_diff_Small_pop</span></code></pre></div>
<pre><code>[1] 0.85978</code></pre>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co">#population size ####</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Large</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>Sex_diff_large_male_pop<span class="ot">=</span><span class="fu">c</span>(boot_BW_males_group_size_large<span class="sc">$</span>t)<span class="sc">-</span><span class="fu">c</span>(boot_BW_females_group_size_large<span class="sc">$</span>t)</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>t_Sex_diff_large_male_pop<span class="ot">=</span><span class="fu">mean</span>(Sex_diff_large_male_pop,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>t_Sex_diff_large_male_pop_lower<span class="ot">=</span><span class="fu">quantile</span>(Sex_diff_large_male_pop,.<span class="dv">025</span>,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>t_Sex_diff_large_male_pop_upper<span class="ot">=</span><span class="fu">quantile</span>(Sex_diff_large_male_pop,.<span class="dv">975</span>,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Permutation test to calculate p value</span></span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a>comb_data_RS<span class="ot">=</span><span class="fu">c</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>m_RS),</span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a>               DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_M[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>f_RS))</span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a>comb_data_BM<span class="ot">=</span><span class="fu">c</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>stder_BM_focal,</span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a>               DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>stder_BM_focal)</span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-15"><a href="#cb83-15" aria-hidden="true" tabindex="-1"></a>diff.observed_large_pop <span class="ot">=</span> <span class="fu">cov</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>stder_BM_focal,DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>m_RS),<span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>) <span class="sc">-</span> <span class="fu">cov</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>stder_BM_focal,DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>f_RS),<span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>) </span>
<span id="cb83-16"><a href="#cb83-16" aria-hidden="true" tabindex="-1"></a>diff.observed_large_pop</span></code></pre></div>
<pre><code>[1] -0.2786662</code></pre>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>number_of_permutations <span class="ot">=</span> <span class="dv">100000</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>diff.random_large_pop <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span> <span class="sc">:</span> number_of_permutations) {</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Sample from the combined dataset</span></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>  a.random <span class="ot">=</span> <span class="fu">sample</span> (<span class="fu">na.omit</span>(comb_data_RS), <span class="fu">length</span>(<span class="fu">c</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>m_RS))), <span class="cn">TRUE</span>)</span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>  b.random <span class="ot">=</span> <span class="fu">sample</span> (<span class="fu">na.omit</span>(comb_data_BM), <span class="fu">length</span>(<span class="fu">c</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>m_RS))), <span class="cn">TRUE</span>)</span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>  c.random <span class="ot">=</span> <span class="fu">sample</span> (<span class="fu">na.omit</span>(comb_data_RS), <span class="fu">length</span>(<span class="fu">c</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>f_RS))), <span class="cn">TRUE</span>)</span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>  d.random <span class="ot">=</span> <span class="fu">sample</span> (<span class="fu">na.omit</span>(comb_data_BM), <span class="fu">length</span>(<span class="fu">c</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>f_RS))), <span class="cn">TRUE</span>)</span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Null (permuated) difference</span></span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a>  diff.random_large_pop[i] <span class="ot">=</span> <span class="fu">cov</span>(b.random,a.random,<span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>) <span class="sc">-</span> <span class="fu">cov</span>(d.random,c.random,<span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-15"><a href="#cb85-15" aria-hidden="true" tabindex="-1"></a><span class="co"># P-value is the fraction of how many times the permuted difference is</span></span>
<span id="cb85-16"><a href="#cb85-16" aria-hidden="true" tabindex="-1"></a><span class="co"># equal or more extreme than the observed difference</span></span>
<span id="cb85-17"><a href="#cb85-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-18"><a href="#cb85-18" aria-hidden="true" tabindex="-1"></a>p_Sex_diff_large_pop <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">abs</span>(diff.random_large_pop) <span class="sc">&gt;=</span> <span class="fu">as.numeric</span>(<span class="fu">abs</span>(diff.observed_large_pop)))<span class="sc">/</span>   number_of_permutations</span>
<span id="cb85-19"><a href="#cb85-19" aria-hidden="true" tabindex="-1"></a>p_Sex_diff_large_pop</span></code></pre></div>
<pre><code>[1] 0.13493</code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Area ####</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Large</span></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>Sex_diff_large_area<span class="ot">=</span><span class="fu">c</span>(boot_BW_males_area_large<span class="sc">$</span>t)<span class="sc">-</span><span class="fu">c</span>(boot_BW_females_area_large<span class="sc">$</span>t)</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>t_Sex_diff_large_area<span class="ot">=</span><span class="fu">mean</span>(Sex_diff_large_area,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>t_Sex_diff_large_area_lower<span class="ot">=</span><span class="fu">quantile</span>(Sex_diff_large_area,.<span class="dv">025</span>,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>t_Sex_diff_large_area_upper<span class="ot">=</span><span class="fu">quantile</span>(Sex_diff_large_area,.<span class="dv">975</span>,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Permutation test to calculate p value</span></span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>comb_data_RS<span class="ot">=</span><span class="fu">c</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>m_RS),</span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>               DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>f_RS))</span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a>comb_data_BM<span class="ot">=</span><span class="fu">c</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>stder_BM_focal,</span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a>               DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>stder_BM_focal)</span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a>diff.observed_large_area <span class="ot">=</span> <span class="fu">cov</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>stder_BM_focal,DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>m_RS),<span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>) <span class="sc">-</span> <span class="fu">cov</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>stder_BM_focal,DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>f_RS),<span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>) </span>
<span id="cb87-16"><a href="#cb87-16" aria-hidden="true" tabindex="-1"></a>diff.observed_large_area</span></code></pre></div>
<pre><code>[1] -0.05780497</code></pre>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>number_of_permutations <span class="ot">=</span> <span class="dv">100000</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>diff.random_large_area <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span> <span class="sc">:</span> number_of_permutations) {</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Sample from the combined dataset</span></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>  a.random <span class="ot">=</span> <span class="fu">sample</span> (<span class="fu">na.omit</span>(comb_data_RS), <span class="fu">length</span>(<span class="fu">c</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>m_RS))), <span class="cn">TRUE</span>)</span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>  b.random <span class="ot">=</span> <span class="fu">sample</span> (<span class="fu">na.omit</span>(comb_data_BM), <span class="fu">length</span>(<span class="fu">c</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>m_RS))), <span class="cn">TRUE</span>)</span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>  c.random <span class="ot">=</span> <span class="fu">sample</span> (<span class="fu">na.omit</span>(comb_data_RS), <span class="fu">length</span>(<span class="fu">c</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>f_RS))), <span class="cn">TRUE</span>)</span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>  d.random <span class="ot">=</span> <span class="fu">sample</span> (<span class="fu">na.omit</span>(comb_data_BM), <span class="fu">length</span>(<span class="fu">c</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>f_RS))), <span class="cn">TRUE</span>)</span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Null (permuated) difference</span></span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a>  diff.random_large_area[i] <span class="ot">=</span> <span class="fu">cov</span>(b.random,a.random,<span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>) <span class="sc">-</span> <span class="fu">cov</span>(d.random,c.random,<span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-15"><a href="#cb89-15" aria-hidden="true" tabindex="-1"></a><span class="co"># P-value is the fraction of how many times the permuted difference is</span></span>
<span id="cb89-16"><a href="#cb89-16" aria-hidden="true" tabindex="-1"></a><span class="co"># equal or more extreme than the observed difference</span></span>
<span id="cb89-17"><a href="#cb89-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-18"><a href="#cb89-18" aria-hidden="true" tabindex="-1"></a>p_Sex_diff_large_area <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">abs</span>(diff.random_large_area) <span class="sc">&gt;=</span> <span class="fu">as.numeric</span>(<span class="fu">abs</span>(diff.observed_large_area)))<span class="sc">/</span>   number_of_permutations</span>
<span id="cb89-19"><a href="#cb89-19" aria-hidden="true" tabindex="-1"></a>p_Sex_diff_large_area</span></code></pre></div>
<pre><code>[1] 0.74254</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Small</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>Sex_diff_small_area<span class="ot">=</span><span class="fu">c</span>(boot_BW_males_area_small<span class="sc">$</span>t)<span class="sc">-</span><span class="fu">c</span>(boot_BW_females_area_small<span class="sc">$</span>t)</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>t_Sex_diff_small_area<span class="ot">=</span><span class="fu">mean</span>(Sex_diff_small_area,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>t_Sex_diff_small_area_lower<span class="ot">=</span><span class="fu">quantile</span>(Sex_diff_small_area,.<span class="dv">025</span>,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>t_Sex_diff_small_area_upper<span class="ot">=</span><span class="fu">quantile</span>(Sex_diff_small_area,.<span class="dv">975</span>,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a><span class="co">#Permutation test to calculate p value</span></span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>comb_data_RS<span class="ot">=</span><span class="fu">c</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>m_RS),</span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a>               DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>f_RS))</span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a>comb_data_BM<span class="ot">=</span><span class="fu">c</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>stder_BM_focal,</span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a>               DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>stder_BM_focal)</span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a>diff.observed_small_area <span class="ot">=</span> <span class="fu">cov</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>stder_BM_focal,DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>m_RS),<span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>) <span class="sc">-</span> <span class="fu">cov</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>stder_BM_focal,DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>f_RS),<span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>) </span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a>diff.observed_small_area</span></code></pre></div>
<pre><code>[1] -0.4511778</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>number_of_permutations <span class="ot">=</span> <span class="dv">100000</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>diff.random_small_area <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span> <span class="sc">:</span> number_of_permutations) {</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Sample from the combined dataset</span></span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>  a.random <span class="ot">=</span> <span class="fu">sample</span> (<span class="fu">na.omit</span>(comb_data_RS), <span class="fu">length</span>(<span class="fu">c</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>m_RS))), <span class="cn">TRUE</span>)</span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>  b.random <span class="ot">=</span> <span class="fu">sample</span> (<span class="fu">na.omit</span>(comb_data_BM), <span class="fu">length</span>(<span class="fu">c</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>m_RS))), <span class="cn">TRUE</span>)</span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>  c.random <span class="ot">=</span> <span class="fu">sample</span> (<span class="fu">na.omit</span>(comb_data_RS), <span class="fu">length</span>(<span class="fu">c</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>f_RS))), <span class="cn">TRUE</span>)</span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a>  d.random <span class="ot">=</span> <span class="fu">sample</span> (<span class="fu">na.omit</span>(comb_data_BM), <span class="fu">length</span>(<span class="fu">c</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>f_RS))), <span class="cn">TRUE</span>)</span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Null (permuated) difference</span></span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a>  diff.random_small_area[i] <span class="ot">=</span> <span class="fu">cov</span>(b.random,a.random,<span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>) <span class="sc">-</span> <span class="fu">cov</span>(d.random,c.random,<span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb93-13"><a href="#cb93-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb93-14"><a href="#cb93-14" aria-hidden="true" tabindex="-1"></a><span class="co"># P-value is the fraction of how many times the permuted difference is</span></span>
<span id="cb93-15"><a href="#cb93-15" aria-hidden="true" tabindex="-1"></a><span class="co"># equal or more extreme than the observed difference</span></span>
<span id="cb93-16"><a href="#cb93-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-17"><a href="#cb93-17" aria-hidden="true" tabindex="-1"></a>p_Sex_diff_small_area <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">abs</span>(diff.random_small_area) <span class="sc">&gt;=</span> <span class="fu">as.numeric</span>(<span class="fu">abs</span>(diff.observed_small_area)))<span class="sc">/</span>   number_of_permutations</span>
<span id="cb93-18"><a href="#cb93-18" aria-hidden="true" tabindex="-1"></a>p_Sex_diff_small_area</span></code></pre></div>
<pre><code>[1] 0.03397</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Treatment bias ####</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Group size ####</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Males</span></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>Treat_diff_male_pop<span class="ot">=</span><span class="fu">c</span>(boot_BW_males_group_size_large<span class="sc">$</span>t)<span class="sc">-</span><span class="fu">c</span>(boot_BW_males_group_size_small<span class="sc">$</span>t)</span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>t_Treat_diff_male_pop<span class="ot">=</span><span class="fu">mean</span>(Treat_diff_male_pop,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>t_Treat_diff_male_pop_lower<span class="ot">=</span><span class="fu">quantile</span>(Treat_diff_male_pop,.<span class="dv">025</span>,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>t_Treat_diff_male_pop_upper<span class="ot">=</span><span class="fu">quantile</span>(Treat_diff_male_pop,.<span class="dv">975</span>,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a><span class="co">#Permutation test to calculate p value</span></span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a>comb_data_RS<span class="ot">=</span><span class="fu">c</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>m_RS),</span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a>               DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>m_RS))</span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a>comb_data_BM<span class="ot">=</span><span class="fu">c</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>stder_BM_focal,</span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a>               DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>stder_BM_focal)</span>
<span id="cb95-15"><a href="#cb95-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-16"><a href="#cb95-16" aria-hidden="true" tabindex="-1"></a>diff.observed_male_pop <span class="ot">=</span> <span class="fu">cov</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>stder_BM_focal,DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>m_RS),<span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>) <span class="sc">-</span> <span class="fu">cov</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>stder_BM_focal,DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>m_RS),<span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>) </span>
<span id="cb95-17"><a href="#cb95-17" aria-hidden="true" tabindex="-1"></a>diff.observed_male_pop</span></code></pre></div>
<pre><code>[1] 0.1803</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>number_of_permutations <span class="ot">=</span> <span class="dv">100000</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>diff.random_male_pop <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span> <span class="sc">:</span> number_of_permutations) {</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Sample from the combined dataset</span></span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>  a.random <span class="ot">=</span> <span class="fu">sample</span> (<span class="fu">na.omit</span>(comb_data_RS), <span class="fu">length</span>(<span class="fu">c</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>m_RS))), <span class="cn">TRUE</span>)</span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>  b.random <span class="ot">=</span> <span class="fu">sample</span> (<span class="fu">na.omit</span>(comb_data_BM), <span class="fu">length</span>(<span class="fu">c</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>m_RS))), <span class="cn">TRUE</span>)</span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>  c.random <span class="ot">=</span> <span class="fu">sample</span> (<span class="fu">na.omit</span>(comb_data_RS), <span class="fu">length</span>(<span class="fu">c</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>m_RS))), <span class="cn">TRUE</span>)</span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a>  d.random <span class="ot">=</span> <span class="fu">sample</span> (<span class="fu">na.omit</span>(comb_data_BM), <span class="fu">length</span>(<span class="fu">c</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>m_RS))), <span class="cn">TRUE</span>)</span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Null (permuated) difference</span></span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a>  diff.random_male_pop[i] <span class="ot">=</span> <span class="fu">cov</span>(b.random,a.random,<span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>) <span class="sc">-</span> <span class="fu">cov</span>(d.random,c.random,<span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb97-13"><a href="#cb97-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb97-14"><a href="#cb97-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-15"><a href="#cb97-15" aria-hidden="true" tabindex="-1"></a><span class="co"># P-value is the fraction of how many times the permuted difference is</span></span>
<span id="cb97-16"><a href="#cb97-16" aria-hidden="true" tabindex="-1"></a><span class="co"># equal or more extreme than the observed difference</span></span>
<span id="cb97-17"><a href="#cb97-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-18"><a href="#cb97-18" aria-hidden="true" tabindex="-1"></a>p_Treat_diff_male_pop <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">abs</span>(diff.random_male_pop) <span class="sc">&gt;=</span> <span class="fu">as.numeric</span>(<span class="fu">abs</span>(diff.observed_male_pop)))<span class="sc">/</span>   number_of_permutations</span>
<span id="cb97-19"><a href="#cb97-19" aria-hidden="true" tabindex="-1"></a>p_Treat_diff_male_pop</span></code></pre></div>
<pre><code>[1] 0.34208</code></pre>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Females</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>Treat_diff_female_pop<span class="ot">=</span><span class="fu">c</span>(boot_BW_females_group_size_large<span class="sc">$</span>t)<span class="sc">-</span><span class="fu">c</span>(boot_BW_females_group_size_small<span class="sc">$</span>t)</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>t_Treat_diff_female_pop<span class="ot">=</span><span class="fu">mean</span>(Treat_diff_female_pop,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>t_Treat_diff_female_pop_lower<span class="ot">=</span><span class="fu">quantile</span>(Treat_diff_female_pop,.<span class="dv">025</span>,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>t_Treat_diff_female_pop_upper<span class="ot">=</span><span class="fu">quantile</span>(Treat_diff_female_pop,.<span class="dv">975</span>,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a><span class="co">#Permutation test to calculate p value</span></span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>comb_data_RS<span class="ot">=</span><span class="fu">c</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>f_RS),</span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a>               DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>f_RS))</span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a>comb_data_BM<span class="ot">=</span><span class="fu">c</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>stder_BM_focal,</span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a>               DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>stder_BM_focal)</span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a>diff.observed_female_pop <span class="ot">=</span> <span class="fu">cov</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>stder_BM_focal,DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>f_RS),<span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>) <span class="sc">-</span> <span class="fu">cov</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>stder_BM_focal,DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>f_RS),<span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>) </span>
<span id="cb99-15"><a href="#cb99-15" aria-hidden="true" tabindex="-1"></a>diff.observed_female_pop</span></code></pre></div>
<pre><code>[1] 0.2482675</code></pre>
<div class="sourceCode" id="cb101"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>number_of_permutations <span class="ot">=</span> <span class="dv">100000</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>diff.random_female_pop <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span> <span class="sc">:</span> number_of_permutations) {</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Sample from the combined dataset</span></span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>  a.random <span class="ot">=</span> <span class="fu">sample</span> (<span class="fu">na.omit</span>(comb_data_RS), <span class="fu">length</span>(<span class="fu">c</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>f_RS))), <span class="cn">TRUE</span>)</span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>  b.random <span class="ot">=</span> <span class="fu">sample</span> (<span class="fu">na.omit</span>(comb_data_BM), <span class="fu">length</span>(<span class="fu">c</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>f_RS))), <span class="cn">TRUE</span>)</span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a>  c.random <span class="ot">=</span> <span class="fu">sample</span> (<span class="fu">na.omit</span>(comb_data_RS), <span class="fu">length</span>(<span class="fu">c</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>f_RS))), <span class="cn">TRUE</span>)</span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a>  d.random <span class="ot">=</span> <span class="fu">sample</span> (<span class="fu">na.omit</span>(comb_data_BM), <span class="fu">length</span>(<span class="fu">c</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>f_RS))), <span class="cn">TRUE</span>)</span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Null (permuated) difference</span></span>
<span id="cb101-12"><a href="#cb101-12" aria-hidden="true" tabindex="-1"></a>  diff.random_female_pop[i] <span class="ot">=</span> <span class="fu">cov</span>(b.random,a.random,<span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>) <span class="sc">-</span> <span class="fu">cov</span>(d.random,c.random,<span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb101-13"><a href="#cb101-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb101-14"><a href="#cb101-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-15"><a href="#cb101-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-16"><a href="#cb101-16" aria-hidden="true" tabindex="-1"></a><span class="co"># P-value is the fraction of how many times the permuted difference is</span></span>
<span id="cb101-17"><a href="#cb101-17" aria-hidden="true" tabindex="-1"></a><span class="co"># equal or more extreme than the observed difference</span></span>
<span id="cb101-18"><a href="#cb101-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-19"><a href="#cb101-19" aria-hidden="true" tabindex="-1"></a>p_Treat_diff_female_pop <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">abs</span>(diff.random_female_pop) <span class="sc">&gt;=</span> <span class="fu">as.numeric</span>(<span class="fu">abs</span>(diff.observed_female_pop)))<span class="sc">/</span>   number_of_permutations</span>
<span id="cb101-20"><a href="#cb101-20" aria-hidden="true" tabindex="-1"></a>p_Treat_diff_female_pop</span></code></pre></div>
<pre><code>[1] 0.20807</code></pre>
<div class="sourceCode" id="cb103"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Area ####</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Males</span></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>Treat_diff_male_area<span class="ot">=</span><span class="fu">c</span>(boot_BW_males_area_large<span class="sc">$</span>t)<span class="sc">-</span><span class="fu">c</span>(boot_BW_males_area_small<span class="sc">$</span>t)</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>t_Treat_diff_male_area<span class="ot">=</span><span class="fu">mean</span>(Treat_diff_male_area,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>t_Treat_diff_male_area_lower<span class="ot">=</span><span class="fu">quantile</span>(Treat_diff_male_area,.<span class="dv">025</span>,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a>t_Treat_diff_male_area_upper<span class="ot">=</span><span class="fu">quantile</span>(Treat_diff_male_area,.<span class="dv">975</span>,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Permutation test to calculate p value</span></span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a>comb_data_RS<span class="ot">=</span><span class="fu">c</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>m_RS),</span>
<span id="cb103-11"><a href="#cb103-11" aria-hidden="true" tabindex="-1"></a>               DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>m_RS))</span>
<span id="cb103-12"><a href="#cb103-12" aria-hidden="true" tabindex="-1"></a>comb_data_BM<span class="ot">=</span><span class="fu">c</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>stder_BM_focal,</span>
<span id="cb103-13"><a href="#cb103-13" aria-hidden="true" tabindex="-1"></a>               DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>stder_BM_focal)</span>
<span id="cb103-14"><a href="#cb103-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-15"><a href="#cb103-15" aria-hidden="true" tabindex="-1"></a>diff.observed_male_area <span class="ot">=</span> <span class="fu">cov</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>stder_BM_focal,DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>m_RS),<span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>) <span class="sc">-</span> <span class="fu">cov</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>stder_BM_focal,DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>m_RS),<span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>) </span>
<span id="cb103-16"><a href="#cb103-16" aria-hidden="true" tabindex="-1"></a>diff.observed_male_area</span></code></pre></div>
<pre><code>[1] -0.1190065</code></pre>
<div class="sourceCode" id="cb105"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>number_of_permutations <span class="ot">=</span> <span class="dv">100000</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>diff.random_male_area <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span> <span class="sc">:</span> number_of_permutations) {</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Sample from the combined dataset</span></span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>  a.random <span class="ot">=</span> <span class="fu">sample</span> (<span class="fu">na.omit</span>(comb_data_RS), <span class="fu">length</span>(<span class="fu">c</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>m_RS))), <span class="cn">TRUE</span>)</span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>  b.random <span class="ot">=</span> <span class="fu">sample</span> (<span class="fu">na.omit</span>(comb_data_BM), <span class="fu">length</span>(<span class="fu">c</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>m_RS))), <span class="cn">TRUE</span>)</span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a>  c.random <span class="ot">=</span> <span class="fu">sample</span> (<span class="fu">na.omit</span>(comb_data_RS), <span class="fu">length</span>(<span class="fu">c</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>m_RS))), <span class="cn">TRUE</span>)</span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a>  d.random <span class="ot">=</span> <span class="fu">sample</span> (<span class="fu">na.omit</span>(comb_data_BM), <span class="fu">length</span>(<span class="fu">c</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>m_RS))), <span class="cn">TRUE</span>)</span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Null (permuated) difference</span></span>
<span id="cb105-12"><a href="#cb105-12" aria-hidden="true" tabindex="-1"></a>  diff.random_male_area[i] <span class="ot">=</span> <span class="fu">cov</span>(b.random,a.random,<span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>) <span class="sc">-</span> <span class="fu">cov</span>(d.random,c.random,<span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb105-13"><a href="#cb105-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb105-14"><a href="#cb105-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-15"><a href="#cb105-15" aria-hidden="true" tabindex="-1"></a><span class="co"># P-value is the fraction of how many times the permuted difference is</span></span>
<span id="cb105-16"><a href="#cb105-16" aria-hidden="true" tabindex="-1"></a><span class="co"># equal or more extreme than the observed difference</span></span>
<span id="cb105-17"><a href="#cb105-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-18"><a href="#cb105-18" aria-hidden="true" tabindex="-1"></a>p_Treat_diff_male_area <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">abs</span>(diff.random_male_area) <span class="sc">&gt;=</span> <span class="fu">as.numeric</span>(<span class="fu">abs</span>(diff.observed_male_area)))<span class="sc">/</span>   number_of_permutations</span>
<span id="cb105-19"><a href="#cb105-19" aria-hidden="true" tabindex="-1"></a>p_Treat_diff_male_area</span></code></pre></div>
<pre><code>[1] 0.52933</code></pre>
<div class="sourceCode" id="cb107"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Females</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>Treat_diff_female_area<span class="ot">=</span><span class="fu">c</span>(boot_BW_females_area_large<span class="sc">$</span>t)<span class="sc">-</span><span class="fu">c</span>(boot_BW_females_area_small<span class="sc">$</span>t)</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>t_Treat_diff_female_area<span class="ot">=</span><span class="fu">mean</span>(Treat_diff_female_area,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>t_Treat_diff_female_area_lower<span class="ot">=</span><span class="fu">quantile</span>(Treat_diff_female_area,.<span class="dv">025</span>,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>t_Treat_diff_female_area_upper<span class="ot">=</span><span class="fu">quantile</span>(Treat_diff_female_area,.<span class="dv">975</span>,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a><span class="co">#Permutation test to calculate p value</span></span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a>comb_data_RS<span class="ot">=</span><span class="fu">c</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>f_RS),</span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a>               DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>f_RS))</span>
<span id="cb107-11"><a href="#cb107-11" aria-hidden="true" tabindex="-1"></a>comb_data_BM<span class="ot">=</span><span class="fu">c</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>stder_BM_focal,</span>
<span id="cb107-12"><a href="#cb107-12" aria-hidden="true" tabindex="-1"></a>               DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>stder_BM_focal)</span>
<span id="cb107-13"><a href="#cb107-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-14"><a href="#cb107-14" aria-hidden="true" tabindex="-1"></a>diff.observed_female_area <span class="ot">=</span> <span class="fu">cov</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>stder_BM_focal,DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>f_RS),<span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>) <span class="sc">-</span> <span class="fu">cov</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>stder_BM_focal,DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>f_RS),<span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>) </span>
<span id="cb107-15"><a href="#cb107-15" aria-hidden="true" tabindex="-1"></a>diff.observed_female_area</span></code></pre></div>
<pre><code>[1] 0.2743663</code></pre>
<div class="sourceCode" id="cb109"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>number_of_permutations <span class="ot">=</span> <span class="dv">100000</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>diff.random_female_area <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span> <span class="sc">:</span> number_of_permutations) {</span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Sample from the combined dataset</span></span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a>  a.random <span class="ot">=</span> <span class="fu">sample</span> (<span class="fu">na.omit</span>(comb_data_RS), <span class="fu">length</span>(<span class="fu">c</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>f_RS))), <span class="cn">TRUE</span>)</span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a>  b.random <span class="ot">=</span> <span class="fu">sample</span> (<span class="fu">na.omit</span>(comb_data_BM), <span class="fu">length</span>(<span class="fu">c</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>f_RS))), <span class="cn">TRUE</span>)</span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a>  c.random <span class="ot">=</span> <span class="fu">sample</span> (<span class="fu">na.omit</span>(comb_data_RS), <span class="fu">length</span>(<span class="fu">c</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>f_RS))), <span class="cn">TRUE</span>)</span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a>  d.random <span class="ot">=</span> <span class="fu">sample</span> (<span class="fu">na.omit</span>(comb_data_BM), <span class="fu">length</span>(<span class="fu">c</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>f_RS))), <span class="cn">TRUE</span>)</span>
<span id="cb109-10"><a href="#cb109-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb109-11"><a href="#cb109-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Null (permuated) difference</span></span>
<span id="cb109-12"><a href="#cb109-12" aria-hidden="true" tabindex="-1"></a>  diff.random_female_area[i] <span class="ot">=</span> <span class="fu">cov</span>(b.random,a.random,<span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>) <span class="sc">-</span> <span class="fu">cov</span>(d.random,c.random,<span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb109-13"><a href="#cb109-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb109-14"><a href="#cb109-14" aria-hidden="true" tabindex="-1"></a><span class="co"># P-value is the fraction of how many times the permuted difference is</span></span>
<span id="cb109-15"><a href="#cb109-15" aria-hidden="true" tabindex="-1"></a><span class="co"># equal or more extreme than the observed difference</span></span>
<span id="cb109-16"><a href="#cb109-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-17"><a href="#cb109-17" aria-hidden="true" tabindex="-1"></a>p_Treat_diff_female_area <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">abs</span>(diff.random_female_area) <span class="sc">&gt;=</span> <span class="fu">as.numeric</span>(<span class="fu">abs</span>(diff.observed_female_area)))<span class="sc">/</span>   number_of_permutations</span>
<span id="cb109-18"><a href="#cb109-18" aria-hidden="true" tabindex="-1"></a>p_Treat_diff_female_area</span></code></pre></div>
<pre><code>[1] 0.16343</code></pre>
<br>
<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-sessioninfo" data-toggle="collapse" data-target="#workflowr-sessioninfo" style="display: block;">
<span class="glyphicon glyphicon-wrench" aria-hidden="true"></span>
Session information
</button>
</p>
<div id="workflowr-sessioninfo" class="collapse">
<div class="sourceCode" id="cb111"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code></pre></div>
<pre><code>R version 4.0.2 (2020-06-22)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 10 x64 (build 19042)

Matrix products: default

locale:
[1] LC_COLLATE=German_Germany.1252  LC_CTYPE=German_Germany.1252   
[3] LC_MONETARY=German_Germany.1252 LC_NUMERIC=C                   
[5] LC_TIME=German_Germany.1252    

attached base packages:
[1] grid      stats     graphics  grDevices utils     datasets  methods  
[8] base     

other attached packages:
 [1] ICC_2.4.0          tidyr_1.2.0        data.table_1.14.2  boot_1.3-25       
 [5] RColorBrewer_1.1-3 car_3.1-0          carData_3.0-5      gridGraphics_0.5-1
 [9] cowplot_1.1.1      EnvStats_2.7.0     dplyr_1.0.9        readr_2.1.2       
[13] lmerTest_3.1-3     lme4_1.1-30        Matrix_1.2-18      gridExtra_2.3     
[17] ggplot2_3.3.6      ggeffects_1.1.2    workflowr_1.7.0   

loaded via a namespace (and not attached):
 [1] httr_1.4.3          sass_0.4.1          bit64_4.0.5        
 [4] vroom_1.5.7         jsonlite_1.8.0      splines_4.0.2      
 [7] bslib_0.3.1         assertthat_0.2.1    getPass_0.2-2      
[10] highr_0.9           yaml_2.3.5          numDeriv_2016.8-1.1
[13] pillar_1.7.0        lattice_0.20-41     glue_1.6.2         
[16] digest_0.6.29       promises_1.2.0.1    minqa_1.2.4        
[19] colorspace_2.0-3    htmltools_0.5.2     httpuv_1.6.5       
[22] pkgconfig_2.0.3     purrr_0.3.4         scales_1.2.0       
[25] processx_3.7.0      whisker_0.4         later_1.3.0        
[28] tzdb_0.3.0          git2r_0.30.1        tibble_3.1.7       
[31] mgcv_1.8-31         farver_2.1.1        generics_0.1.3     
[34] ellipsis_0.3.2      withr_2.5.0         cli_3.3.0          
[37] magrittr_2.0.3      crayon_1.5.1        evaluate_0.15      
[40] ps_1.7.1            fs_1.5.2            fansi_1.0.3        
[43] nlme_3.1-148        MASS_7.3-51.6       tools_4.0.2        
[46] hms_1.1.1           lifecycle_1.0.1     stringr_1.4.0      
[49] munsell_0.5.0       callr_3.7.1         compiler_4.0.2     
[52] jquerylib_0.1.4     rlang_1.0.4         nloptr_2.0.3       
[55] rstudioapi_0.13     labeling_0.4.2      rmarkdown_2.14     
[58] gtable_0.3.0        abind_1.4-5         DBI_1.1.3          
[61] R6_2.5.1            knitr_1.39          bit_4.0.4          
[64] fastmap_1.1.0       utf8_1.2.2          rprojroot_2.0.3    
[67] stringi_1.7.6       parallel_4.0.2      Rcpp_1.0.9         
[70] vctrs_0.4.1         tidyselect_1.1.2    xfun_0.31          </code></pre>
</div>
</div>


<!-- Adjust MathJax settings so that all math formulae are shown using
TeX fonts only; see
https://docs.mathjax.org/en/latest/web/configuration.html. This will make
the presentation more consistent at the cost of the webpage sometimes
taking slightly longer to load. Note that this only works because the
footer is added to webpages before the MathJax javascript. -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>




</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
