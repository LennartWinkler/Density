<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Lennart Winkler1, Ronja Eilhardt1 &amp; Tim Janicke1,2   1Applied Zoology, Technical University Dresden   2Centre d’Écologie Fonctionnelle et Évolutive, UMR 5175, CNRS, Université de Montpellier" />


<title>Population density affects sexual selection in the red flour beetle</title>

<script src="site_libs/header-attrs-2.14/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/yeti.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>

<link rel="icon" href="https://github.com/workflowr/workflowr-assets/raw/main/img/reproducible.png">
<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>



<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>







<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Population density affects sexual selection in the red flour beetle</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="a_start.html">Home</a>
</li>
<li>
  <a href="index.html">Analyses 1</a>
</li>
<li>
  <a href="index2.html">Analyses 2</a>
</li>
<li>
  <a href="index3.html">Analyses 3</a>
</li>
<li>
  <a href="index4.html">Analyses 4</a>
</li>
<li>
  <a href="index5.html">Analyses 5</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Population density affects sexual selection
in the red flour beetle</h1>
<h3 class="subtitle">Analyses on body mass of focal individuals
excluding individuals without mating success</h3>
<h4 class="author">Lennart Winkler<sup>1</sup>, Ronja
Eilhardt<sup>1</sup> &amp; Tim Janicke<sup>1,2</sup> <br></br>
<sup>1</sup>Applied Zoology, Technical University Dresden <br>
<sup>2</sup>Centre d’Écologie Fonctionnelle et Évolutive, UMR 5175,
CNRS, Université de Montpellier</br></h4>

</div>


<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-report" data-toggle="collapse" data-target="#workflowr-report">
<span class="glyphicon glyphicon-list" aria-hidden="true"></span>
workflowr <span class="glyphicon glyphicon-exclamation-sign text-danger"
aria-hidden="true"></span>
</button>
</p>
<div id="workflowr-report" class="collapse">
<ul class="nav nav-tabs">
<li class="active">
<a data-toggle="tab" href="#summary">Summary</a>
</li>
<li>
<a data-toggle="tab" href="#checks"> Checks <span
class="glyphicon glyphicon-exclamation-sign text-danger"
aria-hidden="true"></span> </a>
</li>
<li>
<a data-toggle="tab" href="#versions">Past versions</a>
</li>
</ul>
<div class="tab-content">
<div id="summary" class="tab-pane fade in active">
<p>
<strong>Last updated:</strong> 2022-08-12
</p>
<p>
<strong>Checks:</strong> <span
class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> 6
<span class="glyphicon glyphicon-exclamation-sign text-danger"
aria-hidden="true"></span> 1
</p>
<p>
<strong>Knit directory:</strong>
<code>Density_and_sexual_selection_2022/</code> <span
class="glyphicon glyphicon-question-sign" aria-hidden="true"
title="This is the local directory in which the code in this file was executed.">
</span>
</p>
<p>
This reproducible <a href="https://rmarkdown.rstudio.com">R Markdown</a>
analysis was created with <a
  href="https://github.com/workflowr/workflowr">workflowr</a> (version
1.7.0). The <em>Checks</em> tab describes the reproducibility checks
that were applied when the results were created. The <em>Past
versions</em> tab lists the development history.
</p>
<hr>
</div>
<div id="checks" class="tab-pane fade">
<div id="workflowr-checks" class="panel-group">
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRMarkdownfilestronguncommittedchanges">
<span class="glyphicon glyphicon-exclamation-sign text-danger"
aria-hidden="true"></span> <strong>R Markdown file:</strong> uncommitted
changes </a>
</p>
</div>
<div id="strongRMarkdownfilestronguncommittedchanges"
class="panel-collapse collapse">
<div class="panel-body">
<p>The R Markdown file has unstaged changes. To know which version of
the R Markdown file created these results, you’ll want to first commit
it to the Git repo. If you’re still working on the analysis, you can
ignore this warning. When you’re finished, you can run
<code>wflow_publish</code> to commit the R Markdown file and build the
HTML.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongEnvironmentstrongempty">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Environment:</strong> empty </a>
</p>
</div>
<div id="strongEnvironmentstrongempty" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! The global environment was empty. Objects defined in the
global environment can affect the analysis in your R Markdown file in
unknown ways. For reproduciblity it’s best to always run the code in an
empty environment.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSeedstrongcodesetseed20210613code">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Seed:</strong>
<code>set.seed(20210613)</code> </a>
</p>
</div>
<div id="strongSeedstrongcodesetseed20210613code"
class="panel-collapse collapse">
<div class="panel-body">
<p>The command <code>set.seed(20210613)</code> was run prior to running
the code in the R Markdown file. Setting a seed ensures that any results
that rely on randomness, e.g. subsampling or permutations, are
reproducible.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSessioninformationstrongrecorded">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Session information:</strong>
recorded </a>
</p>
</div>
<div id="strongSessioninformationstrongrecorded"
class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Recording the operating system, R version, and package
versions is critical for reproducibility.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongCachestrongnone">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Cache:</strong> none </a>
</p>
</div>
<div id="strongCachestrongnone" class="panel-collapse collapse">
<div class="panel-body">
<p>Nice! There were no cached chunks for this analysis, so you can be
confident that you successfully produced the results during this
run.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongFilepathsstrongrelative">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>File paths:</strong> relative </a>
</p>
</div>
<div id="strongFilepathsstrongrelative" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Using relative paths to the files within your workflowr
project makes it easier to run your code on other machines.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRepositoryversionstrongahrefhttpsgithubcomLennartWinklerDensityandsexualselection2022treef89f7c166b10dab54e9f687a799bfc4a40170000targetblankf89f7c1a">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Repository version:</strong>
<a href="https://github.com/LennartWinkler/Density_and_sexual_selection_2022/tree/f89f7c166b10dab54e9f687a799bfc4a40170000" target="_blank">f89f7c1</a>
</a>
</p>
</div>
<div
id="strongRepositoryversionstrongahrefhttpsgithubcomLennartWinklerDensityandsexualselection2022treef89f7c166b10dab54e9f687a799bfc4a40170000targetblankf89f7c1a"
class="panel-collapse collapse">
<div class="panel-body">
<p>
Great! You are using Git for version control. Tracking code development
and connecting the code version to the results is critical for
reproducibility.
</p>
<p>
The results in this page were generated with repository version
<a href="https://github.com/LennartWinkler/Density_and_sexual_selection_2022/tree/f89f7c166b10dab54e9f687a799bfc4a40170000" target="_blank">f89f7c1</a>.
See the <em>Past versions</em> tab to see a history of the changes made
to the R Markdown and HTML files.
</p>
<p>
Note that you need to be careful to ensure that all relevant files for
the analysis have been committed to Git prior to generating the results
(you can use <code>wflow_publish</code> or
<code>wflow_git_commit</code>). workflowr only checks the R Markdown
file, but you know if there are other scripts or data files that it
depends on. Below is the status of the Git repository when the results
were generated:
</p>
<pre><code>
Ignored files:
    Ignored:    .Rhistory
    Ignored:    .Rproj.user/

Untracked files:
    Untracked:  analysis/a_start.Rmd
    Untracked:  analysis/index6.Rmd

Unstaged changes:
    Modified:   analysis/_site.yml
    Modified:   analysis/index.Rmd
    Modified:   analysis/index2.Rmd
    Modified:   analysis/index3.Rmd
    Modified:   analysis/index4.Rmd
    Modified:   analysis/index5.Rmd
    Deleted:    analysis/start.Rmd

</code></pre>
<p>
Note that any generated files, e.g. HTML, png, CSS, etc., are not
included in this status report because it is ok for generated content to
have uncommitted changes.
</p>
</div>
</div>
</div>
</div>
<hr>
</div>
<div id="versions" class="tab-pane fade">

<p>
These are the previous versions of the repository in which changes were
made to the R Markdown (<code>analysis/index4.Rmd</code>) and HTML
(<code>docs/index4.html</code>) files. If you’ve configured a remote Git
repository (see <code>?wflow_git_remote</code>), click on the hyperlinks
in the table below to view the files as they were in that past version.
</p>
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
File
</th>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
<th>
Message
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/LennartWinkler/Density_and_sexual_selection_2022/blob/f89f7c166b10dab54e9f687a799bfc4a40170000/analysis/index4.Rmd" target="_blank">f89f7c1</a>
</td>
<td>
LennartWinkler
</td>
<td>
2022-08-10
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/LennartWinkler/Density_and_sexual_selection_2022/f89f7c166b10dab54e9f687a799bfc4a40170000/docs/index4.html" target="_blank">f89f7c1</a>
</td>
<td>
LennartWinkler
</td>
<td>
2022-08-10
</td>
<td>
Build site.
</td>
</tr>
</tbody>
</table>
</div>
<hr>
</div>
</div>
</div>
<p>Supplementary material reporting R code for the manuscript
‘Population density affects sexual selection in the red flour
beetle’.</p>
<div id="load-and-prepare-data" class="section level1">
<h1>Load and prepare data</h1>
<p>Before we started the analyses, we loaded all necessary packages and
data.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#load packages</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggeffects)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(EnvStats)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridGraphics)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(base)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ICC)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="co">#load data</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>DB_data<span class="ot">=</span><span class="fu">read_delim</span>(<span class="st">&quot;./data/DB_AllData_V04.CSV&quot;</span>,<span class="st">&quot;;&quot;</span>, <span class="at">escape_double =</span> <span class="cn">FALSE</span>, <span class="at">trim_ws =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="co">#Set factors and level factors</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>Week<span class="ot">=</span><span class="fu">as.factor</span>(DB_data<span class="sc">$</span>Week)</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>Date<span class="ot">=</span><span class="fu">as.factor</span>(DB_data<span class="sc">$</span>Date)</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>Sex<span class="ot">=</span><span class="fu">as.factor</span>(DB_data<span class="sc">$</span>Sex)</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>Gr_size<span class="ot">=</span><span class="fu">as.factor</span>(DB_data<span class="sc">$</span>Gr_size)</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>Gr_size <span class="ot">&lt;-</span> <span class="fu">factor</span>(DB_data<span class="sc">$</span>Gr_size, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;SG&quot;</span>,<span class="st">&quot;LG&quot;</span>))</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>Area<span class="ot">=</span><span class="fu">as.factor</span>(DB_data<span class="sc">$</span>Area)</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a><span class="co">#Load Body mass data</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>DB_BM_female <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="st">&quot;./data/DB_mass_focals_female.CSV&quot;</span>, </span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;;&quot;</span>, <span class="at">escape_double =</span> <span class="cn">FALSE</span>, <span class="at">trim_ws =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>DB_BM_male <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="st">&quot;./data/DB_mass_focals_males.CSV&quot;</span>, </span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;;&quot;</span>, <span class="at">escape_double =</span> <span class="cn">FALSE</span>, <span class="at">trim_ws =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>DB_data_m<span class="ot">=</span><span class="fu">merge</span>(DB_data,DB_BM_male,<span class="at">by.x =</span> <span class="st">&#39;Well_ID&#39;</span>,<span class="at">by.y =</span> <span class="st">&#39;ID_male_focals&#39;</span>)</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>DB_data_f<span class="ot">=</span><span class="fu">merge</span>(DB_data,DB_BM_female,<span class="at">by.x =</span> <span class="st">&#39;F1_ID&#39;</span>,<span class="at">by.y =</span> <span class="st">&#39;ID_female_focals&#39;</span>)</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>DB_data<span class="ot">=</span><span class="fu">rbind</span>(DB_data_m,DB_data_f)</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a><span class="do">###Exclude incomplete data</span></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>DB_data<span class="ot">=</span>DB_data[DB_data<span class="sc">$</span>excluded<span class="sc">!=</span><span class="dv">1</span>,]</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a><span class="co">#Exclude zero MS (all data)####</span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>DB_data<span class="ot">=</span>DB_data[DB_data<span class="sc">$</span>MatingPartners_number<span class="sc">!=</span><span class="dv">0</span>,]</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculate total offspring number ####</span></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>Total_N_MTP1<span class="ot">=</span><span class="fu">colSums</span>(<span class="fu">rbind</span>(DB_data<span class="sc">$</span>N_MTP1_1,DB_data<span class="sc">$</span>N_MTP1_2,DB_data<span class="sc">$</span>N_MTP1_3,DB_data<span class="sc">$</span>N_MTP1_4,DB_data<span class="sc">$</span>N_MTP1_5,DB_data<span class="sc">$</span>N_MTP1_6), <span class="at">na.rm =</span> T)</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>Total_N_Rd<span class="ot">=</span><span class="fu">colSums</span>(<span class="fu">rbind</span>(DB_data<span class="sc">$</span>N_RD_1,DB_data<span class="sc">$</span>N_RD_2,DB_data<span class="sc">$</span>N_RD_3,DB_data<span class="sc">$</span>N_RD_4,DB_data<span class="sc">$</span>N_RD_5,DB_data<span class="sc">$</span>N_RD_6), <span class="at">na.rm =</span> T)<span class="sc">/</span>DB_data<span class="sc">$</span>N_comp</span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculate proportional RS ####</span></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a><span class="co">#Percentage focal offspring</span></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>m_prop_RS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>m_prop_RS<span class="ot">=</span>(DB_data<span class="sc">$</span>Total_N_MTP1<span class="sc">/</span>(DB_data<span class="sc">$</span>Total_N_MTP1<span class="sc">+</span>DB_data<span class="sc">$</span>Total_N_Rd))<span class="sc">*</span><span class="dv">100</span></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>m_prop_RS[DB_data<span class="sc">$</span>Sex<span class="sc">==</span><span class="st">&#39;F&#39;</span>]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>f_prop_RS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>f_prop_RS<span class="ot">=</span>(DB_data<span class="sc">$</span>Total_N_MTP1<span class="sc">/</span>(DB_data<span class="sc">$</span>Total_N_MTP1<span class="sc">+</span>DB_data<span class="sc">$</span>Total_N_Rd))<span class="sc">*</span><span class="dv">100</span></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>f_prop_RS[DB_data<span class="sc">$</span>Sex<span class="sc">==</span><span class="st">&#39;M&#39;</span>]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculate proportion of successful matings ####</span></span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>Prop_MS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>Prop_MS<span class="ot">=</span>DB_data<span class="sc">$</span>Matings_number<span class="sc">/</span>(DB_data<span class="sc">$</span>Attempts_number<span class="sc">+</span>DB_data<span class="sc">$</span>Matings_number)</span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>Prop_MS[DB_data<span class="sc">$</span>Prop_MS<span class="sc">==</span><span class="dv">0</span>]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculate total encounters ####</span></span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>Total_Encounters<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>Total_Encounters<span class="ot">=</span>DB_data<span class="sc">$</span>Attempts_number<span class="sc">+</span>DB_data<span class="sc">$</span>Matings_number</span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a><span class="co"># Treatment identifier for each density ####</span></span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>Treatment<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(n <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data<span class="sc">$</span>Sex)){<span class="cf">if</span>(DB_data<span class="sc">$</span>Gr_size[n]<span class="sc">==</span><span class="st">&#39;SG&#39;</span> <span class="sc">&amp;&amp;</span> DB_data<span class="sc">$</span>Area[n]<span class="sc">==</span><span class="st">&#39;Large&#39;</span>){DB_data<span class="sc">$</span>Treatment[n]<span class="ot">=</span><span class="st">&#39;D = 0.26&#39;</span></span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>}<span class="cf">else</span> <span class="cf">if</span>(DB_data<span class="sc">$</span>Gr_size[n]<span class="sc">==</span><span class="st">&#39;LG&#39;</span> <span class="sc">&amp;&amp;</span> DB_data<span class="sc">$</span>Area[n]<span class="sc">==</span><span class="st">&#39;Large&#39;</span>){DB_data<span class="sc">$</span>Treatment[n]<span class="ot">=</span><span class="st">&#39;D = 0.52&#39;</span></span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>}<span class="cf">else</span> <span class="cf">if</span>(DB_data<span class="sc">$</span>Gr_size[n]<span class="sc">==</span><span class="st">&#39;SG&#39;</span> <span class="sc">&amp;&amp;</span> DB_data<span class="sc">$</span>Area[n]<span class="sc">==</span><span class="st">&#39;Small&#39;</span>){DB_data<span class="sc">$</span>Treatment[n]<span class="ot">=</span><span class="st">&#39;D = 0.67&#39;</span></span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>}<span class="cf">else</span> <span class="cf">if</span>(DB_data<span class="sc">$</span>Gr_size[n]<span class="sc">==</span><span class="st">&#39;LG&#39;</span> <span class="sc">&amp;&amp;</span> DB_data<span class="sc">$</span>Area[n]<span class="sc">==</span><span class="st">&#39;Small&#39;</span>){DB_data<span class="sc">$</span>Treatment[n]<span class="ot">=</span><span class="st">&#39;D = 1.33&#39;</span></span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>}<span class="cf">else</span>{DB_data<span class="sc">$</span>Treatment[n]<span class="ot">=</span><span class="cn">NA</span>}}</span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>Treatment<span class="ot">=</span><span class="fu">as.factor</span>(DB_data<span class="sc">$</span>Treatment)</span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a><span class="co"># Exclude Incubator 3 data #### -&gt; poor performance </span></span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>DB_data_clean<span class="ot">=</span>DB_data[DB_data<span class="sc">$</span>Incu3<span class="sc">!=</span><span class="dv">1</span>,]</span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate genetic MS ####</span></span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a><span class="co"># Only clean data</span></span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>DB_data_clean<span class="sc">$</span>gMS<span class="ot">=</span><span class="cn">NA</span> </span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data_clean<span class="sc">$</span>Sex)) {<span class="cf">if</span> (DB_data_clean<span class="sc">$</span>N_MTP1_1[i]<span class="sc">&gt;=</span><span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>N_MTP1_1[i])){</span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a>  DB_data_clean<span class="sc">$</span>gMS[i]<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>}<span class="cf">else</span>{DB_data_clean<span class="sc">$</span>gMS[i]<span class="ot">=</span><span class="dv">0</span>}}</span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data_clean<span class="sc">$</span>Sex)) {<span class="cf">if</span> (DB_data_clean<span class="sc">$</span>N_MTP1_2[i]<span class="sc">&gt;=</span><span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>N_MTP1_2[i])){</span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a>  DB_data_clean<span class="sc">$</span>gMS[i]<span class="ot">=</span>DB_data_clean<span class="sc">$</span>gMS[i]<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a>}<span class="cf">else</span>{}}</span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data_clean<span class="sc">$</span>Sex)) {<span class="cf">if</span> (DB_data_clean<span class="sc">$</span>N_MTP1_3[i]<span class="sc">&gt;=</span><span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>N_MTP1_3[i])){</span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a>  DB_data_clean<span class="sc">$</span>gMS[i]<span class="ot">=</span>DB_data_clean<span class="sc">$</span>gMS[i]<span class="sc">+</span><span class="dv">1</span>}<span class="cf">else</span>{}}</span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data_clean<span class="sc">$</span>Sex)) {<span class="cf">if</span> (DB_data_clean<span class="sc">$</span>N_MTP1_4[i]<span class="sc">&gt;=</span><span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>N_MTP1_4[i])){</span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a>  DB_data_clean<span class="sc">$</span>gMS[i]<span class="ot">=</span>DB_data_clean<span class="sc">$</span>gMS[i]<span class="sc">+</span><span class="dv">1</span>}<span class="cf">else</span>{}}</span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data_clean<span class="sc">$</span>Sex)) {<span class="cf">if</span> (DB_data_clean<span class="sc">$</span>N_MTP1_5[i]<span class="sc">&gt;=</span><span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>N_MTP1_5[i])){</span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a>  DB_data_clean<span class="sc">$</span>gMS[i]<span class="ot">=</span>DB_data_clean<span class="sc">$</span>gMS[i]<span class="sc">+</span><span class="dv">1</span>}<span class="cf">else</span>{}}</span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data_clean<span class="sc">$</span>Sex)) {<span class="cf">if</span> (DB_data_clean<span class="sc">$</span>N_MTP1_6[i]<span class="sc">&gt;=</span><span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>N_MTP1_6[i])){</span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a>  DB_data_clean<span class="sc">$</span>gMS[i]<span class="ot">=</span>DB_data_clean<span class="sc">$</span>gMS[i]<span class="sc">+</span><span class="dv">1</span>}<span class="cf">else</span>{}}</span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a><span class="co"># All data</span></span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>gMS<span class="ot">=</span><span class="cn">NA</span> </span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data<span class="sc">$</span>Sex)) {<span class="cf">if</span> (DB_data<span class="sc">$</span>N_MTP1_1[i]<span class="sc">&gt;=</span><span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data<span class="sc">$</span>N_MTP1_1[i])){</span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a>  DB_data<span class="sc">$</span>gMS[i]<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a>}<span class="cf">else</span>{DB_data<span class="sc">$</span>gMS[i]<span class="ot">=</span><span class="dv">0</span>}}</span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data<span class="sc">$</span>Sex)) {<span class="cf">if</span> (DB_data<span class="sc">$</span>N_MTP1_2[i]<span class="sc">&gt;=</span><span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data<span class="sc">$</span>N_MTP1_2[i])){</span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a>  DB_data<span class="sc">$</span>gMS[i]<span class="ot">=</span>DB_data<span class="sc">$</span>gMS[i]<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a>}<span class="cf">else</span>{}}</span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data<span class="sc">$</span>Sex)) {<span class="cf">if</span> (DB_data<span class="sc">$</span>N_MTP1_3[i]<span class="sc">&gt;=</span><span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data<span class="sc">$</span>N_MTP1_3[i])){</span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a>  DB_data<span class="sc">$</span>gMS[i]<span class="ot">=</span>DB_data<span class="sc">$</span>gMS[i]<span class="sc">+</span><span class="dv">1</span>}<span class="cf">else</span>{}}</span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data<span class="sc">$</span>Sex)) {<span class="cf">if</span> (DB_data<span class="sc">$</span>N_MTP1_4[i]<span class="sc">&gt;=</span><span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data<span class="sc">$</span>N_MTP1_4[i])){</span>
<span id="cb1-119"><a href="#cb1-119" aria-hidden="true" tabindex="-1"></a>  DB_data<span class="sc">$</span>gMS[i]<span class="ot">=</span>DB_data<span class="sc">$</span>gMS[i]<span class="sc">+</span><span class="dv">1</span>}<span class="cf">else</span>{}}</span>
<span id="cb1-120"><a href="#cb1-120" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data<span class="sc">$</span>Sex)) {<span class="cf">if</span> (DB_data<span class="sc">$</span>N_MTP1_5[i]<span class="sc">&gt;=</span><span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data<span class="sc">$</span>N_MTP1_5[i])){</span>
<span id="cb1-121"><a href="#cb1-121" aria-hidden="true" tabindex="-1"></a>  DB_data<span class="sc">$</span>gMS[i]<span class="ot">=</span>DB_data<span class="sc">$</span>gMS[i]<span class="sc">+</span><span class="dv">1</span>}<span class="cf">else</span>{}}</span>
<span id="cb1-122"><a href="#cb1-122" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data<span class="sc">$</span>Sex)) {<span class="cf">if</span> (DB_data<span class="sc">$</span>N_MTP1_6[i]<span class="sc">&gt;=</span><span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data<span class="sc">$</span>N_MTP1_6[i])){</span>
<span id="cb1-123"><a href="#cb1-123" aria-hidden="true" tabindex="-1"></a>  DB_data<span class="sc">$</span>gMS[i]<span class="ot">=</span>DB_data<span class="sc">$</span>gMS[i]<span class="sc">+</span><span class="dv">1</span>}<span class="cf">else</span>{}}</span>
<span id="cb1-124"><a href="#cb1-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-125"><a href="#cb1-125" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculate Rd competition RS ####</span></span>
<span id="cb1-126"><a href="#cb1-126" aria-hidden="true" tabindex="-1"></a>DB_data_clean<span class="sc">$</span>m_RS_Rd_comp<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-127"><a href="#cb1-127" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data_clean<span class="sc">$</span>Sex)) {<span class="cf">if</span> (DB_data_clean<span class="sc">$</span>N_MTP1_1[i]<span class="sc">&gt;=</span><span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>N_MTP1_1[i])){</span>
<span id="cb1-128"><a href="#cb1-128" aria-hidden="true" tabindex="-1"></a>  DB_data_clean<span class="sc">$</span>m_RS_Rd_comp[i]<span class="ot">=</span>DB_data_clean<span class="sc">$</span>N_RD_1[i]</span>
<span id="cb1-129"><a href="#cb1-129" aria-hidden="true" tabindex="-1"></a>}<span class="cf">else</span>{DB_data_clean<span class="sc">$</span>m_RS_Rd_comp[i]<span class="ot">=</span><span class="dv">0</span>}}</span>
<span id="cb1-130"><a href="#cb1-130" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data_clean<span class="sc">$</span>Sex)) {<span class="cf">if</span> (DB_data_clean<span class="sc">$</span>N_MTP1_2[i]<span class="sc">&gt;=</span><span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>N_MTP1_2[i])){</span>
<span id="cb1-131"><a href="#cb1-131" aria-hidden="true" tabindex="-1"></a>  DB_data_clean<span class="sc">$</span>m_RS_Rd_comp[i]<span class="ot">=</span>DB_data_clean<span class="sc">$</span>m_RS_Rd_comp[i]<span class="sc">+</span>DB_data_clean<span class="sc">$</span>N_RD_2[i]</span>
<span id="cb1-132"><a href="#cb1-132" aria-hidden="true" tabindex="-1"></a>}<span class="cf">else</span>{}}</span>
<span id="cb1-133"><a href="#cb1-133" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data_clean<span class="sc">$</span>Sex)) {<span class="cf">if</span> (DB_data_clean<span class="sc">$</span>N_MTP1_3[i]<span class="sc">&gt;=</span><span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>N_MTP1_3[i])){</span>
<span id="cb1-134"><a href="#cb1-134" aria-hidden="true" tabindex="-1"></a>  DB_data_clean<span class="sc">$</span>m_RS_Rd_comp[i]<span class="ot">=</span>DB_data_clean<span class="sc">$</span>m_RS_Rd_comp[i]<span class="sc">+</span>DB_data_clean<span class="sc">$</span>N_RD_3[i]</span>
<span id="cb1-135"><a href="#cb1-135" aria-hidden="true" tabindex="-1"></a>}<span class="cf">else</span>{}}</span>
<span id="cb1-136"><a href="#cb1-136" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data_clean<span class="sc">$</span>Sex)) {<span class="cf">if</span> (DB_data_clean<span class="sc">$</span>N_MTP1_4[i]<span class="sc">&gt;=</span><span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>N_MTP1_4[i])){</span>
<span id="cb1-137"><a href="#cb1-137" aria-hidden="true" tabindex="-1"></a>  DB_data_clean<span class="sc">$</span>m_RS_Rd_comp[i]<span class="ot">=</span>DB_data_clean<span class="sc">$</span>m_RS_Rd_comp[i]<span class="sc">+</span>DB_data_clean<span class="sc">$</span>N_RD_4[i]</span>
<span id="cb1-138"><a href="#cb1-138" aria-hidden="true" tabindex="-1"></a>}<span class="cf">else</span>{}}</span>
<span id="cb1-139"><a href="#cb1-139" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data_clean<span class="sc">$</span>Sex)) {<span class="cf">if</span> (DB_data_clean<span class="sc">$</span>N_MTP1_5[i]<span class="sc">&gt;=</span><span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>N_MTP1_5[i])){</span>
<span id="cb1-140"><a href="#cb1-140" aria-hidden="true" tabindex="-1"></a>  DB_data_clean<span class="sc">$</span>m_RS_Rd_comp[i]<span class="ot">=</span>DB_data_clean<span class="sc">$</span>m_RS_Rd_comp[i]<span class="sc">+</span>DB_data_clean<span class="sc">$</span>N_RD_5[i]</span>
<span id="cb1-141"><a href="#cb1-141" aria-hidden="true" tabindex="-1"></a>}<span class="cf">else</span>{}}</span>
<span id="cb1-142"><a href="#cb1-142" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data_clean<span class="sc">$</span>Sex)) {<span class="cf">if</span> (DB_data_clean<span class="sc">$</span>N_MTP1_6[i]<span class="sc">&gt;=</span><span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>N_MTP1_6[i])){</span>
<span id="cb1-143"><a href="#cb1-143" aria-hidden="true" tabindex="-1"></a>  DB_data_clean<span class="sc">$</span>m_RS_Rd_comp[i]<span class="ot">=</span>DB_data_clean<span class="sc">$</span>m_RS_Rd_comp[i]<span class="sc">+</span>DB_data_clean<span class="sc">$</span>N_RD_6[i]</span>
<span id="cb1-144"><a href="#cb1-144" aria-hidden="true" tabindex="-1"></a>}<span class="cf">else</span>{}}</span>
<span id="cb1-145"><a href="#cb1-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-146"><a href="#cb1-146" aria-hidden="true" tabindex="-1"></a><span class="co"># Check matings of males #### -&gt; add copulations where offspring found but no copulation registered</span></span>
<span id="cb1-147"><a href="#cb1-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-148"><a href="#cb1-148" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data_clean<span class="sc">$</span>Sex)) {<span class="cf">if</span> (DB_data_clean<span class="sc">$</span>N_MTP1_1[i]<span class="sc">&gt;=</span><span class="dv">1</span> <span class="sc">&amp;&amp;</span> DB_data_clean<span class="sc">$</span>Cop_Fe_1[i]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>Cop_Fe_1[i])<span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>N_MTP1_1[i])){</span>
<span id="cb1-149"><a href="#cb1-149" aria-hidden="true" tabindex="-1"></a>  DB_data_clean<span class="sc">$</span>Cop_Fe_1[i]<span class="ot">=</span><span class="dv">1</span>}<span class="cf">else</span>{}}</span>
<span id="cb1-150"><a href="#cb1-150" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data_clean<span class="sc">$</span>Sex)) {<span class="cf">if</span> (DB_data_clean<span class="sc">$</span>N_MTP1_2[i]<span class="sc">&gt;=</span><span class="dv">1</span> <span class="sc">&amp;&amp;</span> DB_data_clean<span class="sc">$</span>Cop_Fe_2[i]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>Cop_Fe_2[i])<span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>N_MTP1_2[i])){</span>
<span id="cb1-151"><a href="#cb1-151" aria-hidden="true" tabindex="-1"></a>  DB_data_clean<span class="sc">$</span>Cop_Fe_2[i]<span class="ot">=</span><span class="dv">1</span>}<span class="cf">else</span>{}}</span>
<span id="cb1-152"><a href="#cb1-152" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data_clean<span class="sc">$</span>Sex)) {<span class="cf">if</span> (DB_data_clean<span class="sc">$</span>N_MTP1_3[i]<span class="sc">&gt;=</span><span class="dv">1</span> <span class="sc">&amp;&amp;</span> DB_data_clean<span class="sc">$</span>Cop_Fe_3[i]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>Cop_Fe_3[i])<span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>N_MTP1_3[i])){</span>
<span id="cb1-153"><a href="#cb1-153" aria-hidden="true" tabindex="-1"></a>  DB_data_clean<span class="sc">$</span>Cop_Fe_3[i]<span class="ot">=</span><span class="dv">1</span>}<span class="cf">else</span>{}}</span>
<span id="cb1-154"><a href="#cb1-154" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data_clean<span class="sc">$</span>Sex)) {<span class="cf">if</span> (DB_data_clean<span class="sc">$</span>N_MTP1_4[i]<span class="sc">&gt;=</span><span class="dv">1</span> <span class="sc">&amp;&amp;</span> DB_data_clean<span class="sc">$</span>Cop_Fe_4[i]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>Cop_Fe_4[i])<span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>N_MTP1_4[i])){</span>
<span id="cb1-155"><a href="#cb1-155" aria-hidden="true" tabindex="-1"></a>  DB_data_clean<span class="sc">$</span>Cop_Fe_4[i]<span class="ot">=</span><span class="dv">1</span>}<span class="cf">else</span>{}}</span>
<span id="cb1-156"><a href="#cb1-156" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data_clean<span class="sc">$</span>Sex)) {<span class="cf">if</span> (DB_data_clean<span class="sc">$</span>N_MTP1_5[i]<span class="sc">&gt;=</span><span class="dv">1</span> <span class="sc">&amp;&amp;</span> DB_data_clean<span class="sc">$</span>Cop_Fe_5[i]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>Cop_Fe_5[i])<span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>N_MTP1_5[i])){</span>
<span id="cb1-157"><a href="#cb1-157" aria-hidden="true" tabindex="-1"></a>  DB_data_clean<span class="sc">$</span>Cop_Fe_5[i]<span class="ot">=</span><span class="dv">1</span>}<span class="cf">else</span>{}}</span>
<span id="cb1-158"><a href="#cb1-158" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data_clean<span class="sc">$</span>Sex)) {<span class="cf">if</span> (DB_data_clean<span class="sc">$</span>N_MTP1_6[i]<span class="sc">&gt;=</span><span class="dv">1</span> <span class="sc">&amp;&amp;</span> DB_data_clean<span class="sc">$</span>Cop_Fe_6[i]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>Cop_Fe_6[i])<span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>N_MTP1_6[i])){</span>
<span id="cb1-159"><a href="#cb1-159" aria-hidden="true" tabindex="-1"></a>  DB_data_clean<span class="sc">$</span>Cop_Fe_6[i]<span class="ot">=</span><span class="dv">1</span>}<span class="cf">else</span>{}}</span>
<span id="cb1-160"><a href="#cb1-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-161"><a href="#cb1-161" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Rd competition RS of all copulations with potential sperm competition with the  focal ####</span></span>
<span id="cb1-162"><a href="#cb1-162" aria-hidden="true" tabindex="-1"></a>DB_data_clean<span class="sc">$</span>m_RS_Rd_comp_full<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-163"><a href="#cb1-163" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data_clean<span class="sc">$</span>Sex)) {<span class="cf">if</span> (DB_data_clean<span class="sc">$</span>Cop_Fe_1[i]<span class="sc">&gt;=</span><span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>Cop_Fe_1[i])){</span>
<span id="cb1-164"><a href="#cb1-164" aria-hidden="true" tabindex="-1"></a>  DB_data_clean<span class="sc">$</span>m_RS_Rd_comp_full[i]<span class="ot">=</span>DB_data_clean<span class="sc">$</span>N_RD_1[i]</span>
<span id="cb1-165"><a href="#cb1-165" aria-hidden="true" tabindex="-1"></a>}<span class="cf">else</span>{DB_data_clean<span class="sc">$</span>m_RS_Rd_comp_full[i]<span class="ot">=</span><span class="dv">0</span>}}</span>
<span id="cb1-166"><a href="#cb1-166" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data_clean<span class="sc">$</span>Sex)) {<span class="cf">if</span> (DB_data_clean<span class="sc">$</span>Cop_Fe_2[i]<span class="sc">&gt;=</span><span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>Cop_Fe_2[i])){</span>
<span id="cb1-167"><a href="#cb1-167" aria-hidden="true" tabindex="-1"></a>  DB_data_clean<span class="sc">$</span>m_RS_Rd_comp_full[i]<span class="ot">=</span>DB_data_clean<span class="sc">$</span>m_RS_Rd_comp_full[i]<span class="sc">+</span>DB_data_clean<span class="sc">$</span>N_RD_2[i]</span>
<span id="cb1-168"><a href="#cb1-168" aria-hidden="true" tabindex="-1"></a>}<span class="cf">else</span>{}}</span>
<span id="cb1-169"><a href="#cb1-169" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data_clean<span class="sc">$</span>Sex)) {<span class="cf">if</span> (DB_data_clean<span class="sc">$</span>Cop_Fe_3[i]<span class="sc">&gt;=</span><span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>Cop_Fe_3[i])){</span>
<span id="cb1-170"><a href="#cb1-170" aria-hidden="true" tabindex="-1"></a>  DB_data_clean<span class="sc">$</span>m_RS_Rd_comp_full[i]<span class="ot">=</span>DB_data_clean<span class="sc">$</span>m_RS_Rd_comp_full[i]<span class="sc">+</span>DB_data_clean<span class="sc">$</span>N_RD_3[i]</span>
<span id="cb1-171"><a href="#cb1-171" aria-hidden="true" tabindex="-1"></a>}<span class="cf">else</span>{}}</span>
<span id="cb1-172"><a href="#cb1-172" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data_clean<span class="sc">$</span>Sex)) {<span class="cf">if</span> (DB_data_clean<span class="sc">$</span>Cop_Fe_4[i]<span class="sc">&gt;=</span><span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>Cop_Fe_4[i])){</span>
<span id="cb1-173"><a href="#cb1-173" aria-hidden="true" tabindex="-1"></a>  DB_data_clean<span class="sc">$</span>m_RS_Rd_comp_full[i]<span class="ot">=</span>DB_data_clean<span class="sc">$</span>m_RS_Rd_comp_full[i]<span class="sc">+</span>DB_data_clean<span class="sc">$</span>N_RD_4[i]</span>
<span id="cb1-174"><a href="#cb1-174" aria-hidden="true" tabindex="-1"></a>}<span class="cf">else</span>{}}</span>
<span id="cb1-175"><a href="#cb1-175" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data_clean<span class="sc">$</span>Sex)) {<span class="cf">if</span> (DB_data_clean<span class="sc">$</span>Cop_Fe_5[i]<span class="sc">&gt;=</span><span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>Cop_Fe_5[i])){</span>
<span id="cb1-176"><a href="#cb1-176" aria-hidden="true" tabindex="-1"></a>  DB_data_clean<span class="sc">$</span>m_RS_Rd_comp_full[i]<span class="ot">=</span>DB_data_clean<span class="sc">$</span>m_RS_Rd_comp_full[i]<span class="sc">+</span>DB_data_clean<span class="sc">$</span>N_RD_5[i]</span>
<span id="cb1-177"><a href="#cb1-177" aria-hidden="true" tabindex="-1"></a>}<span class="cf">else</span>{}}</span>
<span id="cb1-178"><a href="#cb1-178" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data_clean<span class="sc">$</span>Sex)) {<span class="cf">if</span> (DB_data_clean<span class="sc">$</span>Cop_Fe_6[i]<span class="sc">&gt;=</span><span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>Cop_Fe_6[i])){</span>
<span id="cb1-179"><a href="#cb1-179" aria-hidden="true" tabindex="-1"></a>  DB_data_clean<span class="sc">$</span>m_RS_Rd_comp_full[i]<span class="ot">=</span>DB_data_clean<span class="sc">$</span>m_RS_Rd_comp_full[i]<span class="sc">+</span>DB_data_clean<span class="sc">$</span>N_RD_6[i]</span>
<span id="cb1-180"><a href="#cb1-180" aria-hidden="true" tabindex="-1"></a>}<span class="cf">else</span>{}}</span>
<span id="cb1-181"><a href="#cb1-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-182"><a href="#cb1-182" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate trait values ####</span></span>
<span id="cb1-183"><a href="#cb1-183" aria-hidden="true" tabindex="-1"></a><span class="co"># Males ####</span></span>
<span id="cb1-184"><a href="#cb1-184" aria-hidden="true" tabindex="-1"></a><span class="co"># Total number of matings (all data)</span></span>
<span id="cb1-185"><a href="#cb1-185" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>m_TotMatings<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-186"><a href="#cb1-186" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>m_TotMatings<span class="ot">=</span>DB_data<span class="sc">$</span>Matings_number</span>
<span id="cb1-187"><a href="#cb1-187" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>m_TotMatings[DB_data<span class="sc">$</span>Sex<span class="sc">==</span><span class="st">&#39;F&#39;</span>]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-188"><a href="#cb1-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-189"><a href="#cb1-189" aria-hidden="true" tabindex="-1"></a><span class="co"># Avarage mating duration (all data)</span></span>
<span id="cb1-190"><a href="#cb1-190" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>MatingDuration_av[DB_data<span class="sc">$</span>MatingDuration_av<span class="sc">==</span><span class="dv">0</span>]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-191"><a href="#cb1-191" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>m_MatingDuration_av<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-192"><a href="#cb1-192" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>m_MatingDuration_av<span class="ot">=</span>DB_data<span class="sc">$</span>MatingDuration_av</span>
<span id="cb1-193"><a href="#cb1-193" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>m_MatingDuration_av[DB_data<span class="sc">$</span>Sex<span class="sc">==</span><span class="st">&#39;F&#39;</span>]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-194"><a href="#cb1-194" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>MatingDuration_av[DB_data<span class="sc">$</span>MatingDuration_av<span class="sc">==</span><span class="dv">0</span>]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-195"><a href="#cb1-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-196"><a href="#cb1-196" aria-hidden="true" tabindex="-1"></a><span class="co"># Total number of mating attempts (all data)</span></span>
<span id="cb1-197"><a href="#cb1-197" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>m_Attempts_number<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-198"><a href="#cb1-198" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>m_Attempts_number<span class="ot">=</span>DB_data<span class="sc">$</span>Attempts_number</span>
<span id="cb1-199"><a href="#cb1-199" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>m_Attempts_number[DB_data<span class="sc">$</span>Sex<span class="sc">==</span><span class="st">&#39;F&#39;</span>]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-200"><a href="#cb1-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-201"><a href="#cb1-201" aria-hidden="true" tabindex="-1"></a><span class="co"># Proportional mating success (all data)</span></span>
<span id="cb1-202"><a href="#cb1-202" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>m_Prop_MS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-203"><a href="#cb1-203" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>m_Prop_MS<span class="ot">=</span>DB_data<span class="sc">$</span>Prop_MS</span>
<span id="cb1-204"><a href="#cb1-204" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>m_Prop_MS[DB_data<span class="sc">$</span>Sex<span class="sc">==</span><span class="st">&#39;F&#39;</span>]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-205"><a href="#cb1-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-206"><a href="#cb1-206" aria-hidden="true" tabindex="-1"></a><span class="co">#Total encounters (all data)</span></span>
<span id="cb1-207"><a href="#cb1-207" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>m_Total_Encounters<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-208"><a href="#cb1-208" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>m_Total_Encounters<span class="ot">=</span>DB_data<span class="sc">$</span>Total_Encounters</span>
<span id="cb1-209"><a href="#cb1-209" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>m_Total_Encounters[DB_data<span class="sc">$</span>Sex<span class="sc">==</span><span class="st">&#39;F&#39;</span>]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-210"><a href="#cb1-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-211"><a href="#cb1-211" aria-hidden="true" tabindex="-1"></a><span class="co"># Reproductive success</span></span>
<span id="cb1-212"><a href="#cb1-212" aria-hidden="true" tabindex="-1"></a>DB_data_clean<span class="sc">$</span>m_RS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-213"><a href="#cb1-213" aria-hidden="true" tabindex="-1"></a>DB_data_clean<span class="sc">$</span>m_RS<span class="ot">=</span>DB_data_clean<span class="sc">$</span>Total_N_MTP1</span>
<span id="cb1-214"><a href="#cb1-214" aria-hidden="true" tabindex="-1"></a>DB_data_clean<span class="sc">$</span>m_RS[DB_data_clean<span class="sc">$</span>Sex<span class="sc">==</span><span class="st">&#39;F&#39;</span>]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-215"><a href="#cb1-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-216"><a href="#cb1-216" aria-hidden="true" tabindex="-1"></a><span class="co"># Mating success (number of different partners)</span></span>
<span id="cb1-217"><a href="#cb1-217" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean data</span></span>
<span id="cb1-218"><a href="#cb1-218" aria-hidden="true" tabindex="-1"></a>DB_data_clean<span class="sc">$</span>m_cMS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-219"><a href="#cb1-219" aria-hidden="true" tabindex="-1"></a>DB_data_clean<span class="sc">$</span>m_cMS<span class="ot">=</span>DB_data_clean<span class="sc">$</span>MatingPartners_number</span>
<span id="cb1-220"><a href="#cb1-220" aria-hidden="true" tabindex="-1"></a>DB_data_clean<span class="sc">$</span>m_cMS[DB_data_clean<span class="sc">$</span>Sex<span class="sc">==</span><span class="st">&#39;F&#39;</span>]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-221"><a href="#cb1-221" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data_clean<span class="sc">$</span>m_cMS)) {<span class="cf">if</span> (DB_data_clean<span class="sc">$</span>gMS[i]<span class="sc">&gt;</span>DB_data_clean<span class="sc">$</span>m_cMS[i] <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>m_cMS[i])){</span>
<span id="cb1-222"><a href="#cb1-222" aria-hidden="true" tabindex="-1"></a>  DB_data_clean<span class="sc">$</span>m_cMS[i]<span class="ot">=</span>DB_data_clean<span class="sc">$</span>gMS[i]}<span class="cf">else</span>{}}</span>
<span id="cb1-223"><a href="#cb1-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-224"><a href="#cb1-224" aria-hidden="true" tabindex="-1"></a><span class="co"># All data</span></span>
<span id="cb1-225"><a href="#cb1-225" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>m_cMS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-226"><a href="#cb1-226" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>m_cMS<span class="ot">=</span>DB_data<span class="sc">$</span>MatingPartners_number</span>
<span id="cb1-227"><a href="#cb1-227" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>m_cMS[DB_data<span class="sc">$</span>Sex<span class="sc">==</span><span class="st">&#39;F&#39;</span>]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-228"><a href="#cb1-228" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data<span class="sc">$</span>m_cMS)) {<span class="cf">if</span> (DB_data<span class="sc">$</span>gMS[i]<span class="sc">&gt;</span>DB_data<span class="sc">$</span>m_cMS[i] <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data<span class="sc">$</span>m_cMS[i])){</span>
<span id="cb1-229"><a href="#cb1-229" aria-hidden="true" tabindex="-1"></a>  DB_data<span class="sc">$</span>m_cMS[i]<span class="ot">=</span>DB_data<span class="sc">$</span>gMS[i]}<span class="cf">else</span>{}}</span>
<span id="cb1-230"><a href="#cb1-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-231"><a href="#cb1-231" aria-hidden="true" tabindex="-1"></a><span class="co"># Insemination success</span></span>
<span id="cb1-232"><a href="#cb1-232" aria-hidden="true" tabindex="-1"></a>DB_data_clean<span class="sc">$</span>m_InSuc<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-233"><a href="#cb1-233" aria-hidden="true" tabindex="-1"></a>DB_data_clean<span class="sc">$</span>m_InSuc<span class="ot">=</span>DB_data_clean<span class="sc">$</span>gMS<span class="sc">/</span>DB_data_clean<span class="sc">$</span>m_cMS</span>
<span id="cb1-234"><a href="#cb1-234" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data_clean<span class="sc">$</span>m_InSuc)) {<span class="cf">if</span> (DB_data_clean<span class="sc">$</span>m_cMS[i]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>m_cMS[i])){</span>
<span id="cb1-235"><a href="#cb1-235" aria-hidden="true" tabindex="-1"></a>  DB_data_clean<span class="sc">$</span>m_InSuc[i]<span class="ot">=</span><span class="cn">NA</span>}<span class="cf">else</span>{}}</span>
<span id="cb1-236"><a href="#cb1-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-237"><a href="#cb1-237" aria-hidden="true" tabindex="-1"></a><span class="co"># Fertilization success</span></span>
<span id="cb1-238"><a href="#cb1-238" aria-hidden="true" tabindex="-1"></a>DB_data_clean<span class="sc">$</span>m_feSuc<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-239"><a href="#cb1-239" aria-hidden="true" tabindex="-1"></a>DB_data_clean<span class="sc">$</span>m_feSuc<span class="ot">=</span>DB_data_clean<span class="sc">$</span>m_RS<span class="sc">/</span>(DB_data_clean<span class="sc">$</span>m_RS<span class="sc">+</span>DB_data_clean<span class="sc">$</span>m_RS_Rd_comp)</span>
<span id="cb1-240"><a href="#cb1-240" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data_clean<span class="sc">$</span>m_feSuc)) {<span class="cf">if</span> (DB_data_clean<span class="sc">$</span>m_InSuc[i]<span class="sc">==</span><span class="dv">0</span> <span class="sc">|</span> <span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>m_InSuc[i])){</span>
<span id="cb1-241"><a href="#cb1-241" aria-hidden="true" tabindex="-1"></a>  DB_data_clean<span class="sc">$</span>m_feSuc[i]<span class="ot">=</span><span class="cn">NA</span>}<span class="cf">else</span>{}}</span>
<span id="cb1-242"><a href="#cb1-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-243"><a href="#cb1-243" aria-hidden="true" tabindex="-1"></a><span class="co"># Fecundicty of partners</span></span>
<span id="cb1-244"><a href="#cb1-244" aria-hidden="true" tabindex="-1"></a>DB_data_clean<span class="sc">$</span>m_pFec<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-245"><a href="#cb1-245" aria-hidden="true" tabindex="-1"></a>DB_data_clean<span class="sc">$</span>m_pFec<span class="ot">=</span>(DB_data_clean<span class="sc">$</span>m_RS<span class="sc">+</span>DB_data_clean<span class="sc">$</span>m_RS_Rd_comp)<span class="sc">/</span>DB_data_clean<span class="sc">$</span>gMS</span>
<span id="cb1-246"><a href="#cb1-246" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data_clean<span class="sc">$</span>m_pFec)) {<span class="cf">if</span> (DB_data_clean<span class="sc">$</span>gMS[i]<span class="sc">==</span><span class="dv">0</span>){</span>
<span id="cb1-247"><a href="#cb1-247" aria-hidden="true" tabindex="-1"></a>  DB_data_clean<span class="sc">$</span>m_pFec[i]<span class="ot">=</span><span class="cn">NA</span>}<span class="cf">else</span>{}}</span>
<span id="cb1-248"><a href="#cb1-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-249"><a href="#cb1-249" aria-hidden="true" tabindex="-1"></a><span class="co"># Paternity success</span></span>
<span id="cb1-250"><a href="#cb1-250" aria-hidden="true" tabindex="-1"></a>DB_data_clean<span class="sc">$</span>m_PS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-251"><a href="#cb1-251" aria-hidden="true" tabindex="-1"></a>DB_data_clean<span class="sc">$</span>m_PS<span class="ot">=</span>DB_data_clean<span class="sc">$</span>m_RS<span class="sc">/</span>(DB_data_clean<span class="sc">$</span>m_RS<span class="sc">+</span>DB_data_clean<span class="sc">$</span>m_RS_Rd_comp_full)</span>
<span id="cb1-252"><a href="#cb1-252" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data_clean<span class="sc">$</span>m_PS)) {<span class="cf">if</span> (DB_data_clean<span class="sc">$</span>m_RS[i]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>m_RS[i])){</span>
<span id="cb1-253"><a href="#cb1-253" aria-hidden="true" tabindex="-1"></a>  DB_data_clean<span class="sc">$</span>m_PS[i]<span class="ot">=</span><span class="cn">NA</span>}<span class="cf">else</span>{}}</span>
<span id="cb1-254"><a href="#cb1-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-255"><a href="#cb1-255" aria-hidden="true" tabindex="-1"></a><span class="co"># Fecundity of partners in all females the focal copulated with</span></span>
<span id="cb1-256"><a href="#cb1-256" aria-hidden="true" tabindex="-1"></a>DB_data_clean<span class="sc">$</span>m_pFec_compl<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-257"><a href="#cb1-257" aria-hidden="true" tabindex="-1"></a>DB_data_clean<span class="sc">$</span>m_pFec_compl<span class="ot">=</span>(DB_data_clean<span class="sc">$</span>m_RS<span class="sc">+</span>DB_data_clean<span class="sc">$</span>m_RS_Rd_comp_full)<span class="sc">/</span>DB_data_clean<span class="sc">$</span>m_cMS</span>
<span id="cb1-258"><a href="#cb1-258" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data_clean<span class="sc">$</span>m_pFec)) {<span class="cf">if</span> (DB_data_clean<span class="sc">$</span>m_cMS[i]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>m_cMS[i])){</span>
<span id="cb1-259"><a href="#cb1-259" aria-hidden="true" tabindex="-1"></a>  DB_data_clean<span class="sc">$</span>m_pFec[i]<span class="ot">=</span><span class="cn">NA</span>}<span class="cf">else</span>{}}</span>
<span id="cb1-260"><a href="#cb1-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-261"><a href="#cb1-261" aria-hidden="true" tabindex="-1"></a><span class="co"># Females ####</span></span>
<span id="cb1-262"><a href="#cb1-262" aria-hidden="true" tabindex="-1"></a><span class="co"># Total number of matings (all data)</span></span>
<span id="cb1-263"><a href="#cb1-263" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>f_TotMatings<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-264"><a href="#cb1-264" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>f_TotMatings<span class="ot">=</span>DB_data<span class="sc">$</span>Matings_number</span>
<span id="cb1-265"><a href="#cb1-265" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>f_TotMatings[DB_data<span class="sc">$</span>Sex<span class="sc">==</span><span class="st">&#39;M&#39;</span>]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-266"><a href="#cb1-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-267"><a href="#cb1-267" aria-hidden="true" tabindex="-1"></a><span class="co"># Avarage mating duration (all data)</span></span>
<span id="cb1-268"><a href="#cb1-268" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>f_MatingDuration_av<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-269"><a href="#cb1-269" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>f_MatingDuration_av<span class="ot">=</span>DB_data<span class="sc">$</span>MatingDuration_av</span>
<span id="cb1-270"><a href="#cb1-270" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>f_MatingDuration_av[DB_data<span class="sc">$</span>Sex<span class="sc">==</span><span class="st">&#39;M&#39;</span>]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-271"><a href="#cb1-271" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>MatingDuration_av[DB_data<span class="sc">$</span>MatingDuration_av<span class="sc">==</span><span class="dv">0</span>]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-272"><a href="#cb1-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-273"><a href="#cb1-273" aria-hidden="true" tabindex="-1"></a><span class="co"># Total number of mating attempts (all data)</span></span>
<span id="cb1-274"><a href="#cb1-274" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>f_Attempts_number<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-275"><a href="#cb1-275" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>f_Attempts_number<span class="ot">=</span>DB_data<span class="sc">$</span>Attempts_number</span>
<span id="cb1-276"><a href="#cb1-276" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>f_Attempts_number[DB_data<span class="sc">$</span>Sex<span class="sc">==</span><span class="st">&#39;M&#39;</span>]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-277"><a href="#cb1-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-278"><a href="#cb1-278" aria-hidden="true" tabindex="-1"></a><span class="co"># Proportional mating success (all data)</span></span>
<span id="cb1-279"><a href="#cb1-279" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>f_Prop_MS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-280"><a href="#cb1-280" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>f_Prop_MS<span class="ot">=</span>DB_data<span class="sc">$</span>Prop_MS</span>
<span id="cb1-281"><a href="#cb1-281" aria-hidden="true" tabindex="-1"></a>DB_data_clean<span class="sc">$</span>f_Prop_MS[DB_data_clean<span class="sc">$</span>Sex<span class="sc">==</span><span class="st">&#39;M&#39;</span>]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-282"><a href="#cb1-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-283"><a href="#cb1-283" aria-hidden="true" tabindex="-1"></a><span class="co">#Total encounters (all data)</span></span>
<span id="cb1-284"><a href="#cb1-284" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>f_Total_Encounters<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-285"><a href="#cb1-285" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>f_Total_Encounters<span class="ot">=</span>DB_data<span class="sc">$</span>Total_Encounters</span>
<span id="cb1-286"><a href="#cb1-286" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>f_Total_Encounters[DB_data<span class="sc">$</span>Sex<span class="sc">==</span><span class="st">&#39;M&#39;</span>]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-287"><a href="#cb1-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-288"><a href="#cb1-288" aria-hidden="true" tabindex="-1"></a><span class="co"># Reproductive success</span></span>
<span id="cb1-289"><a href="#cb1-289" aria-hidden="true" tabindex="-1"></a>DB_data_clean<span class="sc">$</span>f_RS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-290"><a href="#cb1-290" aria-hidden="true" tabindex="-1"></a>DB_data_clean<span class="sc">$</span>f_RS<span class="ot">=</span>DB_data_clean<span class="sc">$</span>Total_N_MTP1</span>
<span id="cb1-291"><a href="#cb1-291" aria-hidden="true" tabindex="-1"></a>DB_data_clean<span class="sc">$</span>f_RS[DB_data_clean<span class="sc">$</span>Sex<span class="sc">==</span><span class="st">&#39;M&#39;</span>]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-292"><a href="#cb1-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-293"><a href="#cb1-293" aria-hidden="true" tabindex="-1"></a><span class="co"># Mating success (number of different partners)</span></span>
<span id="cb1-294"><a href="#cb1-294" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean data</span></span>
<span id="cb1-295"><a href="#cb1-295" aria-hidden="true" tabindex="-1"></a>DB_data_clean<span class="sc">$</span>f_cMS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-296"><a href="#cb1-296" aria-hidden="true" tabindex="-1"></a>DB_data_clean<span class="sc">$</span>f_cMS<span class="ot">=</span>DB_data_clean<span class="sc">$</span>MatingPartners_number</span>
<span id="cb1-297"><a href="#cb1-297" aria-hidden="true" tabindex="-1"></a>DB_data_clean<span class="sc">$</span>f_cMS[DB_data_clean<span class="sc">$</span>Sex<span class="sc">==</span><span class="st">&#39;M&#39;</span>]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-298"><a href="#cb1-298" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data_clean<span class="sc">$</span>f_cMS)) {<span class="cf">if</span> (DB_data_clean<span class="sc">$</span>gMS[i]<span class="sc">&gt;</span>DB_data_clean<span class="sc">$</span>f_cMS[i] <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>f_cMS[i])){</span>
<span id="cb1-299"><a href="#cb1-299" aria-hidden="true" tabindex="-1"></a>  DB_data_clean<span class="sc">$</span>f_cMS[i]<span class="ot">=</span>DB_data_clean<span class="sc">$</span>gMS[i]}<span class="cf">else</span>{}}</span>
<span id="cb1-300"><a href="#cb1-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-301"><a href="#cb1-301" aria-hidden="true" tabindex="-1"></a><span class="co"># All data</span></span>
<span id="cb1-302"><a href="#cb1-302" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>f_cMS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-303"><a href="#cb1-303" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>f_cMS<span class="ot">=</span>DB_data<span class="sc">$</span>MatingPartners_number</span>
<span id="cb1-304"><a href="#cb1-304" aria-hidden="true" tabindex="-1"></a>DB_data<span class="sc">$</span>f_cMS[DB_data<span class="sc">$</span>Sex<span class="sc">==</span><span class="st">&#39;M&#39;</span>]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-305"><a href="#cb1-305" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data<span class="sc">$</span>f_cMS)) {<span class="cf">if</span> (DB_data<span class="sc">$</span>gMS[i]<span class="sc">&gt;</span>DB_data<span class="sc">$</span>f_cMS[i] <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data<span class="sc">$</span>f_cMS[i])){</span>
<span id="cb1-306"><a href="#cb1-306" aria-hidden="true" tabindex="-1"></a>  DB_data<span class="sc">$</span>f_cMS[i]<span class="ot">=</span>DB_data<span class="sc">$</span>gMS[i]}<span class="cf">else</span>{}}</span>
<span id="cb1-307"><a href="#cb1-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-308"><a href="#cb1-308" aria-hidden="true" tabindex="-1"></a><span class="co"># Fecundity per mating partner</span></span>
<span id="cb1-309"><a href="#cb1-309" aria-hidden="true" tabindex="-1"></a>DB_data_clean<span class="sc">$</span>f_fec_pMate<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-310"><a href="#cb1-310" aria-hidden="true" tabindex="-1"></a>DB_data_clean<span class="sc">$</span>f_fec_pMate<span class="ot">=</span>DB_data_clean<span class="sc">$</span>f_RS<span class="sc">/</span>DB_data_clean<span class="sc">$</span>f_cMS</span>
<span id="cb1-311"><a href="#cb1-311" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data_clean<span class="sc">$</span>f_fec_pMate)) {<span class="cf">if</span> (DB_data_clean<span class="sc">$</span>f_RS[i]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>f_RS[i])){</span>
<span id="cb1-312"><a href="#cb1-312" aria-hidden="true" tabindex="-1"></a>  DB_data_clean<span class="sc">$</span>f_fec_pMate[i]<span class="ot">=</span><span class="dv">0</span>}<span class="cf">else</span>{}}</span>
<span id="cb1-313"><a href="#cb1-313" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DB_data_clean<span class="sc">$</span>f_fec_pMate)) {<span class="cf">if</span> (DB_data_clean<span class="sc">$</span>f_cMS[i]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span> (DB_data_clean<span class="sc">$</span>f_cMS[i])){</span>
<span id="cb1-314"><a href="#cb1-314" aria-hidden="true" tabindex="-1"></a>  DB_data_clean<span class="sc">$</span>f_fec_pMate[i]<span class="ot">=</span><span class="cn">NA</span>}<span class="cf">else</span>{}}</span>
<span id="cb1-315"><a href="#cb1-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-316"><a href="#cb1-316" aria-hidden="true" tabindex="-1"></a><span class="co"># Relativize data per treatment and sex ####</span></span>
<span id="cb1-317"><a href="#cb1-317" aria-hidden="true" tabindex="-1"></a><span class="co"># Small group + large Area</span></span>
<span id="cb1-318"><a href="#cb1-318" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.26</span><span class="ot">=</span>DB_data_clean[DB_data_clean<span class="sc">$</span>Treatment<span class="sc">==</span><span class="st">&#39;D = 0.26&#39;</span>,]</span>
<span id="cb1-319"><a href="#cb1-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-320"><a href="#cb1-320" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>rel_m_RS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-321"><a href="#cb1-321" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>rel_m_prop_RS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-322"><a href="#cb1-322" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>rel_m_cMS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-323"><a href="#cb1-323" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>rel_m_InSuc<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-324"><a href="#cb1-324" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>rel_m_feSuc<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-325"><a href="#cb1-325" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>rel_m_pFec<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-326"><a href="#cb1-326" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>rel_m_PS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-327"><a href="#cb1-327" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>rel_m_pFec_compl<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-328"><a href="#cb1-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-329"><a href="#cb1-329" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>rel_f_RS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-330"><a href="#cb1-330" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>rel_f_prop_RS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-331"><a href="#cb1-331" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>rel_f_cMS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-332"><a href="#cb1-332" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>rel_f_fec_pMate<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-333"><a href="#cb1-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-334"><a href="#cb1-334" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>rel_m_RS<span class="ot">=</span>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>m_RS,<span class="at">na.rm=</span>T)</span>
<span id="cb1-335"><a href="#cb1-335" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>rel_m_prop_RS<span class="ot">=</span>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>m_prop_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>m_prop_RS,<span class="at">na.rm=</span>T)</span>
<span id="cb1-336"><a href="#cb1-336" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>rel_m_cMS<span class="ot">=</span>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>m_cMS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>m_cMS,<span class="at">na.rm=</span>T)</span>
<span id="cb1-337"><a href="#cb1-337" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>rel_m_InSuc<span class="ot">=</span>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>m_InSuc<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>m_InSuc,<span class="at">na.rm=</span>T)</span>
<span id="cb1-338"><a href="#cb1-338" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>rel_m_feSuc<span class="ot">=</span>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>m_feSuc<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>m_feSuc,<span class="at">na.rm=</span>T)</span>
<span id="cb1-339"><a href="#cb1-339" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>rel_m_pFec<span class="ot">=</span>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>m_pFec<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>m_pFec,<span class="at">na.rm=</span>T)</span>
<span id="cb1-340"><a href="#cb1-340" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>rel_m_PS<span class="ot">=</span>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>m_PS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>m_PS,<span class="at">na.rm=</span>T)</span>
<span id="cb1-341"><a href="#cb1-341" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>rel_m_pFec_compl<span class="ot">=</span>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>m_pFec_compl<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>m_pFec_compl,<span class="at">na.rm=</span>T)</span>
<span id="cb1-342"><a href="#cb1-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-343"><a href="#cb1-343" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>rel_f_RS<span class="ot">=</span>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>f_RS,<span class="at">na.rm=</span>T)</span>
<span id="cb1-344"><a href="#cb1-344" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>rel_f_prop_RS<span class="ot">=</span>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>f_prop_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>f_prop_RS,<span class="at">na.rm=</span>T)</span>
<span id="cb1-345"><a href="#cb1-345" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>rel_f_cMS<span class="ot">=</span>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>f_cMS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>f_cMS,<span class="at">na.rm=</span>T)</span>
<span id="cb1-346"><a href="#cb1-346" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>rel_f_fec_pMate<span class="ot">=</span>DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>f_fec_pMate<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.26</span><span class="sc">$</span>f_fec_pMate,<span class="at">na.rm=</span>T)</span>
<span id="cb1-347"><a href="#cb1-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-348"><a href="#cb1-348" aria-hidden="true" tabindex="-1"></a><span class="co"># Large group + large Area</span></span>
<span id="cb1-349"><a href="#cb1-349" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.52</span><span class="ot">=</span>DB_data_clean[DB_data_clean<span class="sc">$</span>Treatment<span class="sc">==</span><span class="st">&#39;D = 0.52&#39;</span>,]</span>
<span id="cb1-350"><a href="#cb1-350" aria-hidden="true" tabindex="-1"></a><span class="co">#Relativize data</span></span>
<span id="cb1-351"><a href="#cb1-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-352"><a href="#cb1-352" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>rel_m_RS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-353"><a href="#cb1-353" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>rel_m_prop_RS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-354"><a href="#cb1-354" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>rel_m_cMS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-355"><a href="#cb1-355" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>rel_m_InSuc<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-356"><a href="#cb1-356" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>rel_m_feSuc<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-357"><a href="#cb1-357" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>rel_m_pFec<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-358"><a href="#cb1-358" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>rel_m_PS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-359"><a href="#cb1-359" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>rel_m_pFec_compl<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-360"><a href="#cb1-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-361"><a href="#cb1-361" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>rel_f_RS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-362"><a href="#cb1-362" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>rel_f_prop_RS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-363"><a href="#cb1-363" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>rel_f_cMS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-364"><a href="#cb1-364" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>rel_f_fec_pMate<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-365"><a href="#cb1-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-366"><a href="#cb1-366" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>rel_m_RS<span class="ot">=</span>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>m_RS,<span class="at">na.rm=</span>T)</span>
<span id="cb1-367"><a href="#cb1-367" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>rel_m_prop_RS<span class="ot">=</span>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>m_prop_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>m_prop_RS,<span class="at">na.rm=</span>T)</span>
<span id="cb1-368"><a href="#cb1-368" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>rel_m_cMS<span class="ot">=</span>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>m_cMS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>m_cMS,<span class="at">na.rm=</span>T)</span>
<span id="cb1-369"><a href="#cb1-369" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>rel_m_InSuc<span class="ot">=</span>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>m_InSuc<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>m_InSuc,<span class="at">na.rm=</span>T)</span>
<span id="cb1-370"><a href="#cb1-370" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>rel_m_feSuc<span class="ot">=</span>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>m_feSuc<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>m_feSuc,<span class="at">na.rm=</span>T)</span>
<span id="cb1-371"><a href="#cb1-371" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>rel_m_pFec<span class="ot">=</span>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>m_pFec<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>m_pFec,<span class="at">na.rm=</span>T)</span>
<span id="cb1-372"><a href="#cb1-372" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>rel_m_PS<span class="ot">=</span>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>m_PS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>m_PS,<span class="at">na.rm=</span>T)</span>
<span id="cb1-373"><a href="#cb1-373" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>rel_m_pFec_compl<span class="ot">=</span>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>m_pFec_compl<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>m_pFec_compl,<span class="at">na.rm=</span>T)</span>
<span id="cb1-374"><a href="#cb1-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-375"><a href="#cb1-375" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>rel_f_RS<span class="ot">=</span>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>f_RS,<span class="at">na.rm=</span>T)</span>
<span id="cb1-376"><a href="#cb1-376" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>rel_f_prop_RS<span class="ot">=</span>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>f_prop_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>f_prop_RS,<span class="at">na.rm=</span>T)</span>
<span id="cb1-377"><a href="#cb1-377" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>rel_f_cMS<span class="ot">=</span>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>f_cMS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>f_cMS,<span class="at">na.rm=</span>T)</span>
<span id="cb1-378"><a href="#cb1-378" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>rel_f_fec_pMate<span class="ot">=</span>DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>f_fec_pMate<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.52</span><span class="sc">$</span>f_fec_pMate,<span class="at">na.rm=</span>T)</span>
<span id="cb1-379"><a href="#cb1-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-380"><a href="#cb1-380" aria-hidden="true" tabindex="-1"></a><span class="co"># Small group + small Area</span></span>
<span id="cb1-381"><a href="#cb1-381" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.67</span><span class="ot">=</span>DB_data_clean[DB_data_clean<span class="sc">$</span>Treatment<span class="sc">==</span><span class="st">&#39;D = 0.67&#39;</span>,]</span>
<span id="cb1-382"><a href="#cb1-382" aria-hidden="true" tabindex="-1"></a><span class="co">#Relativize data</span></span>
<span id="cb1-383"><a href="#cb1-383" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>rel_m_RS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-384"><a href="#cb1-384" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>rel_m_prop_RS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-385"><a href="#cb1-385" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>rel_m_cMS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-386"><a href="#cb1-386" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>rel_m_InSuc<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-387"><a href="#cb1-387" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>rel_m_feSuc<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-388"><a href="#cb1-388" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>rel_m_pFec<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-389"><a href="#cb1-389" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>rel_m_PS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-390"><a href="#cb1-390" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>rel_m_pFec_compl<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-391"><a href="#cb1-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-392"><a href="#cb1-392" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>rel_f_RS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-393"><a href="#cb1-393" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>rel_f_prop_RS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-394"><a href="#cb1-394" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>rel_f_cMS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-395"><a href="#cb1-395" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>rel_f_fec_pMate<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-396"><a href="#cb1-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-397"><a href="#cb1-397" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>rel_m_RS<span class="ot">=</span>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>m_RS,<span class="at">na.rm=</span>T)</span>
<span id="cb1-398"><a href="#cb1-398" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>rel_m_prop_RS<span class="ot">=</span>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>m_prop_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>m_prop_RS,<span class="at">na.rm=</span>T)</span>
<span id="cb1-399"><a href="#cb1-399" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>rel_m_cMS<span class="ot">=</span>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>m_cMS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>m_cMS,<span class="at">na.rm=</span>T)</span>
<span id="cb1-400"><a href="#cb1-400" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>rel_m_InSuc<span class="ot">=</span>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>m_InSuc<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>m_InSuc,<span class="at">na.rm=</span>T)</span>
<span id="cb1-401"><a href="#cb1-401" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>rel_m_feSuc<span class="ot">=</span>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>m_feSuc<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>m_feSuc,<span class="at">na.rm=</span>T)</span>
<span id="cb1-402"><a href="#cb1-402" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>rel_m_pFec<span class="ot">=</span>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>m_pFec<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>m_pFec,<span class="at">na.rm=</span>T)</span>
<span id="cb1-403"><a href="#cb1-403" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>rel_m_PS<span class="ot">=</span>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>m_PS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>m_PS,<span class="at">na.rm=</span>T)</span>
<span id="cb1-404"><a href="#cb1-404" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>rel_m_pFec_compl<span class="ot">=</span>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>m_pFec_compl<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>m_pFec_compl,<span class="at">na.rm=</span>T)</span>
<span id="cb1-405"><a href="#cb1-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-406"><a href="#cb1-406" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>rel_f_RS<span class="ot">=</span>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>f_RS,<span class="at">na.rm=</span>T)</span>
<span id="cb1-407"><a href="#cb1-407" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>rel_f_prop_RS<span class="ot">=</span>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>f_prop_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>f_prop_RS,<span class="at">na.rm=</span>T)</span>
<span id="cb1-408"><a href="#cb1-408" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>rel_f_cMS<span class="ot">=</span>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>f_cMS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>f_cMS,<span class="at">na.rm=</span>T)</span>
<span id="cb1-409"><a href="#cb1-409" aria-hidden="true" tabindex="-1"></a>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>rel_f_fec_pMate<span class="ot">=</span>DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>f_fec_pMate<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_0<span class="fl">.67</span><span class="sc">$</span>f_fec_pMate,<span class="at">na.rm=</span>T)</span>
<span id="cb1-410"><a href="#cb1-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-411"><a href="#cb1-411" aria-hidden="true" tabindex="-1"></a><span class="co"># Large group + small Area</span></span>
<span id="cb1-412"><a href="#cb1-412" aria-hidden="true" tabindex="-1"></a>DB_data_clean_1<span class="fl">.33</span><span class="ot">=</span>DB_data_clean[DB_data_clean<span class="sc">$</span>Treatment<span class="sc">==</span><span class="st">&#39;D = 1.33&#39;</span>,]</span>
<span id="cb1-413"><a href="#cb1-413" aria-hidden="true" tabindex="-1"></a><span class="co">#Relativize data</span></span>
<span id="cb1-414"><a href="#cb1-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-415"><a href="#cb1-415" aria-hidden="true" tabindex="-1"></a>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>rel_m_RS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-416"><a href="#cb1-416" aria-hidden="true" tabindex="-1"></a>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>rel_m_prop_RS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-417"><a href="#cb1-417" aria-hidden="true" tabindex="-1"></a>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>rel_m_cMS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-418"><a href="#cb1-418" aria-hidden="true" tabindex="-1"></a>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>rel_m_InSuc<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-419"><a href="#cb1-419" aria-hidden="true" tabindex="-1"></a>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>rel_m_feSuc<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-420"><a href="#cb1-420" aria-hidden="true" tabindex="-1"></a>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>rel_m_pFec<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-421"><a href="#cb1-421" aria-hidden="true" tabindex="-1"></a>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>rel_m_PS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-422"><a href="#cb1-422" aria-hidden="true" tabindex="-1"></a>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>rel_m_pFec_compl<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-423"><a href="#cb1-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-424"><a href="#cb1-424" aria-hidden="true" tabindex="-1"></a>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>rel_f_RS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-425"><a href="#cb1-425" aria-hidden="true" tabindex="-1"></a>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>rel_f_prop_RS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-426"><a href="#cb1-426" aria-hidden="true" tabindex="-1"></a>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>rel_f_cMS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-427"><a href="#cb1-427" aria-hidden="true" tabindex="-1"></a>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>rel_f_fec_pMate<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb1-428"><a href="#cb1-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-429"><a href="#cb1-429" aria-hidden="true" tabindex="-1"></a>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>rel_m_RS<span class="ot">=</span>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>m_RS,<span class="at">na.rm=</span>T)</span>
<span id="cb1-430"><a href="#cb1-430" aria-hidden="true" tabindex="-1"></a>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>rel_m_prop_RS<span class="ot">=</span>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>m_prop_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>m_prop_RS,<span class="at">na.rm=</span>T)</span>
<span id="cb1-431"><a href="#cb1-431" aria-hidden="true" tabindex="-1"></a>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>rel_m_cMS<span class="ot">=</span>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>m_cMS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>m_cMS,<span class="at">na.rm=</span>T)</span>
<span id="cb1-432"><a href="#cb1-432" aria-hidden="true" tabindex="-1"></a>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>rel_m_InSuc<span class="ot">=</span>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>m_InSuc<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>m_InSuc,<span class="at">na.rm=</span>T)</span>
<span id="cb1-433"><a href="#cb1-433" aria-hidden="true" tabindex="-1"></a>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>rel_m_feSuc<span class="ot">=</span>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>m_feSuc<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>m_feSuc,<span class="at">na.rm=</span>T)</span>
<span id="cb1-434"><a href="#cb1-434" aria-hidden="true" tabindex="-1"></a>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>rel_m_pFec<span class="ot">=</span>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>m_pFec<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>m_pFec,<span class="at">na.rm=</span>T)</span>
<span id="cb1-435"><a href="#cb1-435" aria-hidden="true" tabindex="-1"></a>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>rel_m_PS<span class="ot">=</span>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>m_PS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>m_PS,<span class="at">na.rm=</span>T)</span>
<span id="cb1-436"><a href="#cb1-436" aria-hidden="true" tabindex="-1"></a>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>rel_m_pFec_compl<span class="ot">=</span>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>m_pFec_compl<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>m_pFec_compl,<span class="at">na.rm=</span>T)</span>
<span id="cb1-437"><a href="#cb1-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-438"><a href="#cb1-438" aria-hidden="true" tabindex="-1"></a>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>rel_f_RS<span class="ot">=</span>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>f_RS,<span class="at">na.rm=</span>T)</span>
<span id="cb1-439"><a href="#cb1-439" aria-hidden="true" tabindex="-1"></a>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>rel_f_prop_RS<span class="ot">=</span>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>f_prop_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>f_prop_RS,<span class="at">na.rm=</span>T)</span>
<span id="cb1-440"><a href="#cb1-440" aria-hidden="true" tabindex="-1"></a>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>rel_f_cMS<span class="ot">=</span>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>f_cMS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>f_cMS,<span class="at">na.rm=</span>T)</span>
<span id="cb1-441"><a href="#cb1-441" aria-hidden="true" tabindex="-1"></a>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>rel_f_fec_pMate<span class="ot">=</span>DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>f_fec_pMate<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_1<span class="fl">.33</span><span class="sc">$</span>f_fec_pMate,<span class="at">na.rm=</span>T)</span>
<span id="cb1-442"><a href="#cb1-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-443"><a href="#cb1-443" aria-hidden="true" tabindex="-1"></a><span class="co"># Set colors for figures</span></span>
<span id="cb1-444"><a href="#cb1-444" aria-hidden="true" tabindex="-1"></a>colpal<span class="ot">=</span><span class="fu">brewer.pal</span>(<span class="dv">4</span>, <span class="st">&#39;Dark2&#39;</span>)</span>
<span id="cb1-445"><a href="#cb1-445" aria-hidden="true" tabindex="-1"></a>colpal2<span class="ot">=</span><span class="fu">brewer.pal</span>(<span class="dv">3</span>, <span class="st">&#39;Set1&#39;</span>)</span>
<span id="cb1-446"><a href="#cb1-446" aria-hidden="true" tabindex="-1"></a>colpal3<span class="ot">=</span><span class="fu">brewer.pal</span>(<span class="dv">4</span>, <span class="st">&#39;Paired&#39;</span>)</span>
<span id="cb1-447"><a href="#cb1-447" aria-hidden="true" tabindex="-1"></a>slava_ukrajini<span class="ot">=</span>(<span class="fu">c</span>(<span class="st">&#39;#0057B8&#39;</span>,<span class="st">&#39;#FFD700&#39;</span>))</span>
<span id="cb1-448"><a href="#cb1-448" aria-hidden="true" tabindex="-1"></a>colorESEB<span class="ot">=</span><span class="fu">c</span>(<span class="st">&#39;#01519c&#39;</span>,<span class="st">&#39;#ffdf33&#39;</span>)</span>
<span id="cb1-449"><a href="#cb1-449" aria-hidden="true" tabindex="-1"></a>colorESEB2<span class="ot">=</span><span class="fu">c</span>(<span class="st">&#39;#1DA1F2&#39;</span>,<span class="st">&#39;#ffec69&#39;</span>)</span>
<span id="cb1-450"><a href="#cb1-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-451"><a href="#cb1-451" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge data according to treatment #### -&gt; Reduce treatments to area and population size</span></span>
<span id="cb1-452"><a href="#cb1-452" aria-hidden="true" tabindex="-1"></a><span class="co">#Area</span></span>
<span id="cb1-453"><a href="#cb1-453" aria-hidden="true" tabindex="-1"></a>DB_data_clean_Large_area<span class="ot">=</span><span class="fu">rbind</span>(DB_data_clean_0<span class="fl">.26</span>,DB_data_clean_0<span class="fl">.52</span>)</span>
<span id="cb1-454"><a href="#cb1-454" aria-hidden="true" tabindex="-1"></a>DB_data_clean_Small_area<span class="ot">=</span><span class="fu">rbind</span>(DB_data_clean_0<span class="fl">.67</span>,DB_data_clean_1<span class="fl">.33</span>)</span>
<span id="cb1-455"><a href="#cb1-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-456"><a href="#cb1-456" aria-hidden="true" tabindex="-1"></a><span class="co">#Population size</span></span>
<span id="cb1-457"><a href="#cb1-457" aria-hidden="true" tabindex="-1"></a>DB_data_clean_Small_pop<span class="ot">=</span><span class="fu">rbind</span>(DB_data_clean_0<span class="fl">.26</span>,DB_data_clean_0<span class="fl">.67</span>)</span>
<span id="cb1-458"><a href="#cb1-458" aria-hidden="true" tabindex="-1"></a>DB_data_clean_Large_pop<span class="ot">=</span><span class="fu">rbind</span>(DB_data_clean_0<span class="fl">.52</span>,DB_data_clean_1<span class="fl">.33</span>)</span>
<span id="cb1-459"><a href="#cb1-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-460"><a href="#cb1-460" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge data according to treatment full data set #### -&gt; Reduce treatments to area and population size</span></span>
<span id="cb1-461"><a href="#cb1-461" aria-hidden="true" tabindex="-1"></a>DB_data_0<span class="fl">.26</span><span class="ot">=</span>DB_data[DB_data<span class="sc">$</span>Treatment<span class="sc">==</span><span class="st">&#39;D = 0.26&#39;</span>,]</span>
<span id="cb1-462"><a href="#cb1-462" aria-hidden="true" tabindex="-1"></a>DB_data_0<span class="fl">.52</span><span class="ot">=</span>DB_data[DB_data<span class="sc">$</span>Treatment<span class="sc">==</span><span class="st">&#39;D = 0.52&#39;</span>,]</span>
<span id="cb1-463"><a href="#cb1-463" aria-hidden="true" tabindex="-1"></a>DB_data_0<span class="fl">.67</span><span class="ot">=</span>DB_data[DB_data<span class="sc">$</span>Treatment<span class="sc">==</span><span class="st">&#39;D = 0.67&#39;</span>,]</span>
<span id="cb1-464"><a href="#cb1-464" aria-hidden="true" tabindex="-1"></a>DB_data_1<span class="fl">.33</span><span class="ot">=</span>DB_data[DB_data<span class="sc">$</span>Treatment<span class="sc">==</span><span class="st">&#39;D = 1.33&#39;</span>,]</span>
<span id="cb1-465"><a href="#cb1-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-466"><a href="#cb1-466" aria-hidden="true" tabindex="-1"></a><span class="co">#Area</span></span>
<span id="cb1-467"><a href="#cb1-467" aria-hidden="true" tabindex="-1"></a>DB_data_Large_area_full<span class="ot">=</span><span class="fu">rbind</span>(DB_data_0<span class="fl">.26</span>,DB_data_0<span class="fl">.52</span>)</span>
<span id="cb1-468"><a href="#cb1-468" aria-hidden="true" tabindex="-1"></a>DB_data_Small_area_full<span class="ot">=</span><span class="fu">rbind</span>(DB_data_0<span class="fl">.67</span>,DB_data_1<span class="fl">.33</span>)</span>
<span id="cb1-469"><a href="#cb1-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-470"><a href="#cb1-470" aria-hidden="true" tabindex="-1"></a><span class="co">#Population size</span></span>
<span id="cb1-471"><a href="#cb1-471" aria-hidden="true" tabindex="-1"></a>DB_data_Small_pop_full<span class="ot">=</span><span class="fu">rbind</span>(DB_data_0<span class="fl">.26</span>,DB_data_0<span class="fl">.67</span>)</span>
<span id="cb1-472"><a href="#cb1-472" aria-hidden="true" tabindex="-1"></a>DB_data_Large_pop_full<span class="ot">=</span><span class="fu">rbind</span>(DB_data_0<span class="fl">.52</span>,DB_data_1<span class="fl">.33</span>)</span></code></pre></div>
</div>
<div id="effect-of-body-mass-on-reproductive-success"
class="section level1">
<h1>Effect of body mass on reproductive success</h1>
<p>Correlation between body mass and reproductive success (selection
gradient).</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Effect of body mass on reproductive success - Selection gradient ####</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Male</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>DB_data_clean_M<span class="ot">=</span>DB_data_clean[DB_data_clean<span class="sc">$</span>Sex<span class="sc">==</span><span class="st">&#39;M&#39;</span>,]</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Standardize body mass</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>DB_data_clean_M<span class="sc">$</span>stder_BM_focal<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>DB_data_clean_M<span class="sc">$</span>stder_BM_focal<span class="ot">=</span>DB_data_clean_M<span class="sc">$</span>Body_mass_mg_focal<span class="sc">-</span><span class="fu">mean</span>(DB_data_clean_M<span class="sc">$</span>Body_mass_mg_focal)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>DB_data_clean_M<span class="sc">$</span>stder_BM_focal<span class="ot">=</span>DB_data_clean_M<span class="sc">$</span>stder_BM_focal<span class="sc">/</span><span class="fu">sd</span>(DB_data_clean_M<span class="sc">$</span>Body_mass_mg_focal)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Model treatment</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>treat1M<span class="ot">=</span><span class="fu">glm</span>(m_RS<span class="sc">~</span>Gr_size<span class="sc">*</span>Area,<span class="at">data=</span>DB_data_clean_M,<span class="at">family =</span> quasipoisson)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>DB_data_clean_M<span class="sc">$</span>res_RS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>DB_data_clean_M<span class="sc">$</span>res_RS<span class="ot">=</span><span class="fu">residuals</span>(treat1M)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Males</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>p3<span class="ot">=</span><span class="fu">ggplot</span>(DB_data_clean_M, <span class="fu">aes</span>(<span class="at">x=</span>stder_BM_focal, <span class="at">y=</span>res_RS)) <span class="sc">+</span> </span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>)<span class="sc">+</span><span class="fu">xlab</span>(<span class="st">&#39;Standardized male body mass&#39;</span>)<span class="sc">+</span><span class="fu">ylab</span>(<span class="st">&#39;Res. offspring number&#39;</span>)<span class="sc">+</span><span class="fu">labs</span>(<span class="at">tag =</span> <span class="st">&quot;A&quot;</span>)<span class="sc">+</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span>lm,<span class="at">color=</span><span class="st">&quot;black&quot;</span>)<span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">13</span>),<span class="at">axis.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>)) <span class="sc">+</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),<span class="at">panel.background =</span> <span class="fu">element_blank</span>(), <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>))<span class="sc">+</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">3</span>,<span class="fl">2.3</span>)<span class="sc">+</span><span class="fu">ylim</span>(<span class="sc">-</span><span class="dv">13</span>,<span class="dv">23</span>)</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="co">#Females</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>DB_data_clean_F<span class="ot">=</span>DB_data_clean[DB_data_clean<span class="sc">$</span>Sex<span class="sc">==</span><span class="st">&#39;F&#39;</span>,]</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="co">#Standardize body mass</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>DB_data_clean_F<span class="sc">$</span>stder_BM_focal<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>DB_data_clean_F<span class="sc">$</span>stder_BM_focal<span class="ot">=</span>DB_data_clean_F<span class="sc">$</span>Body_mass_mg_focal<span class="sc">-</span><span class="fu">mean</span>(DB_data_clean_F<span class="sc">$</span>Body_mass_mg_focal)</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>DB_data_clean_F<span class="sc">$</span>stder_BM_focal<span class="ot">=</span>DB_data_clean_F<span class="sc">$</span>stder_BM_focal<span class="sc">/</span><span class="fu">sd</span>(DB_data_clean_F<span class="sc">$</span>Body_mass_mg_focal)</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a><span class="co">#Model treatment</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>treat1F<span class="ot">=</span><span class="fu">glm</span>(f_RS<span class="sc">~</span>Gr_size<span class="sc">*</span>Area,<span class="at">data=</span>DB_data_clean_F,<span class="at">family =</span> quasipoisson)</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>DB_data_clean_F<span class="sc">$</span>res_RS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>DB_data_clean_F<span class="sc">$</span>res_RS<span class="ot">=</span><span class="fu">residuals</span>(treat1F)</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>p4<span class="ot">=</span><span class="fu">ggplot</span>(DB_data_clean_F, <span class="fu">aes</span>(<span class="at">x=</span>stder_BM_focal, <span class="at">y=</span>res_RS)) <span class="sc">+</span> </span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>)<span class="sc">+</span><span class="fu">xlab</span>(<span class="st">&#39;Standardized female body mass&#39;</span>)<span class="sc">+</span><span class="fu">ylab</span>(<span class="st">&#39;Res. offspring number&#39;</span>)<span class="sc">+</span><span class="fu">labs</span>(<span class="at">tag =</span> <span class="st">&quot;B&quot;</span>)<span class="sc">+</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span>lm,<span class="at">color=</span><span class="st">&quot;black&quot;</span>)<span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">13</span>),<span class="at">axis.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>)) <span class="sc">+</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),<span class="at">panel.background =</span> <span class="fu">element_blank</span>(), <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>))<span class="sc">+</span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">3</span>,<span class="fl">2.3</span>)<span class="sc">+</span><span class="fu">ylim</span>(<span class="sc">-</span><span class="dv">13</span>,<span class="dv">23</span>)</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p3,p4, <span class="at">nrow =</span> <span class="dv">1</span>,<span class="at">ncol=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="figure/index4.Rmd/unnamed-chunk-2-1.png" width="960" style="display: block; margin: auto;" />
Figure 1: Scatter plots of relationship between standardized body mass
and residual offspring number for males (A) and females (B).<br><br>
Statistical tests<br> Selection gradient for males</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>mod2<span class="ot">=</span><span class="fu">glm</span>(res_RS<span class="sc">~</span>stder_BM_focal,<span class="at">data=</span>DB_data_clean_M,<span class="at">family =</span> gaussian)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod2)</span></code></pre></div>
<pre><code>
Call:
glm(formula = res_RS ~ stder_BM_focal, family = gaussian, data = DB_data_clean_M)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-11.5619   -6.7037    0.9734    5.1401   21.0961  

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)     -1.2364     0.7457  -1.658    0.101
stder_BM_focal   0.2772     0.7497   0.370    0.712

(Dispersion parameter for gaussian family taken to be 52.26889)

    Null deviance: 4815.9  on 93  degrees of freedom
Residual deviance: 4808.7  on 92  degrees of freedom
AIC: 642.64

Number of Fisher Scoring iterations: 2</code></pre>
<p>Selection gradient for females</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>mod3<span class="ot">=</span><span class="fu">glm</span>(res_RS<span class="sc">~</span>stder_BM_focal,<span class="at">data=</span>DB_data_clean_F,<span class="at">family =</span> gaussian)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod3)</span></code></pre></div>
<pre><code>
Call:
glm(formula = res_RS ~ stder_BM_focal, family = gaussian, data = DB_data_clean_F)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-12.479   -7.400    2.617    5.992   11.163  

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)     -1.3833     0.7826  -1.768   0.0809 .
stder_BM_focal   1.7184     0.7873   2.183   0.0320 *
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for gaussian family taken to be 50.83104)

    Null deviance: 4359.5  on 82  degrees of freedom
Residual deviance: 4117.3  on 81  degrees of freedom
AIC: 565.59

Number of Fisher Scoring iterations: 2</code></pre>
<p>Testing for a sex difference (sex x treatment interaction).</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>DB_data_clean_C<span class="ot">=</span><span class="fu">rbind</span>(DB_data_clean_F,DB_data_clean_M)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>mod4<span class="ot">=</span><span class="fu">glm</span>(res_RS<span class="sc">~</span>stder_BM_focal<span class="sc">*</span>Sex,<span class="at">data=</span>DB_data_clean_C,<span class="at">family =</span> gaussian)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod4)</span></code></pre></div>
<pre><code>
Call:
glm(formula = res_RS ~ stder_BM_focal * Sex, family = gaussian, 
    data = DB_data_clean_C)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-12.479   -7.188    1.359    5.697   21.096  

Coefficients:
                    Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)          -1.3833     0.7884  -1.754   0.0811 .
stder_BM_focal        1.7184     0.7932   2.166   0.0317 *
SexM                  0.1469     1.0819   0.136   0.8922  
stder_BM_focal:SexM  -1.4412     1.0881  -1.324   0.1871  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for gaussian family taken to be 51.59567)

    Null deviance: 9176.3  on 176  degrees of freedom
Residual deviance: 8926.1  on 173  degrees of freedom
AIC: 1206.2

Number of Fisher Scoring iterations: 2</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Anova(mod4,type=3) #If the interactions are not significant, type II gives a more powerful test.</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(mod4,<span class="at">type=</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>Analysis of Deviance Table (Type II tests)

Response: res_RS
                   LR Chisq Df Pr(&gt;Chisq)  
stder_BM_focal      3.07742  1    0.07939 .
Sex                 0.01843  1    0.89201  
stder_BM_focal:Sex  1.75426  1    0.18534  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="effect-of-body-mass-on-reproductive-behaviour"
class="section level1">
<h1>Effect of body mass on reproductive behaviour</h1>
<p>Correlation between body mass and reproductive behaviour:<br> -
Number of matings<br> - Number of mating partners (mating success)<br> -
Proportion of successful matings<br></p>
<div id="number-of-matings" class="section level2">
<h2>Number of matings</h2>
<p>Correlation between body mass and the number of matings.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Effect of body mass on mating number ####</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Males</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>DB_data_M<span class="ot">=</span>DB_data[DB_data<span class="sc">$</span>Sex<span class="sc">==</span><span class="st">&#39;M&#39;</span>,]</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Standardize body mass</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>DB_data_M<span class="sc">$</span>stder_BM_focal<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>DB_data_M<span class="sc">$</span>stder_BM_focal<span class="ot">=</span>DB_data_M<span class="sc">$</span>Body_mass_mg_focal<span class="sc">-</span><span class="fu">mean</span>(DB_data_M<span class="sc">$</span>Body_mass_mg_focal)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>DB_data_M<span class="sc">$</span>stder_BM_focal<span class="ot">=</span>DB_data_M<span class="sc">$</span>stder_BM_focal<span class="sc">/</span><span class="fu">sd</span>(DB_data_M<span class="sc">$</span>Body_mass_mg_focal)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Model treatment</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>treat1M_MR<span class="ot">=</span><span class="fu">glm</span>(m_TotMatings<span class="sc">~</span>Gr_size<span class="sc">*</span>Area,<span class="at">data=</span>DB_data_M,<span class="at">family =</span> quasipoisson)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>DB_data_M<span class="sc">$</span>res_MR<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>DB_data_M<span class="sc">$</span>res_MR<span class="ot">=</span><span class="fu">residuals</span>(treat1M_MR)</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>p5<span class="ot">=</span><span class="fu">ggplot</span>(DB_data_M, <span class="fu">aes</span>(<span class="at">x=</span>stder_BM_focal, <span class="at">y=</span>res_MR)) <span class="sc">+</span> </span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>)<span class="sc">+</span><span class="fu">xlab</span>(<span class="st">&#39;Standardized male body mass&#39;</span>)<span class="sc">+</span><span class="fu">ylab</span>(<span class="st">&#39;Res. number of matings&#39;</span>)<span class="sc">+</span><span class="fu">labs</span>(<span class="at">tag =</span> <span class="st">&quot;A&quot;</span>)<span class="sc">+</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span>lm,<span class="at">color=</span><span class="st">&quot;black&quot;</span>)<span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">13</span>),<span class="at">axis.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>)) <span class="sc">+</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),<span class="at">panel.background =</span> <span class="fu">element_blank</span>(), <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>))<span class="sc">+</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="fl">3.1</span>,<span class="fl">2.4</span>)<span class="sc">+</span><span class="fu">ylim</span>(<span class="sc">-</span><span class="fl">2.7</span>,<span class="fl">4.2</span>)</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a><span class="co">#Females</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>DB_data_F<span class="ot">=</span>DB_data[DB_data<span class="sc">$</span>Sex<span class="sc">==</span><span class="st">&#39;F&#39;</span>,]</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a><span class="co">#Standardize body mass</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>DB_data_F<span class="sc">$</span>stder_BM_focal<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>DB_data_F<span class="sc">$</span>stder_BM_focal<span class="ot">=</span>DB_data_F<span class="sc">$</span>Body_mass_mg_focal<span class="sc">-</span><span class="fu">mean</span>(DB_data_F<span class="sc">$</span>Body_mass_mg_focal)</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>DB_data_F<span class="sc">$</span>stder_BM_focal<span class="ot">=</span>DB_data_F<span class="sc">$</span>stder_BM_focal<span class="sc">/</span><span class="fu">sd</span>(DB_data_F<span class="sc">$</span>Body_mass_mg_focal)</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a><span class="co">#Model treatment</span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>treat1F_MR<span class="ot">=</span><span class="fu">glm</span>(f_TotMatings<span class="sc">~</span>Gr_size<span class="sc">*</span>Area,<span class="at">data=</span>DB_data_F,<span class="at">family =</span> quasipoisson)</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>DB_data_F<span class="sc">$</span>res_MR<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>DB_data_F<span class="sc">$</span>res_MR<span class="ot">=</span><span class="fu">residuals</span>(treat1F_MR)</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>p6<span class="ot">=</span><span class="fu">ggplot</span>(DB_data_F, <span class="fu">aes</span>(<span class="at">x=</span>stder_BM_focal, <span class="at">y=</span>res_MR)) <span class="sc">+</span> </span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>)<span class="sc">+</span><span class="fu">xlab</span>(<span class="st">&#39;Standardized female body mass&#39;</span>)<span class="sc">+</span><span class="fu">ylab</span>(<span class="st">&#39;Res. number of matings&#39;</span>)<span class="sc">+</span><span class="fu">labs</span>(<span class="at">tag =</span> <span class="st">&quot;B&quot;</span>)<span class="sc">+</span></span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span>lm,<span class="at">color=</span><span class="st">&quot;black&quot;</span>)<span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">13</span>),<span class="at">axis.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>)) <span class="sc">+</span></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),<span class="at">panel.background =</span> <span class="fu">element_blank</span>(), <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>))<span class="sc">+</span></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="fl">3.1</span>,<span class="fl">2.4</span>)<span class="sc">+</span><span class="fu">ylim</span>(<span class="sc">-</span><span class="fl">2.7</span>,<span class="fl">4.2</span>)</span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p5,p6, <span class="at">nrow =</span> <span class="dv">1</span>,<span class="at">ncol=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="figure/index4.Rmd/unnamed-chunk-6-1.png" width="960" style="display: block; margin: auto;" />
Figure 2: Scatter plots of relationship between standardized body mass
and residual number of matings for males (A) and females (B).<br><br>
Statistical tests<br> Males</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>mod5<span class="ot">=</span><span class="fu">glm</span>(res_MR<span class="sc">~</span>stder_BM_focal,<span class="at">data=</span>DB_data_M,<span class="at">family =</span> gaussian)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod5)</span></code></pre></div>
<pre><code>
Call:
glm(formula = res_MR ~ stder_BM_focal, family = gaussian, data = DB_data_M)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.4957  -0.7416  -0.0996   0.5039   3.0823  

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)    -0.09342    0.07977  -1.171    0.243
stder_BM_focal -0.08999    0.08004  -1.124    0.263

(Dispersion parameter for gaussian family taken to be 0.9418522)

    Null deviance: 138.70  on 147  degrees of freedom
Residual deviance: 137.51  on 146  degrees of freedom
AIC: 415.13

Number of Fisher Scoring iterations: 2</code></pre>
<p>Females</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>mod6<span class="ot">=</span><span class="fu">glm</span>(res_MR<span class="sc">~</span>stder_BM_focal,<span class="at">data=</span>DB_data_F,<span class="at">family =</span> gaussian)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod6)</span></code></pre></div>
<pre><code>
Call:
glm(formula = res_MR ~ stder_BM_focal, family = gaussian, data = DB_data_F)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.6308  -0.8157  -0.1462   0.4894   3.8638  

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)    -0.11468    0.09579  -1.197    0.233
stder_BM_focal  0.13139    0.09617   1.366    0.174

(Dispersion parameter for gaussian family taken to be 1.192956)

    Null deviance: 154.93  on 129  degrees of freedom
Residual deviance: 152.70  on 128  degrees of freedom
AIC: 395.84

Number of Fisher Scoring iterations: 2</code></pre>
<p>Testing for a sex difference (sex x treatment interaction).</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Sex difference?</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>DB_data_clean_C<span class="ot">=</span><span class="fu">rbind</span>(DB_data_F,DB_data_M)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>mod4<span class="ot">=</span><span class="fu">glm</span>(res_MR<span class="sc">~</span>stder_BM_focal<span class="sc">*</span>Sex,<span class="at">data=</span>DB_data_clean_C,<span class="at">family =</span> gaussian)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod4)</span></code></pre></div>
<pre><code>
Call:
glm(formula = res_MR ~ stder_BM_focal * Sex, family = gaussian, 
    data = DB_data_clean_C)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.6308  -0.7629  -0.1142   0.5141   3.8638  

Coefficients:
                    Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)         -0.11468    0.09026  -1.271   0.2050  
stder_BM_focal       0.13139    0.09061   1.450   0.1482  
SexM                 0.02126    0.12371   0.172   0.8637  
stder_BM_focal:SexM -0.22138    0.12416  -1.783   0.0757 .
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for gaussian family taken to be 1.059156)

    Null deviance: 293.66  on 277  degrees of freedom
Residual deviance: 290.21  on 274  degrees of freedom
AIC: 810.88

Number of Fisher Scoring iterations: 2</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(mod4,<span class="at">type=</span><span class="dv">3</span>) <span class="co">#If the interactions are not significant, type II gives a more powerful test.</span></span></code></pre></div>
<pre><code>Analysis of Deviance Table (Type III tests)

Response: res_MR
                   LR Chisq Df Pr(&gt;Chisq)  
stder_BM_focal       2.1025  1    0.14706  
Sex                  0.0295  1    0.86356  
stder_BM_focal:Sex   3.1792  1    0.07458 .
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Anova(mod4,type=2)</span></span></code></pre></div>
</div>
<div id="number-of-mating-partners" class="section level2">
<h2>Number of mating partners</h2>
<p>Correlation between body mass and the number of mating partners.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Effect of body mass on mating success ####</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Males</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Model treatment</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>treat1M_MS<span class="ot">=</span><span class="fu">glm</span>(m_cMS<span class="sc">~</span>Gr_size<span class="sc">*</span>Area,<span class="at">data=</span>DB_data_M,<span class="at">family =</span> quasipoisson)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>DB_data_M<span class="sc">$</span>res_MS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>DB_data_M<span class="sc">$</span>res_MS<span class="ot">=</span><span class="fu">residuals</span>(treat1M_MS)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>p7<span class="ot">=</span><span class="fu">ggplot</span>(DB_data_M, <span class="fu">aes</span>(<span class="at">x=</span>stder_BM_focal, <span class="at">y=</span>res_MS)) <span class="sc">+</span> </span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>)<span class="sc">+</span><span class="fu">xlab</span>(<span class="st">&#39;Standardized male body mass&#39;</span>)<span class="sc">+</span><span class="fu">ylab</span>(<span class="st">&#39;Res. number of mating partners&#39;</span>)<span class="sc">+</span><span class="fu">labs</span>(<span class="at">tag =</span> <span class="st">&quot;A&quot;</span>)<span class="sc">+</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span>lm,<span class="at">color=</span><span class="st">&quot;black&quot;</span>)<span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">13</span>),<span class="at">axis.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>)) <span class="sc">+</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),<span class="at">panel.background =</span> <span class="fu">element_blank</span>(), <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>))<span class="sc">+</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="fl">3.1</span>,<span class="fl">2.4</span>)<span class="sc">+</span><span class="fu">ylim</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="fl">2.5</span>)</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="co">#Females</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="co">#Model treatment</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>treat1F_MS<span class="ot">=</span><span class="fu">glm</span>(f_cMS<span class="sc">~</span>Gr_size<span class="sc">*</span>Area,<span class="at">data=</span>DB_data_F,<span class="at">family =</span> quasipoisson)</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>DB_data_F<span class="sc">$</span>res_MS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>DB_data_F<span class="sc">$</span>res_MS<span class="ot">=</span><span class="fu">residuals</span>(treat1F_MS)</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>p8<span class="ot">=</span><span class="fu">ggplot</span>(DB_data_F, <span class="fu">aes</span>(<span class="at">x=</span>stder_BM_focal, <span class="at">y=</span>res_MS)) <span class="sc">+</span> </span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>)<span class="sc">+</span><span class="fu">xlab</span>(<span class="st">&#39;Standardized female body mass&#39;</span>)<span class="sc">+</span><span class="fu">ylab</span>(<span class="st">&#39;Res. number of mating partners&#39;</span>)<span class="sc">+</span><span class="fu">labs</span>(<span class="at">tag =</span> <span class="st">&quot;B&quot;</span>)<span class="sc">+</span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span>lm,<span class="at">color=</span><span class="st">&quot;black&quot;</span>)<span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">13</span>),<span class="at">axis.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>)) <span class="sc">+</span></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),<span class="at">panel.background =</span> <span class="fu">element_blank</span>(), <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>))<span class="sc">+</span></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="fl">3.1</span>,<span class="fl">2.4</span>)<span class="sc">+</span><span class="fu">ylim</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="fl">2.5</span>)</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p7,p8, <span class="at">nrow =</span> <span class="dv">1</span>,<span class="at">ncol=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="figure/index4.Rmd/unnamed-chunk-10-1.png" width="960" style="display: block; margin: auto;" />
Figure 3: Scatter plots of relationship between standardized body mass
and residual number of mating partners for males (A) and females
(B).<br><br> Statistical tests<br> Males</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>mod7<span class="ot">=</span><span class="fu">glm</span>(res_MS<span class="sc">~</span>stder_BM_focal,<span class="at">data=</span>DB_data_M,<span class="at">family =</span> gaussian)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod7)</span></code></pre></div>
<pre><code>
Call:
glm(formula = res_MS ~ stder_BM_focal, family = gaussian, data = DB_data_M)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-1.00809  -0.50217   0.06056   0.30451   2.05489  

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)    -0.04299    0.04770  -0.901  0.36888   
stder_BM_focal -0.12517    0.04786  -2.615  0.00985 **
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for gaussian family taken to be 0.3367239)

    Null deviance: 51.465  on 147  degrees of freedom
Residual deviance: 49.162  on 146  degrees of freedom
AIC: 262.9

Number of Fisher Scoring iterations: 2</code></pre>
<p>Females</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>mod7<span class="ot">=</span><span class="fu">glm</span>(res_MS<span class="sc">~</span>stder_BM_focal,<span class="at">data=</span>DB_data_F,<span class="at">family =</span> gaussian)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod7)</span></code></pre></div>
<pre><code>
Call:
glm(formula = res_MS ~ stder_BM_focal, family = gaussian, data = DB_data_F)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-0.92287  -0.59400   0.05225   0.40061   1.82309  

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)    -0.04305    0.05237  -0.822    0.413
stder_BM_focal  0.07770    0.05257   1.478    0.142

(Dispersion parameter for gaussian family taken to be 0.3564838)

    Null deviance: 46.409  on 129  degrees of freedom
Residual deviance: 45.630  on 128  degrees of freedom
AIC: 238.82

Number of Fisher Scoring iterations: 2</code></pre>
<p>Testing for a sex difference (sex x treatment interaction).</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Sex difference?</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>DB_data_clean_C<span class="ot">=</span><span class="fu">rbind</span>(DB_data_F,DB_data_M)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>mod4<span class="ot">=</span><span class="fu">glm</span>(res_MS<span class="sc">~</span>stder_BM_focal<span class="sc">*</span>Sex,<span class="at">data=</span>DB_data_clean_C,<span class="at">family =</span> gaussian)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod4)</span></code></pre></div>
<pre><code>
Call:
glm(formula = res_MS ~ stder_BM_focal * Sex, family = gaussian, 
    data = DB_data_clean_C)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-1.00809  -0.53221   0.05423   0.33212   2.05489  

Coefficients:
                      Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)         -4.305e-02  5.159e-02  -0.835  0.40468   
stder_BM_focal       7.770e-02  5.179e-02   1.500  0.13467   
SexM                 5.968e-05  7.070e-02   0.001  0.99933   
stder_BM_focal:SexM -2.029e-01  7.096e-02  -2.859  0.00458 **
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for gaussian family taken to be 0.3459548)

    Null deviance: 97.873  on 277  degrees of freedom
Residual deviance: 94.792  on 274  degrees of freedom
AIC: 499.82

Number of Fisher Scoring iterations: 2</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Anova(mod4,type=3) #If the interactions are not significant, type II gives a more powerful test.</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(mod4,<span class="at">type=</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>Analysis of Deviance Table (Type II tests)

Response: res_MS
                   LR Chisq Df Pr(&gt;Chisq)   
stder_BM_focal       0.7348  1   0.391320   
Sex                  0.0000  1   0.999326   
stder_BM_focal:Sex   8.1734  1   0.004251 **
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="proportion-of-successful-matings" class="section level2">
<h2>Proportion of successful matings</h2>
<p>Correlation between body mass and the proportion of successful
matings.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Effect of BM on proportion successful matings ####</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Males</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Model treatment</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>treat1M_Prop_MS<span class="ot">=</span><span class="fu">glm</span>(Prop_MS<span class="sc">~</span>Gr_size<span class="sc">*</span>Area,<span class="at">data=</span>DB_data_M,<span class="at">family =</span> quasibinomial,<span class="at">na.action=</span>na.exclude)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>DB_data_M<span class="sc">$</span>res_Prop_MS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>DB_data_M<span class="sc">$</span>res_Prop_MS<span class="ot">=</span><span class="fu">residuals</span>(treat1M_Prop_MS)</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>p9<span class="ot">=</span><span class="fu">ggplot</span>(DB_data_M, <span class="fu">aes</span>(<span class="at">x=</span>stder_BM_focal, <span class="at">y=</span>res_Prop_MS)) <span class="sc">+</span> </span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>)<span class="sc">+</span><span class="fu">xlab</span>(<span class="st">&#39;Standardized male body mass&#39;</span>)<span class="sc">+</span><span class="fu">ylab</span>(<span class="st">&#39;Res. prop. of successful matings&#39;</span>)<span class="sc">+</span><span class="fu">labs</span>(<span class="at">tag =</span> <span class="st">&quot;A&quot;</span>)<span class="sc">+</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span>lm,<span class="at">color=</span><span class="st">&quot;black&quot;</span>)<span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">13</span>),<span class="at">axis.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>)) <span class="sc">+</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),<span class="at">panel.background =</span> <span class="fu">element_blank</span>(), <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>))<span class="sc">+</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="fl">3.1</span>,<span class="fl">2.4</span>)<span class="sc">+</span><span class="fu">ylim</span>(<span class="sc">-</span><span class="fl">0.8</span>,<span class="fl">1.6</span>)</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a><span class="co">#Females</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a><span class="co">#Model treatment</span></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>treat1F_Prop_MS<span class="ot">=</span><span class="fu">glm</span>(Prop_MS<span class="sc">~</span>Gr_size<span class="sc">*</span>Area,<span class="at">data=</span>DB_data_F,<span class="at">family =</span> quasibinomial,<span class="at">na.action=</span>na.exclude)</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>DB_data_F<span class="sc">$</span>res_Prop_MS<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>DB_data_F<span class="sc">$</span>res_Prop_MS<span class="ot">=</span><span class="fu">residuals</span>(treat1F_Prop_MS)</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>p10<span class="ot">=</span><span class="fu">ggplot</span>(DB_data_F, <span class="fu">aes</span>(<span class="at">x=</span>stder_BM_focal, <span class="at">y=</span>res_Prop_MS)) <span class="sc">+</span> </span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>)<span class="sc">+</span><span class="fu">xlab</span>(<span class="st">&#39;Standardized female body mass&#39;</span>)<span class="sc">+</span><span class="fu">ylab</span>(<span class="st">&#39;Res. prop. of successful matings&#39;</span>)<span class="sc">+</span><span class="fu">labs</span>(<span class="at">tag =</span> <span class="st">&quot;B&quot;</span>)<span class="sc">+</span></span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span>lm,<span class="at">color=</span><span class="st">&quot;black&quot;</span>)<span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">13</span>),<span class="at">axis.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>)) <span class="sc">+</span></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),<span class="at">panel.background =</span> <span class="fu">element_blank</span>(), <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>))<span class="sc">+</span></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="fl">3.1</span>,<span class="fl">2.4</span>)<span class="sc">+</span><span class="fu">ylim</span>(<span class="sc">-</span><span class="fl">0.8</span>,<span class="fl">1.6</span>)</span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p9,p10, <span class="at">nrow =</span> <span class="dv">1</span>,<span class="at">ncol=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="figure/index4.Rmd/unnamed-chunk-14-1.png" width="960" style="display: block; margin: auto;" />
Figure 4: Scatter plots of relationship between standardized body mass
and residual proportion of successful matings for males (A) and females
(B).<br><br> Statistical tests<br> Males</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>mod7<span class="ot">=</span><span class="fu">glm</span>(res_Prop_MS<span class="sc">~</span>stder_BM_focal,<span class="at">data=</span>DB_data_M,<span class="at">family =</span> gaussian)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod7)</span></code></pre></div>
<pre><code>
Call:
glm(formula = res_Prop_MS ~ stder_BM_focal, family = gaussian, 
    data = DB_data_M)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-0.68186  -0.27630  -0.04741   0.22588   1.43708  

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)    -0.01380    0.03206  -0.430    0.668
stder_BM_focal -0.03420    0.03217  -1.063    0.290

(Dispersion parameter for gaussian family taken to be 0.1521604)

    Null deviance: 22.387  on 147  degrees of freedom
Residual deviance: 22.215  on 146  degrees of freedom
AIC: 145.33

Number of Fisher Scoring iterations: 2</code></pre>
<p>Females</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>mod7<span class="ot">=</span><span class="fu">glm</span>(res_Prop_MS<span class="sc">~</span>stder_BM_focal,<span class="at">data=</span>DB_data_F,<span class="at">family =</span> gaussian)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod7)</span></code></pre></div>
<pre><code>
Call:
glm(formula = res_Prop_MS ~ stder_BM_focal, family = gaussian, 
    data = DB_data_F)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-0.73785  -0.35714  -0.07916   0.23794   1.49479  

Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)    -0.007106   0.041641  -0.171    0.865
stder_BM_focal -0.029418   0.041802  -0.704    0.483

(Dispersion parameter for gaussian family taken to be 0.2254128)

    Null deviance: 28.964  on 129  degrees of freedom
Residual deviance: 28.853  on 128  degrees of freedom
AIC: 179.23

Number of Fisher Scoring iterations: 2</code></pre>
<p>Testing for a sex difference (sex x treatment interaction).</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Sex difference?</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>DB_data_clean_C<span class="ot">=</span><span class="fu">rbind</span>(DB_data_F,DB_data_M)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>mod4<span class="ot">=</span><span class="fu">glm</span>(res_Prop_MS<span class="sc">~</span>stder_BM_focal<span class="sc">*</span>Sex,<span class="at">data=</span>DB_data_clean_C,<span class="at">family =</span> gaussian)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod4)</span></code></pre></div>
<pre><code>
Call:
glm(formula = res_Prop_MS ~ stder_BM_focal * Sex, family = gaussian, 
    data = DB_data_clean_C)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.7379  -0.3174  -0.0581   0.2367   1.4948  

Coefficients:
                     Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)         -0.007106   0.037864  -0.188    0.851
stder_BM_focal      -0.029418   0.038011  -0.774    0.440
SexM                -0.006693   0.051894  -0.129    0.897
stder_BM_focal:SexM -0.004779   0.052084  -0.092    0.927

(Dispersion parameter for gaussian family taken to be 0.1863805)

    Null deviance: 51.355  on 277  degrees of freedom
Residual deviance: 51.068  on 274  degrees of freedom
AIC: 327.87

Number of Fisher Scoring iterations: 2</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Anova(mod4,type=3) #If the interactions are not significant, type II gives a more powerful test.</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(mod4,<span class="at">type=</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>Analysis of Deviance Table (Type II tests)

Response: res_Prop_MS
                   LR Chisq Df Pr(&gt;Chisq)
stder_BM_focal      1.51294  1     0.2187
Sex                 0.01664  1     0.8974
stder_BM_focal:Sex  0.00842  1     0.9269</code></pre>
</div>
</div>
<div id="density-treatment-and-body-mass" class="section level1">
<h1>Density treatment and body mass</h1>
<p>Here we tested the interaction of the density treatment and body
mass. ## Reproductive success Males</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Males</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Model treatment</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>ModT1<span class="ot">=</span><span class="fu">glm</span>(m_RS<span class="sc">~</span>stder_BM_focal<span class="sc">*</span>Gr_size<span class="sc">*</span>Area,<span class="at">data=</span>DB_data_clean_M,<span class="at">family =</span> quasipoisson)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ModT1)</span></code></pre></div>
<pre><code>
Call:
glm(formula = m_RS ~ stder_BM_focal * Gr_size * Area, family = quasipoisson, 
    data = DB_data_clean_M)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-13.1783   -7.5980   -0.5555    4.2488   19.1579  

Coefficients:
                                    Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                         3.954040   0.272154  14.529   &lt;2e-16 ***
stder_BM_focal                     -0.177449   0.268124  -0.662    0.510    
Gr_sizeLG                          -0.001700   0.334625  -0.005    0.996    
AreaSmall                           0.388076   0.315040   1.232    0.221    
stder_BM_focal:Gr_sizeLG            0.373144   0.321645   1.160    0.249    
stder_BM_focal:AreaSmall           -0.003027   0.311340  -0.010    0.992    
Gr_sizeLG:AreaSmall                -0.316841   0.429240  -0.738    0.462    
stder_BM_focal:Gr_sizeLG:AreaSmall -0.057911   0.428434  -0.135    0.893    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for quasipoisson family taken to be 48.00628)

    Null deviance: 5078.4  on 93  degrees of freedom
Residual deviance: 4801.4  on 86  degrees of freedom
AIC: NA

Number of Fisher Scoring iterations: 6</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Anova(ModT1,type=3) #If the interactions are not significant, type II gives a more powerful test.</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(ModT1,<span class="at">type=</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>Analysis of Deviance Table (Type II tests)

Response: m_RS
                            LR Chisq Df Pr(&gt;Chisq)
stder_BM_focal               0.00516  1     0.9428
Gr_size                      1.55068  1     0.2130
Area                         1.41358  1     0.2345
stder_BM_focal:Gr_size       2.64055  1     0.1042
stder_BM_focal:Area          0.02462  1     0.8753
Gr_size:Area                 0.53760  1     0.4634
stder_BM_focal:Gr_size:Area  0.01831  1     0.8924</code></pre>
<p>Females</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Females</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Model treatment</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>ModT2<span class="ot">=</span><span class="fu">glm</span>(f_RS<span class="sc">~</span>stder_BM_focal<span class="sc">*</span>Gr_size<span class="sc">*</span>Area,<span class="at">data=</span>DB_data_clean_F,<span class="at">family =</span> quasipoisson)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ModT2)</span></code></pre></div>
<pre><code>
Call:
glm(formula = f_RS ~ stder_BM_focal * Gr_size * Area, family = quasipoisson, 
    data = DB_data_clean_F)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-13.7556   -9.2530    0.4482    4.4361    8.7849  

Coefficients:
                                    Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                         4.126806   0.148440  27.801   &lt;2e-16 ***
stder_BM_focal                      0.005908   0.163105   0.036    0.971    
Gr_sizeLG                          -0.214517   0.274951  -0.780    0.438    
AreaSmall                          -0.245157   0.257992  -0.950    0.345    
stder_BM_focal:Gr_sizeLG            0.393885   0.280492   1.404    0.164    
stder_BM_focal:AreaSmall            0.116191   0.263713   0.441    0.661    
Gr_sizeLG:AreaSmall                 0.513361   0.397955   1.290    0.201    
stder_BM_focal:Gr_sizeLG:AreaSmall -0.144470   0.403540  -0.358    0.721    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for quasipoisson family taken to be 40.81761)

    Null deviance: 4614.9  on 82  degrees of freedom
Residual deviance: 4213.6  on 75  degrees of freedom
AIC: NA

Number of Fisher Scoring iterations: 6</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Anova(ModT2,type=3) #If the interactions are not significant, type II gives a more powerful test.</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(ModT2,<span class="at">type=</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>Analysis of Deviance Table (Type II tests)

Response: f_RS
                            LR Chisq Df Pr(&gt;Chisq)  
stder_BM_focal                4.3187  1     0.0377 *
Gr_size                       0.2370  1     0.6264  
Area                          0.0075  1     0.9309  
stder_BM_focal:Gr_size        2.6569  1     0.1031  
stder_BM_focal:Area           0.0753  1     0.7838  
Gr_size:Area                  1.5655  1     0.2109  
stder_BM_focal:Gr_size:Area   0.1280  1     0.7205  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div id="number-of-matings-1" class="section level2">
<h2>Number of matings</h2>
<p>Males</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Males</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Model treatment</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>ModT1<span class="ot">=</span><span class="fu">glm</span>(m_TotMatings<span class="sc">~</span>stder_BM_focal<span class="sc">*</span>Gr_size<span class="sc">*</span>Area,<span class="at">data=</span>DB_data_M,<span class="at">family =</span> quasipoisson)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ModT1)</span></code></pre></div>
<pre><code>
Call:
glm(formula = m_TotMatings ~ stder_BM_focal * Gr_size * Area, 
    family = quasipoisson, data = DB_data_M)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.6856  -0.8063  -0.2506   0.4052   3.0341  

Coefficients:
                                   Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                         1.09422    0.11439   9.566   &lt;2e-16 ***
stder_BM_focal                     -0.20788    0.12467  -1.667   0.0977 .  
Gr_sizeLG                          -0.22437    0.15426  -1.454   0.1480    
AreaSmall                           0.06663    0.14561   0.458   0.6479    
stder_BM_focal:Gr_sizeLG            0.05993    0.15728   0.381   0.7037    
stder_BM_focal:AreaSmall            0.31593    0.16132   1.958   0.0522 .  
Gr_sizeLG:AreaSmall                -0.06739    0.21653  -0.311   0.7561    
stder_BM_focal:Gr_sizeLG:AreaSmall -0.17206    0.21930  -0.785   0.4340    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for quasipoisson family taken to be 1.051652)

    Null deviance: 150.57  on 147  degrees of freedom
Residual deviance: 133.32  on 140  degrees of freedom
AIC: NA

Number of Fisher Scoring iterations: 5</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Anova(ModT1,type=3) #If the interactions are not significant, type II gives a more powerful test.</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(ModT1,<span class="at">type=</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>Analysis of Deviance Table (Type II tests)

Response: m_TotMatings
                            LR Chisq Df Pr(&gt;Chisq)  
stder_BM_focal                1.0748  1    0.29986  
Gr_size                       6.0960  1    0.01355 *
Area                          0.0001  1    0.99236  
stder_BM_focal:Gr_size        0.0666  1    0.79642  
stder_BM_focal:Area           4.2526  1    0.03919 *
Gr_size:Area                  0.0425  1    0.83660  
stder_BM_focal:Gr_size:Area   0.6175  1    0.43197  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Females</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Females</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Model treatment</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>ModT2<span class="ot">=</span><span class="fu">glm</span>(f_TotMatings<span class="sc">~</span>stder_BM_focal<span class="sc">*</span>Gr_size<span class="sc">*</span>Area,<span class="at">data=</span>DB_data_F,<span class="at">family =</span> quasipoisson)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ModT2)</span></code></pre></div>
<pre><code>
Call:
glm(formula = f_TotMatings ~ stder_BM_focal * Gr_size * Area, 
    family = quasipoisson, data = DB_data_F)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.7480  -0.9280  -0.2440   0.4159   3.6835  

Coefficients:
                                   Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                         1.23525    0.09436  13.091   &lt;2e-16 ***
stder_BM_focal                      0.08867    0.10032   0.884   0.3785    
Gr_sizeLG                          -0.35397    0.18324  -1.932   0.0557 .  
AreaSmall                          -0.20627    0.15982  -1.291   0.1993    
stder_BM_focal:Gr_sizeLG            0.05581    0.19450   0.287   0.7746    
stder_BM_focal:AreaSmall           -0.11075    0.15319  -0.723   0.4711    
Gr_sizeLG:AreaSmall                 0.26686    0.26558   1.005   0.3170    
stder_BM_focal:Gr_sizeLG:AreaSmall  0.08007    0.26841   0.298   0.7660    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for quasipoisson family taken to be 1.422673)

    Null deviance: 164.51  on 129  degrees of freedom
Residual deviance: 153.48  on 122  degrees of freedom
AIC: NA

Number of Fisher Scoring iterations: 5</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Anova(ModT2,type=3) #If the interactions are not significant, type II gives a more powerful test.</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(ModT2,<span class="at">type=</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>Analysis of Deviance Table (Type II tests)

Response: f_TotMatings
                            LR Chisq Df Pr(&gt;Chisq)  
stder_BM_focal               1.25493  1    0.26261  
Gr_size                      2.98878  1    0.08384 .
Area                         0.77665  1    0.37817  
stder_BM_focal:Gr_size       0.54131  1    0.46189  
stder_BM_focal:Area          0.45100  1    0.50186  
Gr_size:Area                 1.07549  1    0.29971  
stder_BM_focal:Gr_size:Area  0.08906  1    0.76538  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="number-of-mating-partners-1" class="section level2">
<h2>Number of mating partners</h2>
<p>Males</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Males</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Model treatment</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>ModT1<span class="ot">=</span><span class="fu">glm</span>(m_cMS<span class="sc">~</span>stder_BM_focal<span class="sc">*</span>Gr_size<span class="sc">*</span>Area,<span class="at">data=</span>DB_data_M,<span class="at">family =</span> quasipoisson)</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ModT1)</span></code></pre></div>
<pre><code>
Call:
glm(formula = m_cMS ~ stder_BM_focal * Gr_size * Area, family = quasipoisson, 
    data = DB_data_M)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-1.18216  -0.57583   0.02865   0.22827   2.04740  

Coefficients:
                                    Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                         0.544710   0.087909   6.196 6.07e-09 ***
stder_BM_focal                     -0.147473   0.096691  -1.525    0.129    
Gr_sizeLG                           0.106417   0.111159   0.957    0.340    
AreaSmall                          -0.009379   0.113832  -0.082    0.934    
stder_BM_focal:Gr_sizeLG           -0.011657   0.115438  -0.101    0.920    
stder_BM_focal:AreaSmall            0.133668   0.125906   1.062    0.290    
Gr_sizeLG:AreaSmall                -0.013674   0.155859  -0.088    0.930    
stder_BM_focal:Gr_sizeLG:AreaSmall -0.031775   0.159260  -0.200    0.842    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for quasipoisson family taken to be 0.3658209)

    Null deviance: 52.151  on 147  degrees of freedom
Residual deviance: 48.348  on 140  degrees of freedom
AIC: NA

Number of Fisher Scoring iterations: 4</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Anova(ModT1,type=3) #If the interactions are not significant, type II gives a more powerful test.</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(ModT1,<span class="at">type=</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>Analysis of Deviance Table (Type II tests)

Response: m_cMS
                            LR Chisq Df Pr(&gt;Chisq)   
stder_BM_focal                6.6646  1   0.009835 **
Gr_size                       1.8376  1   0.175235   
Area                          0.2239  1   0.636070   
stder_BM_focal:Gr_size        0.1272  1   0.721336   
stder_BM_focal:Area           2.1917  1   0.138760   
Gr_size:Area                  0.0028  1   0.957900   
stder_BM_focal:Gr_size:Area   0.0398  1   0.841791   
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Females</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Females</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Model treatment</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>ModT2<span class="ot">=</span><span class="fu">glm</span>(f_cMS<span class="sc">~</span>stder_BM_focal<span class="sc">*</span>Gr_size<span class="sc">*</span>Area,<span class="at">data=</span>DB_data_F,<span class="at">family =</span> quasipoisson)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ModT2)</span></code></pre></div>
<pre><code>
Call:
glm(formula = f_cMS ~ stder_BM_focal * Gr_size * Area, family = quasipoisson, 
    data = DB_data_F)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.9720  -0.5585   0.0150   0.3221   1.6148  

Coefficients:
                                    Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                         0.680000   0.063680  10.678   &lt;2e-16 ***
stder_BM_focal                      0.034497   0.068790   0.501   0.6169    
Gr_sizeLG                          -0.031422   0.110661  -0.284   0.7769    
AreaSmall                          -0.199312   0.107617  -1.852   0.0664 .  
stder_BM_focal:Gr_sizeLG            0.121678   0.118143   1.030   0.3051    
stder_BM_focal:AreaSmall           -0.009005   0.104373  -0.086   0.9314    
Gr_sizeLG:AreaSmall                 0.304409   0.161742   1.882   0.0622 .  
stder_BM_focal:Gr_sizeLG:AreaSmall -0.077820   0.162781  -0.478   0.6335    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for quasipoisson family taken to be 0.3739008)

    Null deviance: 49.041  on 129  degrees of freedom
Residual deviance: 45.228  on 122  degrees of freedom
AIC: NA

Number of Fisher Scoring iterations: 4</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Anova(ModT2,type=3) #If the interactions are not significant, type II gives a more powerful test.</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(ModT2,<span class="at">type=</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>Analysis of Deviance Table (Type II tests)

Response: f_cMS
                            LR Chisq Df Pr(&gt;Chisq)  
stder_BM_focal                2.4484  1    0.11764  
Gr_size                       2.0816  1    0.14908  
Area                          0.7566  1    0.38439  
stder_BM_focal:Gr_size        0.9924  1    0.31916  
stder_BM_focal:Area           0.2609  1    0.60948  
Gr_size:Area                  3.4738  1    0.06235 .
stder_BM_focal:Gr_size:Area   0.2285  1    0.63263  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="proportion-of-successful-matings-1" class="section level2">
<h2>Proportion of successful matings</h2>
<p>Males</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Males</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Model treatment</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>ModT1<span class="ot">=</span><span class="fu">glm</span>(Prop_MS<span class="sc">~</span>stder_BM_focal<span class="sc">*</span>Gr_size<span class="sc">*</span>Area,<span class="at">data=</span>DB_data_M,<span class="at">family =</span> quasibinomial)</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ModT1)</span></code></pre></div>
<pre><code>
Call:
glm(formula = Prop_MS ~ stder_BM_focal * Gr_size * Area, family = quasibinomial, 
    data = DB_data_M)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-0.74502  -0.28399  -0.04377   0.21477   1.44401  

Coefficients:
                                   Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                         -0.8085     0.1597  -5.063 1.28e-06 ***
stder_BM_focal                      -0.2788     0.1782  -1.564    0.120    
Gr_sizeLG                            0.1431     0.2055   0.696    0.487    
AreaSmall                            0.2038     0.2036   1.001    0.319    
stder_BM_focal:Gr_sizeLG             0.2317     0.2140   1.083    0.281    
stder_BM_focal:AreaSmall             0.2845     0.2274   1.251    0.213    
Gr_sizeLG:AreaSmall                 -0.2449     0.2849  -0.860    0.391    
stder_BM_focal:Gr_sizeLG:AreaSmall  -0.2927     0.2921  -1.002    0.318    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for quasibinomial family taken to be 0.1493034)

    Null deviance: 22.477  on 147  degrees of freedom
Residual deviance: 21.992  on 140  degrees of freedom
AIC: NA

Number of Fisher Scoring iterations: 4</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Anova(ModT1,type=3) #If the interactions are not significant, type II gives a more powerful test.</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(ModT1,<span class="at">type=</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>Analysis of Deviance Table (Type II tests)

Response: Prop_MS
                            LR Chisq Df Pr(&gt;Chisq)
stder_BM_focal               1.09858  1     0.2946
Gr_size                      0.00190  1     0.9653
Area                         0.15658  1     0.6923
stder_BM_focal:Gr_size       0.27316  1     0.6012
stder_BM_focal:Area          0.57881  1     0.4468
Gr_size:Area                 0.55361  1     0.4568
stder_BM_focal:Gr_size:Area  1.00959  1     0.3150</code></pre>
<p>Females</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Females</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Model treatment</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>ModT2<span class="ot">=</span><span class="fu">glm</span>(Prop_MS<span class="sc">~</span>stder_BM_focal<span class="sc">*</span>Gr_size<span class="sc">*</span>Area,<span class="at">data=</span>DB_data_F,<span class="at">family =</span> quasibinomial)</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ModT2)</span></code></pre></div>
<pre><code>
Call:
glm(formula = Prop_MS ~ stder_BM_focal * Gr_size * Area, family = quasibinomial, 
    data = DB_data_F)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-0.74862  -0.35523  -0.06568   0.24476   1.49450  

Coefficients:
                                   Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)                        -0.33525    0.13499  -2.484   0.0144 *
stder_BM_focal                     -0.07274    0.14779  -0.492   0.6235  
Gr_sizeLG                          -0.14849    0.23744  -0.625   0.5329  
AreaSmall                          -0.37714    0.22099  -1.707   0.0904 .
stder_BM_focal:Gr_sizeLG           -0.31347    0.25385  -1.235   0.2193  
stder_BM_focal:AreaSmall            0.11556    0.21641   0.534   0.5943  
Gr_sizeLG:AreaSmall                 0.42765    0.34409   1.243   0.2163  
stder_BM_focal:Gr_sizeLG:AreaSmall  0.36737    0.34629   1.061   0.2908  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for quasibinomial family taken to be 0.2073228)

    Null deviance: 29.610  on 129  degrees of freedom
Residual deviance: 28.089  on 122  degrees of freedom
AIC: NA

Number of Fisher Scoring iterations: 3</code></pre>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Anova(ModT2,type=3) #If the interactions are not significant, type II gives a more powerful test.</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(ModT2,<span class="at">type=</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>Analysis of Deviance Table (Type II tests)

Response: Prop_MS
                            LR Chisq Df Pr(&gt;Chisq)
stder_BM_focal               0.43199  1     0.5110
Gr_size                      0.13451  1     0.7138
Area                         1.51521  1     0.2183
stder_BM_focal:Gr_size       0.46389  1     0.4958
stder_BM_focal:Area          2.42000  1     0.1198
Gr_size:Area                 1.49477  1     0.2215
stder_BM_focal:Gr_size:Area  1.13236  1     0.2873</code></pre>
</div>
</div>
<div id="standardized-selection-differential" class="section level1">
<h1>Standardized selection differential</h1>
<p>Finally, we used bootstrapping to estimate treatment specific
standardized selection differential on body mass.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Selection coefficients ####</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="co">#All </span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Males</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Bootstrap</span></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>selDif_BW_males <span class="ot">=</span> <span class="cf">function</span>(dataFrame, indexVector) { </span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Calculate relative fitness</span></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>  rel_fit_males<span class="ot">=</span>dataFrame[indexVector, <span class="fu">match</span>(<span class="st">&quot;m_RS&quot;</span>,<span class="fu">names</span>(dataFrame))]<span class="sc">/</span><span class="fu">mean</span>(dataFrame[indexVector, <span class="fu">match</span>(<span class="st">&quot;m_RS&quot;</span>,<span class="fu">names</span>(dataFrame))],<span class="at">na.rm=</span>T)</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Calculate selection differential</span></span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">=</span> <span class="fu">cov</span>(dataFrame[indexVector, <span class="fu">match</span>(<span class="st">&quot;stder_BM_focal&quot;</span>,<span class="fu">names</span>(dataFrame))],rel_fit_males,<span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(s)</span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>boot_BW_males <span class="ot">=</span> <span class="fu">boot</span>(DB_data_clean_M, selDif_BW_males, <span class="at">R =</span> <span class="dv">10000</span>)</span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a><span class="co">#Females</span></span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a>selDif_BW_females <span class="ot">=</span> <span class="cf">function</span>(dataFrame, indexVector) { </span>
<span id="cb71-18"><a href="#cb71-18" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Calculate relative fitness</span></span>
<span id="cb71-19"><a href="#cb71-19" aria-hidden="true" tabindex="-1"></a>  rel_fit_females<span class="ot">=</span>dataFrame[indexVector, <span class="fu">match</span>(<span class="st">&quot;f_RS&quot;</span>,<span class="fu">names</span>(dataFrame))]<span class="sc">/</span><span class="fu">mean</span>(dataFrame[indexVector, <span class="fu">match</span>(<span class="st">&quot;f_RS&quot;</span>,<span class="fu">names</span>(dataFrame))],<span class="at">na.rm=</span>T)</span>
<span id="cb71-20"><a href="#cb71-20" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Calculate selection differential</span></span>
<span id="cb71-21"><a href="#cb71-21" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">=</span> <span class="fu">cov</span>(dataFrame[indexVector, <span class="fu">match</span>(<span class="st">&quot;stder_BM_focal&quot;</span>,<span class="fu">names</span>(dataFrame))],rel_fit_females,<span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb71-22"><a href="#cb71-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(s)</span>
<span id="cb71-23"><a href="#cb71-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb71-24"><a href="#cb71-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-25"><a href="#cb71-25" aria-hidden="true" tabindex="-1"></a>boot_BW_females <span class="ot">=</span> <span class="fu">boot</span>(DB_data_clean_F, selDif_BW_females, <span class="at">R =</span> <span class="dv">10000</span>)</span>
<span id="cb71-26"><a href="#cb71-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-27"><a href="#cb71-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-28"><a href="#cb71-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Selection coefficients for treatments</span></span>
<span id="cb71-29"><a href="#cb71-29" aria-hidden="true" tabindex="-1"></a><span class="co">#Males</span></span>
<span id="cb71-30"><a href="#cb71-30" aria-hidden="true" tabindex="-1"></a><span class="co">#Group size</span></span>
<span id="cb71-31"><a href="#cb71-31" aria-hidden="true" tabindex="-1"></a><span class="co">#Small group</span></span>
<span id="cb71-32"><a href="#cb71-32" aria-hidden="true" tabindex="-1"></a>boot_BW_males_group_size_small <span class="ot">=</span> <span class="fu">boot</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,], selDif_BW_males, <span class="at">R =</span> <span class="dv">10000</span>)</span>
<span id="cb71-33"><a href="#cb71-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-34"><a href="#cb71-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-35"><a href="#cb71-35" aria-hidden="true" tabindex="-1"></a><span class="co">#Large group</span></span>
<span id="cb71-36"><a href="#cb71-36" aria-hidden="true" tabindex="-1"></a>boot_BW_males_group_size_large <span class="ot">=</span> <span class="fu">boot</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,], selDif_BW_males, <span class="at">R =</span> <span class="dv">10000</span>)</span>
<span id="cb71-37"><a href="#cb71-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-38"><a href="#cb71-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-39"><a href="#cb71-39" aria-hidden="true" tabindex="-1"></a><span class="co">#Area</span></span>
<span id="cb71-40"><a href="#cb71-40" aria-hidden="true" tabindex="-1"></a><span class="co">#Large Area</span></span>
<span id="cb71-41"><a href="#cb71-41" aria-hidden="true" tabindex="-1"></a>boot_BW_males_area_large <span class="ot">=</span> <span class="fu">boot</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,], selDif_BW_males, <span class="at">R =</span> <span class="dv">10000</span>)</span>
<span id="cb71-42"><a href="#cb71-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-43"><a href="#cb71-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-44"><a href="#cb71-44" aria-hidden="true" tabindex="-1"></a><span class="co">#Small Area</span></span>
<span id="cb71-45"><a href="#cb71-45" aria-hidden="true" tabindex="-1"></a>boot_BW_males_area_small <span class="ot">=</span> <span class="fu">boot</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,], selDif_BW_males, <span class="at">R =</span> <span class="dv">10000</span>)</span>
<span id="cb71-46"><a href="#cb71-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-47"><a href="#cb71-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-48"><a href="#cb71-48" aria-hidden="true" tabindex="-1"></a><span class="co">#Females</span></span>
<span id="cb71-49"><a href="#cb71-49" aria-hidden="true" tabindex="-1"></a><span class="co">#Group size</span></span>
<span id="cb71-50"><a href="#cb71-50" aria-hidden="true" tabindex="-1"></a><span class="co">#Small group</span></span>
<span id="cb71-51"><a href="#cb71-51" aria-hidden="true" tabindex="-1"></a>boot_BW_females_group_size_small <span class="ot">=</span> <span class="fu">boot</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,], selDif_BW_females, <span class="at">R =</span> <span class="dv">10000</span>)</span>
<span id="cb71-52"><a href="#cb71-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-53"><a href="#cb71-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-54"><a href="#cb71-54" aria-hidden="true" tabindex="-1"></a><span class="co">#Large group</span></span>
<span id="cb71-55"><a href="#cb71-55" aria-hidden="true" tabindex="-1"></a>boot_BW_females_group_size_large <span class="ot">=</span> <span class="fu">boot</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,], selDif_BW_females, <span class="at">R =</span> <span class="dv">10000</span>)</span>
<span id="cb71-56"><a href="#cb71-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-57"><a href="#cb71-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-58"><a href="#cb71-58" aria-hidden="true" tabindex="-1"></a><span class="co">#Area</span></span>
<span id="cb71-59"><a href="#cb71-59" aria-hidden="true" tabindex="-1"></a><span class="co">#Large Area</span></span>
<span id="cb71-60"><a href="#cb71-60" aria-hidden="true" tabindex="-1"></a>boot_BW_females_area_large <span class="ot">=</span> <span class="fu">boot</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,], selDif_BW_females, <span class="at">R =</span> <span class="dv">10000</span>)</span>
<span id="cb71-61"><a href="#cb71-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-62"><a href="#cb71-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-63"><a href="#cb71-63" aria-hidden="true" tabindex="-1"></a><span class="co">#Small Area</span></span>
<span id="cb71-64"><a href="#cb71-64" aria-hidden="true" tabindex="-1"></a>boot_BW_females_area_small <span class="ot">=</span> <span class="fu">boot</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,], selDif_BW_females, <span class="at">R =</span> <span class="dv">10000</span>)</span>
<span id="cb71-65"><a href="#cb71-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-66"><a href="#cb71-66" aria-hidden="true" tabindex="-1"></a><span class="co">#Data table ####</span></span>
<span id="cb71-67"><a href="#cb71-67" aria-hidden="true" tabindex="-1"></a>boot_data_BW_males <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(<span class="st">&quot;Male&quot;</span>, <span class="st">&quot;Mass&quot;</span>, <span class="st">&quot;All&quot;</span>, <span class="fu">mean</span>(boot_BW_males<span class="sc">$</span>t,<span class="at">na.rm=</span>T), <span class="fu">quantile</span>(boot_BW_males<span class="sc">$</span>t,.<span class="dv">025</span>, <span class="at">names =</span> <span class="cn">FALSE</span>,<span class="at">na.rm=</span>T), <span class="fu">quantile</span>(boot_BW_males<span class="sc">$</span>t,.<span class="dv">975</span>, <span class="at">names =</span> <span class="cn">FALSE</span>,<span class="at">na.rm=</span>T)))</span>
<span id="cb71-68"><a href="#cb71-68" aria-hidden="true" tabindex="-1"></a>boot_data_BW_females <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(<span class="st">&quot;Female&quot;</span>, <span class="st">&quot;Mass&quot;</span>, <span class="st">&quot;All&quot;</span>, <span class="fu">mean</span>(boot_BW_females<span class="sc">$</span>t,<span class="at">na.rm=</span>T), <span class="fu">quantile</span>(boot_BW_females<span class="sc">$</span>t,.<span class="dv">025</span>, <span class="at">names =</span> <span class="cn">FALSE</span>,<span class="at">na.rm=</span>T), <span class="fu">quantile</span>(boot_BW_females<span class="sc">$</span>t,.<span class="dv">975</span>, <span class="at">names =</span> <span class="cn">FALSE</span>,<span class="at">na.rm=</span>T)))</span>
<span id="cb71-69"><a href="#cb71-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-70"><a href="#cb71-70" aria-hidden="true" tabindex="-1"></a>boot_data_BW_males_group_size_small <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(<span class="st">&quot;Male&quot;</span>, <span class="st">&quot;Mass&quot;</span>, <span class="st">&quot;Small group&quot;</span>, <span class="fu">mean</span>(boot_BW_males_group_size_small<span class="sc">$</span>t,<span class="at">na.rm=</span>T), <span class="fu">quantile</span>(boot_BW_males_group_size_small<span class="sc">$</span>t,.<span class="dv">025</span>, <span class="at">names =</span> <span class="cn">FALSE</span>,<span class="at">na.rm=</span>T), <span class="fu">quantile</span>(boot_BW_males_group_size_small<span class="sc">$</span>t,.<span class="dv">975</span>, <span class="at">names =</span> <span class="cn">FALSE</span>,<span class="at">na.rm=</span>T)))</span>
<span id="cb71-71"><a href="#cb71-71" aria-hidden="true" tabindex="-1"></a>boot_data_BW_females_group_size_small <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(<span class="st">&quot;Female&quot;</span>, <span class="st">&quot;Mass&quot;</span>, <span class="st">&quot;Small group&quot;</span>, <span class="fu">mean</span>(boot_BW_females_group_size_small<span class="sc">$</span>t,<span class="at">na.rm=</span>T), <span class="fu">quantile</span>(boot_BW_females_group_size_small<span class="sc">$</span>t,.<span class="dv">025</span>, <span class="at">names =</span> <span class="cn">FALSE</span>,<span class="at">na.rm=</span>T), <span class="fu">quantile</span>(boot_BW_females_group_size_small<span class="sc">$</span>t,.<span class="dv">975</span>, <span class="at">names =</span> <span class="cn">FALSE</span>,<span class="at">na.rm=</span>T)))</span>
<span id="cb71-72"><a href="#cb71-72" aria-hidden="true" tabindex="-1"></a>boot_data_BW_males_group_size_large <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(<span class="st">&quot;Male&quot;</span>, <span class="st">&quot;Mass&quot;</span>, <span class="st">&quot;large group&quot;</span>, <span class="fu">mean</span>(boot_BW_males_group_size_large<span class="sc">$</span>t,<span class="at">na.rm=</span>T), <span class="fu">quantile</span>(boot_BW_males_group_size_large<span class="sc">$</span>t,.<span class="dv">025</span>, <span class="at">names =</span> <span class="cn">FALSE</span>,<span class="at">na.rm=</span>T), <span class="fu">quantile</span>(boot_BW_males_group_size_large<span class="sc">$</span>t,.<span class="dv">975</span>, <span class="at">names =</span> <span class="cn">FALSE</span>,<span class="at">na.rm=</span>T)))</span>
<span id="cb71-73"><a href="#cb71-73" aria-hidden="true" tabindex="-1"></a>boot_data_BW_females_group_size_large <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(<span class="st">&quot;Female&quot;</span>, <span class="st">&quot;Mass&quot;</span>, <span class="st">&quot;large group&quot;</span>, <span class="fu">mean</span>(boot_BW_females_group_size_large<span class="sc">$</span>t,<span class="at">na.rm=</span>T), <span class="fu">quantile</span>(boot_BW_females_group_size_large<span class="sc">$</span>t,.<span class="dv">025</span>, <span class="at">names =</span> <span class="cn">FALSE</span>,<span class="at">na.rm=</span>T), <span class="fu">quantile</span>(boot_BW_females_group_size_large<span class="sc">$</span>t,.<span class="dv">975</span>, <span class="at">names =</span> <span class="cn">FALSE</span>,<span class="at">na.rm=</span>T)))</span>
<span id="cb71-74"><a href="#cb71-74" aria-hidden="true" tabindex="-1"></a>boot_data_BW_males_area_small <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(<span class="st">&quot;Male&quot;</span>, <span class="st">&quot;Mass&quot;</span>, <span class="st">&quot;Small area&quot;</span>, <span class="fu">mean</span>(boot_BW_males_area_small<span class="sc">$</span>t,<span class="at">na.rm=</span>T), <span class="fu">quantile</span>(boot_BW_males_area_small<span class="sc">$</span>t,.<span class="dv">025</span>, <span class="at">names =</span> <span class="cn">FALSE</span>,<span class="at">na.rm=</span>T), <span class="fu">quantile</span>(boot_BW_males_area_small<span class="sc">$</span>t,.<span class="dv">975</span>, <span class="at">names =</span> <span class="cn">FALSE</span>,<span class="at">na.rm=</span>T)))</span>
<span id="cb71-75"><a href="#cb71-75" aria-hidden="true" tabindex="-1"></a>boot_data_BW_females_area_small <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(<span class="st">&quot;Female&quot;</span>, <span class="st">&quot;Mass&quot;</span>, <span class="st">&quot;Small area&quot;</span>, <span class="fu">mean</span>(boot_BW_females_area_small<span class="sc">$</span>t,<span class="at">na.rm=</span>T), <span class="fu">quantile</span>(boot_BW_females_area_small<span class="sc">$</span>t,.<span class="dv">025</span>, <span class="at">names =</span> <span class="cn">FALSE</span>,<span class="at">na.rm=</span>T), <span class="fu">quantile</span>(boot_BW_females_area_small<span class="sc">$</span>t,.<span class="dv">975</span>, <span class="at">names =</span> <span class="cn">FALSE</span>,<span class="at">na.rm=</span>T)))</span>
<span id="cb71-76"><a href="#cb71-76" aria-hidden="true" tabindex="-1"></a>boot_data_BW_males_area_large <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(<span class="st">&quot;Male&quot;</span>, <span class="st">&quot;Mass&quot;</span>, <span class="st">&quot;large area&quot;</span>, <span class="fu">mean</span>(boot_BW_males_area_large<span class="sc">$</span>t,<span class="at">na.rm=</span>T), <span class="fu">quantile</span>(boot_BW_males_area_large<span class="sc">$</span>t,.<span class="dv">025</span>, <span class="at">names =</span> <span class="cn">FALSE</span>,<span class="at">na.rm=</span>T), <span class="fu">quantile</span>(boot_BW_males_area_large<span class="sc">$</span>t,.<span class="dv">975</span>, <span class="at">names =</span> <span class="cn">FALSE</span>,<span class="at">na.rm=</span>T)))</span>
<span id="cb71-77"><a href="#cb71-77" aria-hidden="true" tabindex="-1"></a>boot_data_BW_females_area_large <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(<span class="st">&quot;Female&quot;</span>, <span class="st">&quot;Mass&quot;</span>, <span class="st">&quot;large area&quot;</span>, <span class="fu">mean</span>(boot_BW_females_area_large<span class="sc">$</span>t,<span class="at">na.rm=</span>T), <span class="fu">quantile</span>(boot_BW_females_area_large<span class="sc">$</span>t,.<span class="dv">025</span>, <span class="at">names =</span> <span class="cn">FALSE</span>,<span class="at">na.rm=</span>T), <span class="fu">quantile</span>(boot_BW_females_area_large<span class="sc">$</span>t,.<span class="dv">975</span>, <span class="at">names =</span> <span class="cn">FALSE</span>,<span class="at">na.rm=</span>T)))</span>
<span id="cb71-78"><a href="#cb71-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-79"><a href="#cb71-79" aria-hidden="true" tabindex="-1"></a>SelDifBoot_Table <span class="ot">&lt;-</span> <span class="fu">as.table</span>(<span class="fu">as.matrix</span>(<span class="fu">rbind</span>(boot_data_BW_males,boot_data_BW_females,boot_data_BW_males_group_size_small,boot_data_BW_females_group_size_small,</span>
<span id="cb71-80"><a href="#cb71-80" aria-hidden="true" tabindex="-1"></a>                                             boot_data_BW_males_group_size_large,boot_data_BW_females_group_size_large,</span>
<span id="cb71-81"><a href="#cb71-81" aria-hidden="true" tabindex="-1"></a>                                             boot_data_BW_males_area_small,boot_data_BW_females_area_small,</span>
<span id="cb71-82"><a href="#cb71-82" aria-hidden="true" tabindex="-1"></a>                                             boot_data_BW_males_area_large,boot_data_BW_females_area_large)))</span>
<span id="cb71-83"><a href="#cb71-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-84"><a href="#cb71-84" aria-hidden="true" tabindex="-1"></a><span class="fu">is.table</span>(SelDifBoot_Table)</span>
<span id="cb71-85"><a href="#cb71-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-86"><a href="#cb71-86" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(SelDifBoot_Table)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Sex&quot;</span></span>
<span id="cb71-87"><a href="#cb71-87" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(SelDifBoot_Table)[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Trait&quot;</span></span>
<span id="cb71-88"><a href="#cb71-88" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(SelDifBoot_Table)[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Treatment&quot;</span></span>
<span id="cb71-89"><a href="#cb71-89" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(SelDifBoot_Table)[<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Coefficient&quot;</span></span>
<span id="cb71-90"><a href="#cb71-90" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(SelDifBoot_Table)[<span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="st">&quot;l95_CI&quot;</span></span>
<span id="cb71-91"><a href="#cb71-91" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(SelDifBoot_Table)[<span class="dv">6</span>] <span class="ot">&lt;-</span> <span class="st">&quot;u95_CI&quot;</span></span>
<span id="cb71-92"><a href="#cb71-92" aria-hidden="true" tabindex="-1"></a>SelDifBoot_Table<span class="ot">=</span><span class="fu">as.data.frame.matrix</span>(SelDifBoot_Table)</span>
<span id="cb71-93"><a href="#cb71-93" aria-hidden="true" tabindex="-1"></a>SelDifBoot_Table<span class="sc">$</span>Sex <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">as.character</span>(SelDifBoot_Table<span class="sc">$</span>Sex))</span>
<span id="cb71-94"><a href="#cb71-94" aria-hidden="true" tabindex="-1"></a>SelDifBoot_Table<span class="sc">$</span>Trait <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">as.character</span>(SelDifBoot_Table<span class="sc">$</span>Trait))</span>
<span id="cb71-95"><a href="#cb71-95" aria-hidden="true" tabindex="-1"></a>SelDifBoot_Table<span class="sc">$</span>Treatment <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">as.character</span>(SelDifBoot_Table<span class="sc">$</span>Treatment))</span>
<span id="cb71-96"><a href="#cb71-96" aria-hidden="true" tabindex="-1"></a>SelDifBoot_Table<span class="sc">$</span>Coefficient <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(SelDifBoot_Table<span class="sc">$</span>Coefficient))</span>
<span id="cb71-97"><a href="#cb71-97" aria-hidden="true" tabindex="-1"></a>SelDifBoot_Table<span class="sc">$</span>l95_CI <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(SelDifBoot_Table<span class="sc">$</span>l95_CI))</span>
<span id="cb71-98"><a href="#cb71-98" aria-hidden="true" tabindex="-1"></a>SelDifBoot_Table<span class="sc">$</span>u95_CI <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(SelDifBoot_Table<span class="sc">$</span>u95_CI))</span>
<span id="cb71-99"><a href="#cb71-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-100"><a href="#cb71-100" aria-hidden="true" tabindex="-1"></a>SelDifBoot_Table_round<span class="ot">=</span><span class="fu">cbind</span>(SelDifBoot_Table[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)],<span class="fu">round</span>(SelDifBoot_Table[,<span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>)],<span class="at">digit=</span><span class="dv">3</span>))</span></code></pre></div>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Figures ####</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>SelDifBoot_Table<span class="sc">$</span>Treatment <span class="ot">&lt;-</span> <span class="fu">factor</span>(SelDifBoot_Table<span class="sc">$</span>Treatment, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;All&quot;</span>,<span class="st">&#39;Small group&#39;</span>,<span class="st">&#39;large group&#39;</span>,<span class="st">&#39;large area&#39;</span>,<span class="st">&#39;Small area&#39;</span>))</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>SelDifBoot_Table<span class="sc">$</span>Sex <span class="ot">&lt;-</span> <span class="fu">factor</span>(SelDifBoot_Table<span class="sc">$</span>Sex, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;Female&quot;</span>,<span class="st">&#39;Male&#39;</span>))</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>BarPlot_2<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(SelDifBoot_Table[<span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>,], <span class="fu">aes</span>(<span class="at">x=</span>Sex, <span class="at">y=</span>Coefficient, <span class="at">fill=</span>Treatment)) <span class="sc">+</span> </span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">27</span>, .<span class="dv">75</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span> ,<span class="dv">0</span>)) <span class="sc">+</span> </span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">0</span>, <span class="at">linetype=</span><span class="st">&quot;solid&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">position=</span><span class="fu">position_dodge</span>(), <span class="at">alpha=</span><span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>l95_CI, <span class="at">ymax=</span>u95_CI), <span class="at">width=</span>.<span class="dv">3</span>,<span class="at">size=</span><span class="dv">1</span>, <span class="at">position=</span><span class="fu">position_dodge</span>(.<span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Standardized selection differential (&quot;</span>,<span class="sc">~</span><span class="fu">italic</span>(<span class="st">&quot;s&#39;&quot;</span>),<span class="st">&quot;)&quot;</span>))) <span class="sc">+</span><span class="fu">xlab</span>(<span class="st">&#39;Sex&#39;</span>) <span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">&#39;Group size&#39;</span>)<span class="sc">+</span><span class="fu">labs</span>(<span class="at">tag =</span> <span class="st">&quot;A&quot;</span>)<span class="sc">+</span></span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">breaks=</span><span class="fu">waiver</span>(),<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Female&quot;</span>,<span class="st">&quot;Male&quot;</span>))<span class="sc">+</span> </span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="fl">0.1</span>,<span class="dv">2</span>,<span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="st">&quot;cm&quot;</span>),</span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.tag.position=</span><span class="fu">c</span>(<span class="fl">0.01</span>,<span class="fl">0.98</span>),</span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">1.05</span>, <span class="fl">0.8</span>),</span>
<span id="cb72-20"><a href="#cb72-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="dv">10</span>),</span>
<span id="cb72-21"><a href="#cb72-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb72-22"><a href="#cb72-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb72-23"><a href="#cb72-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;plain&quot;</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="dv">16</span>, <span class="at">angle=</span><span class="dv">0</span>),</span>
<span id="cb72-24"><a href="#cb72-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;plain&quot;</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="dv">16</span>, <span class="at">angle=</span><span class="dv">0</span>),</span>
<span id="cb72-25"><a href="#cb72-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>,<span class="at">face=</span><span class="st">&quot;plain&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">r=</span><span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">0</span>,<span class="dv">0</span>)),</span>
<span id="cb72-26"><a href="#cb72-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>,<span class="at">face=</span><span class="st">&quot;plain&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">r=</span><span class="dv">10</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)),</span>
<span id="cb72-27"><a href="#cb72-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb72-28"><a href="#cb72-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.length =</span> <span class="fu">unit</span>(.<span class="dv">3</span>, <span class="st">&quot;cm&quot;</span>))<span class="sc">+</span></span>
<span id="cb72-29"><a href="#cb72-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(slava_ukrajini[<span class="dv">1</span>],slava_ukrajini[<span class="dv">2</span>]),<span class="at">name =</span> <span class="st">&quot;&quot;</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Small group&quot;</span>,<span class="st">&#39;Large group&#39;</span>))</span>
<span id="cb72-30"><a href="#cb72-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-31"><a href="#cb72-31" aria-hidden="true" tabindex="-1"></a>BarPlot_3<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(SelDifBoot_Table[<span class="fu">c</span>(<span class="dv">9</span>,<span class="dv">10</span>,<span class="dv">7</span>,<span class="dv">8</span>),], <span class="fu">aes</span>(<span class="at">x=</span>Sex, <span class="at">y=</span>Coefficient, <span class="at">fill=</span>Treatment)) <span class="sc">+</span> </span>
<span id="cb72-32"><a href="#cb72-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">27</span>, .<span class="dv">75</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span>.<span class="dv">3</span>,.<span class="dv">7</span>,.<span class="dv">15</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span> ,<span class="dv">0</span>)) <span class="sc">+</span> </span>
<span id="cb72-33"><a href="#cb72-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">0</span>, <span class="at">linetype=</span><span class="st">&quot;solid&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb72-34"><a href="#cb72-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">position=</span><span class="fu">position_dodge</span>(), <span class="at">alpha=</span><span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb72-35"><a href="#cb72-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>l95_CI, <span class="at">ymax=</span>u95_CI), <span class="at">width=</span>.<span class="dv">3</span>,<span class="at">size=</span><span class="dv">1</span>, <span class="at">position=</span><span class="fu">position_dodge</span>(.<span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb72-36"><a href="#cb72-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;&#39;</span>) <span class="sc">+</span><span class="fu">xlab</span>(<span class="st">&#39;Sex&#39;</span>) <span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">&#39;Area&#39;</span>)<span class="sc">+</span><span class="fu">labs</span>(<span class="at">tag =</span> <span class="st">&quot;B&quot;</span>)<span class="sc">+</span></span>
<span id="cb72-37"><a href="#cb72-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">breaks=</span><span class="fu">waiver</span>(),<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Female&quot;</span>,<span class="st">&quot;Male&quot;</span>))<span class="sc">+</span> </span>
<span id="cb72-38"><a href="#cb72-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb72-39"><a href="#cb72-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="fl">0.1</span>,<span class="dv">2</span>,<span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="st">&quot;cm&quot;</span>),</span>
<span id="cb72-40"><a href="#cb72-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb72-41"><a href="#cb72-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb72-42"><a href="#cb72-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb72-43"><a href="#cb72-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb72-44"><a href="#cb72-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.tag.position=</span><span class="fu">c</span>(<span class="fl">0.01</span>,<span class="fl">0.98</span>),</span>
<span id="cb72-45"><a href="#cb72-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">1.05</span>, <span class="fl">0.8</span>),</span>
<span id="cb72-46"><a href="#cb72-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="dv">10</span>),</span>
<span id="cb72-47"><a href="#cb72-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb72-48"><a href="#cb72-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb72-49"><a href="#cb72-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;plain&quot;</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="dv">16</span>, <span class="at">angle=</span><span class="dv">0</span>),</span>
<span id="cb72-50"><a href="#cb72-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;plain&quot;</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="dv">16</span>, <span class="at">angle=</span><span class="dv">0</span>),</span>
<span id="cb72-51"><a href="#cb72-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>,<span class="at">face=</span><span class="st">&quot;plain&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">r=</span><span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">0</span>,<span class="dv">0</span>)),</span>
<span id="cb72-52"><a href="#cb72-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>,<span class="at">face=</span><span class="st">&quot;plain&quot;</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">r=</span><span class="dv">10</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)),</span>
<span id="cb72-53"><a href="#cb72-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb72-54"><a href="#cb72-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.length =</span> <span class="fu">unit</span>(.<span class="dv">3</span>, <span class="st">&quot;cm&quot;</span>))<span class="sc">+</span></span>
<span id="cb72-55"><a href="#cb72-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(slava_ukrajini[<span class="dv">1</span>],slava_ukrajini[<span class="dv">2</span>]),<span class="at">name =</span> <span class="st">&quot;&quot;</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Large area&quot;</span>,<span class="st">&#39;Small area&#39;</span>))</span>
<span id="cb72-56"><a href="#cb72-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-57"><a href="#cb72-57" aria-hidden="true" tabindex="-1"></a>plot1<span class="ot">&lt;-</span><span class="fu">grid.arrange</span>(BarPlot_2,BarPlot_3, <span class="at">nrow =</span> <span class="dv">1</span>,<span class="at">ncol=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="figure/index4.Rmd/unnamed-chunk-27-1.png" width="672" style="display: block; margin: auto;" />
Figure 5: Effect of density on sex-specific standardized selection
differential (s’) for population size (A) and area treatment
(B).<br><br></p>
<p>Permutation tests for differences in density dependent standardized
selection differentials.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Permutation test ####</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Sex bias ####</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="co">#population size ####</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Small</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>Sex_diff_Small_male_pop<span class="ot">=</span><span class="fu">c</span>(boot_BW_males_group_size_small<span class="sc">$</span>t)<span class="sc">-</span><span class="fu">c</span>(boot_BW_females_group_size_small<span class="sc">$</span>t)</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>t_Sex_diff_Small_male_pop<span class="ot">=</span><span class="fu">mean</span>(Sex_diff_Small_male_pop,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>t_Sex_diff_Small_male_pop_lower<span class="ot">=</span><span class="fu">quantile</span>(Sex_diff_Small_male_pop,.<span class="dv">025</span>,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>t_Sex_diff_Small_male_pop_upper<span class="ot">=</span><span class="fu">quantile</span>(Sex_diff_Small_male_pop,.<span class="dv">975</span>,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a><span class="co">#Permutation test to calculate p value</span></span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>comb_data_RS<span class="ot">=</span><span class="fu">c</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>m_RS),</span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a>            DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>f_RS))</span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a>comb_data_BM<span class="ot">=</span><span class="fu">c</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>stder_BM_focal,</span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a>               DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>stder_BM_focal)</span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-17"><a href="#cb73-17" aria-hidden="true" tabindex="-1"></a>diff.observed_Small_pop <span class="ot">=</span> <span class="fu">cov</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>stder_BM_focal,DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>m_RS),<span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>) <span class="sc">-</span> <span class="fu">cov</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>stder_BM_focal,DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>f_RS),<span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>) </span>
<span id="cb73-18"><a href="#cb73-18" aria-hidden="true" tabindex="-1"></a>diff.observed_Small_pop</span>
<span id="cb73-19"><a href="#cb73-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-20"><a href="#cb73-20" aria-hidden="true" tabindex="-1"></a>number_of_permutations <span class="ot">=</span> <span class="dv">100000</span></span>
<span id="cb73-21"><a href="#cb73-21" aria-hidden="true" tabindex="-1"></a>diff.random_Small_pop <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb73-22"><a href="#cb73-22" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span> <span class="sc">:</span> number_of_permutations) {</span>
<span id="cb73-23"><a href="#cb73-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-24"><a href="#cb73-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Sample from the combined dataset</span></span>
<span id="cb73-25"><a href="#cb73-25" aria-hidden="true" tabindex="-1"></a>  a.random <span class="ot">=</span> <span class="fu">sample</span> (<span class="fu">na.omit</span>(comb_data_RS), <span class="fu">length</span>(<span class="fu">c</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>m_RS))), <span class="cn">TRUE</span>)</span>
<span id="cb73-26"><a href="#cb73-26" aria-hidden="true" tabindex="-1"></a>  b.random <span class="ot">=</span> <span class="fu">sample</span> (<span class="fu">na.omit</span>(comb_data_BM), <span class="fu">length</span>(<span class="fu">c</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>m_RS))), <span class="cn">TRUE</span>)</span>
<span id="cb73-27"><a href="#cb73-27" aria-hidden="true" tabindex="-1"></a>  c.random <span class="ot">=</span> <span class="fu">sample</span> (<span class="fu">na.omit</span>(comb_data_RS), <span class="fu">length</span>(<span class="fu">c</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>f_RS))), <span class="cn">TRUE</span>)</span>
<span id="cb73-28"><a href="#cb73-28" aria-hidden="true" tabindex="-1"></a>  d.random <span class="ot">=</span> <span class="fu">sample</span> (<span class="fu">na.omit</span>(comb_data_BM), <span class="fu">length</span>(<span class="fu">c</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>f_RS))), <span class="cn">TRUE</span>)</span>
<span id="cb73-29"><a href="#cb73-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-30"><a href="#cb73-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Null (permuated) difference</span></span>
<span id="cb73-31"><a href="#cb73-31" aria-hidden="true" tabindex="-1"></a>  diff.random_Small_pop[i] <span class="ot">=</span> <span class="fu">cov</span>(b.random,a.random,<span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>) <span class="sc">-</span> <span class="fu">cov</span>(d.random,c.random,<span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb73-32"><a href="#cb73-32" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb73-33"><a href="#cb73-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-34"><a href="#cb73-34" aria-hidden="true" tabindex="-1"></a><span class="co"># P-value is the fraction of how many times the permuted difference is</span></span>
<span id="cb73-35"><a href="#cb73-35" aria-hidden="true" tabindex="-1"></a><span class="co"># equal or more extreme than the observed difference</span></span>
<span id="cb73-36"><a href="#cb73-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-37"><a href="#cb73-37" aria-hidden="true" tabindex="-1"></a>p_Sex_diff_Small_pop <span class="ot">=</span> <span class="fu">sum</span>((diff.random_Small_pop) <span class="sc">&gt;=</span> <span class="fu">as.numeric</span>((diff.observed_Small_pop)))<span class="sc">/</span>   number_of_permutations</span>
<span id="cb73-38"><a href="#cb73-38" aria-hidden="true" tabindex="-1"></a>p_Sex_diff_Small_pop</span>
<span id="cb73-39"><a href="#cb73-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-40"><a href="#cb73-40" aria-hidden="true" tabindex="-1"></a><span class="co">#population size ####</span></span>
<span id="cb73-41"><a href="#cb73-41" aria-hidden="true" tabindex="-1"></a><span class="co">#Large</span></span>
<span id="cb73-42"><a href="#cb73-42" aria-hidden="true" tabindex="-1"></a>Sex_diff_large_male_pop<span class="ot">=</span><span class="fu">c</span>(boot_BW_males_group_size_large<span class="sc">$</span>t)<span class="sc">-</span><span class="fu">c</span>(boot_BW_females_group_size_large<span class="sc">$</span>t)</span>
<span id="cb73-43"><a href="#cb73-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-44"><a href="#cb73-44" aria-hidden="true" tabindex="-1"></a>t_Sex_diff_large_male_pop<span class="ot">=</span><span class="fu">mean</span>(Sex_diff_large_male_pop,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb73-45"><a href="#cb73-45" aria-hidden="true" tabindex="-1"></a>t_Sex_diff_large_male_pop_lower<span class="ot">=</span><span class="fu">quantile</span>(Sex_diff_large_male_pop,.<span class="dv">025</span>,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb73-46"><a href="#cb73-46" aria-hidden="true" tabindex="-1"></a>t_Sex_diff_large_male_pop_upper<span class="ot">=</span><span class="fu">quantile</span>(Sex_diff_large_male_pop,.<span class="dv">975</span>,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb73-47"><a href="#cb73-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-48"><a href="#cb73-48" aria-hidden="true" tabindex="-1"></a><span class="co">#Permutation test to calculate p value</span></span>
<span id="cb73-49"><a href="#cb73-49" aria-hidden="true" tabindex="-1"></a>comb_data_RS<span class="ot">=</span><span class="fu">c</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>m_RS),</span>
<span id="cb73-50"><a href="#cb73-50" aria-hidden="true" tabindex="-1"></a>               DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_M[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>f_RS))</span>
<span id="cb73-51"><a href="#cb73-51" aria-hidden="true" tabindex="-1"></a>comb_data_BM<span class="ot">=</span><span class="fu">c</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>stder_BM_focal,</span>
<span id="cb73-52"><a href="#cb73-52" aria-hidden="true" tabindex="-1"></a>               DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>stder_BM_focal)</span>
<span id="cb73-53"><a href="#cb73-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-54"><a href="#cb73-54" aria-hidden="true" tabindex="-1"></a>diff.observed_large_pop <span class="ot">=</span> <span class="fu">cov</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>stder_BM_focal,DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>m_RS),<span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>) <span class="sc">-</span> <span class="fu">cov</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>stder_BM_focal,DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>f_RS),<span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>) </span>
<span id="cb73-55"><a href="#cb73-55" aria-hidden="true" tabindex="-1"></a>diff.observed_large_pop</span>
<span id="cb73-56"><a href="#cb73-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-57"><a href="#cb73-57" aria-hidden="true" tabindex="-1"></a>number_of_permutations <span class="ot">=</span> <span class="dv">100000</span></span>
<span id="cb73-58"><a href="#cb73-58" aria-hidden="true" tabindex="-1"></a>diff.random_large_pop <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb73-59"><a href="#cb73-59" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span> <span class="sc">:</span> number_of_permutations) {</span>
<span id="cb73-60"><a href="#cb73-60" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-61"><a href="#cb73-61" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Sample from the combined dataset</span></span>
<span id="cb73-62"><a href="#cb73-62" aria-hidden="true" tabindex="-1"></a>  a.random <span class="ot">=</span> <span class="fu">sample</span> (<span class="fu">na.omit</span>(comb_data_RS), <span class="fu">length</span>(<span class="fu">c</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>m_RS))), <span class="cn">TRUE</span>)</span>
<span id="cb73-63"><a href="#cb73-63" aria-hidden="true" tabindex="-1"></a>  b.random <span class="ot">=</span> <span class="fu">sample</span> (<span class="fu">na.omit</span>(comb_data_BM), <span class="fu">length</span>(<span class="fu">c</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>m_RS))), <span class="cn">TRUE</span>)</span>
<span id="cb73-64"><a href="#cb73-64" aria-hidden="true" tabindex="-1"></a>  c.random <span class="ot">=</span> <span class="fu">sample</span> (<span class="fu">na.omit</span>(comb_data_RS), <span class="fu">length</span>(<span class="fu">c</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>f_RS))), <span class="cn">TRUE</span>)</span>
<span id="cb73-65"><a href="#cb73-65" aria-hidden="true" tabindex="-1"></a>  d.random <span class="ot">=</span> <span class="fu">sample</span> (<span class="fu">na.omit</span>(comb_data_BM), <span class="fu">length</span>(<span class="fu">c</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>f_RS))), <span class="cn">TRUE</span>)</span>
<span id="cb73-66"><a href="#cb73-66" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-67"><a href="#cb73-67" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Null (permuated) difference</span></span>
<span id="cb73-68"><a href="#cb73-68" aria-hidden="true" tabindex="-1"></a>  diff.random_large_pop[i] <span class="ot">=</span> <span class="fu">cov</span>(b.random,a.random,<span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>) <span class="sc">-</span> <span class="fu">cov</span>(d.random,c.random,<span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb73-69"><a href="#cb73-69" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb73-70"><a href="#cb73-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-71"><a href="#cb73-71" aria-hidden="true" tabindex="-1"></a><span class="co"># P-value is the fraction of how many times the permuted difference is</span></span>
<span id="cb73-72"><a href="#cb73-72" aria-hidden="true" tabindex="-1"></a><span class="co"># equal or more extreme than the observed difference</span></span>
<span id="cb73-73"><a href="#cb73-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-74"><a href="#cb73-74" aria-hidden="true" tabindex="-1"></a>p_Sex_diff_large_pop <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">abs</span>(diff.random_large_pop) <span class="sc">&gt;=</span> <span class="fu">as.numeric</span>(<span class="fu">abs</span>(diff.observed_large_pop)))<span class="sc">/</span>   number_of_permutations</span>
<span id="cb73-75"><a href="#cb73-75" aria-hidden="true" tabindex="-1"></a>p_Sex_diff_large_pop</span>
<span id="cb73-76"><a href="#cb73-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-77"><a href="#cb73-77" aria-hidden="true" tabindex="-1"></a><span class="co">#Area ####</span></span>
<span id="cb73-78"><a href="#cb73-78" aria-hidden="true" tabindex="-1"></a><span class="co">#Large</span></span>
<span id="cb73-79"><a href="#cb73-79" aria-hidden="true" tabindex="-1"></a>Sex_diff_large_area<span class="ot">=</span><span class="fu">c</span>(boot_BW_males_area_large<span class="sc">$</span>t)<span class="sc">-</span><span class="fu">c</span>(boot_BW_females_area_large<span class="sc">$</span>t)</span>
<span id="cb73-80"><a href="#cb73-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-81"><a href="#cb73-81" aria-hidden="true" tabindex="-1"></a>t_Sex_diff_large_area<span class="ot">=</span><span class="fu">mean</span>(Sex_diff_large_area,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb73-82"><a href="#cb73-82" aria-hidden="true" tabindex="-1"></a>t_Sex_diff_large_area_lower<span class="ot">=</span><span class="fu">quantile</span>(Sex_diff_large_area,.<span class="dv">025</span>,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb73-83"><a href="#cb73-83" aria-hidden="true" tabindex="-1"></a>t_Sex_diff_large_area_upper<span class="ot">=</span><span class="fu">quantile</span>(Sex_diff_large_area,.<span class="dv">975</span>,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb73-84"><a href="#cb73-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-85"><a href="#cb73-85" aria-hidden="true" tabindex="-1"></a><span class="co">#Permutation test to calculate p value</span></span>
<span id="cb73-86"><a href="#cb73-86" aria-hidden="true" tabindex="-1"></a>comb_data_RS<span class="ot">=</span><span class="fu">c</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>m_RS),</span>
<span id="cb73-87"><a href="#cb73-87" aria-hidden="true" tabindex="-1"></a>               DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>f_RS))</span>
<span id="cb73-88"><a href="#cb73-88" aria-hidden="true" tabindex="-1"></a>comb_data_BM<span class="ot">=</span><span class="fu">c</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>stder_BM_focal,</span>
<span id="cb73-89"><a href="#cb73-89" aria-hidden="true" tabindex="-1"></a>               DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>stder_BM_focal)</span>
<span id="cb73-90"><a href="#cb73-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-91"><a href="#cb73-91" aria-hidden="true" tabindex="-1"></a>diff.observed_large_area <span class="ot">=</span> <span class="fu">cov</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>stder_BM_focal,DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>m_RS),<span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>) <span class="sc">-</span> <span class="fu">cov</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>stder_BM_focal,DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>f_RS),<span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>) </span>
<span id="cb73-92"><a href="#cb73-92" aria-hidden="true" tabindex="-1"></a>diff.observed_large_area</span>
<span id="cb73-93"><a href="#cb73-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-94"><a href="#cb73-94" aria-hidden="true" tabindex="-1"></a>number_of_permutations <span class="ot">=</span> <span class="dv">100000</span></span>
<span id="cb73-95"><a href="#cb73-95" aria-hidden="true" tabindex="-1"></a>diff.random_large_area <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb73-96"><a href="#cb73-96" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span> <span class="sc">:</span> number_of_permutations) {</span>
<span id="cb73-97"><a href="#cb73-97" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-98"><a href="#cb73-98" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Sample from the combined dataset</span></span>
<span id="cb73-99"><a href="#cb73-99" aria-hidden="true" tabindex="-1"></a>  a.random <span class="ot">=</span> <span class="fu">sample</span> (<span class="fu">na.omit</span>(comb_data_RS), <span class="fu">length</span>(<span class="fu">c</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>m_RS))), <span class="cn">TRUE</span>)</span>
<span id="cb73-100"><a href="#cb73-100" aria-hidden="true" tabindex="-1"></a>  b.random <span class="ot">=</span> <span class="fu">sample</span> (<span class="fu">na.omit</span>(comb_data_BM), <span class="fu">length</span>(<span class="fu">c</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>m_RS))), <span class="cn">TRUE</span>)</span>
<span id="cb73-101"><a href="#cb73-101" aria-hidden="true" tabindex="-1"></a>  c.random <span class="ot">=</span> <span class="fu">sample</span> (<span class="fu">na.omit</span>(comb_data_RS), <span class="fu">length</span>(<span class="fu">c</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>f_RS))), <span class="cn">TRUE</span>)</span>
<span id="cb73-102"><a href="#cb73-102" aria-hidden="true" tabindex="-1"></a>  d.random <span class="ot">=</span> <span class="fu">sample</span> (<span class="fu">na.omit</span>(comb_data_BM), <span class="fu">length</span>(<span class="fu">c</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>f_RS))), <span class="cn">TRUE</span>)</span>
<span id="cb73-103"><a href="#cb73-103" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-104"><a href="#cb73-104" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Null (permuated) difference</span></span>
<span id="cb73-105"><a href="#cb73-105" aria-hidden="true" tabindex="-1"></a>  diff.random_large_area[i] <span class="ot">=</span> <span class="fu">cov</span>(b.random,a.random,<span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>) <span class="sc">-</span> <span class="fu">cov</span>(d.random,c.random,<span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb73-106"><a href="#cb73-106" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb73-107"><a href="#cb73-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-108"><a href="#cb73-108" aria-hidden="true" tabindex="-1"></a><span class="co"># P-value is the fraction of how many times the permuted difference is</span></span>
<span id="cb73-109"><a href="#cb73-109" aria-hidden="true" tabindex="-1"></a><span class="co"># equal or more extreme than the observed difference</span></span>
<span id="cb73-110"><a href="#cb73-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-111"><a href="#cb73-111" aria-hidden="true" tabindex="-1"></a>p_Sex_diff_large_area <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">abs</span>(diff.random_large_area) <span class="sc">&gt;=</span> <span class="fu">as.numeric</span>(<span class="fu">abs</span>(diff.observed_large_area)))<span class="sc">/</span>   number_of_permutations</span>
<span id="cb73-112"><a href="#cb73-112" aria-hidden="true" tabindex="-1"></a>p_Sex_diff_large_area</span>
<span id="cb73-113"><a href="#cb73-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-114"><a href="#cb73-114" aria-hidden="true" tabindex="-1"></a><span class="co">#Small</span></span>
<span id="cb73-115"><a href="#cb73-115" aria-hidden="true" tabindex="-1"></a>Sex_diff_small_area<span class="ot">=</span><span class="fu">c</span>(boot_BW_males_area_small<span class="sc">$</span>t)<span class="sc">-</span><span class="fu">c</span>(boot_BW_females_area_small<span class="sc">$</span>t)</span>
<span id="cb73-116"><a href="#cb73-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-117"><a href="#cb73-117" aria-hidden="true" tabindex="-1"></a>t_Sex_diff_small_area<span class="ot">=</span><span class="fu">mean</span>(Sex_diff_small_area,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb73-118"><a href="#cb73-118" aria-hidden="true" tabindex="-1"></a>t_Sex_diff_small_area_lower<span class="ot">=</span><span class="fu">quantile</span>(Sex_diff_small_area,.<span class="dv">025</span>,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb73-119"><a href="#cb73-119" aria-hidden="true" tabindex="-1"></a>t_Sex_diff_small_area_upper<span class="ot">=</span><span class="fu">quantile</span>(Sex_diff_small_area,.<span class="dv">975</span>,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb73-120"><a href="#cb73-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-121"><a href="#cb73-121" aria-hidden="true" tabindex="-1"></a><span class="co">#Permutation test to calculate p value</span></span>
<span id="cb73-122"><a href="#cb73-122" aria-hidden="true" tabindex="-1"></a>comb_data_RS<span class="ot">=</span><span class="fu">c</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>m_RS),</span>
<span id="cb73-123"><a href="#cb73-123" aria-hidden="true" tabindex="-1"></a>               DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>f_RS))</span>
<span id="cb73-124"><a href="#cb73-124" aria-hidden="true" tabindex="-1"></a>comb_data_BM<span class="ot">=</span><span class="fu">c</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>stder_BM_focal,</span>
<span id="cb73-125"><a href="#cb73-125" aria-hidden="true" tabindex="-1"></a>               DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>stder_BM_focal)</span>
<span id="cb73-126"><a href="#cb73-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-127"><a href="#cb73-127" aria-hidden="true" tabindex="-1"></a>diff.observed_small_area <span class="ot">=</span> <span class="fu">cov</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>stder_BM_focal,DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>m_RS),<span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>) <span class="sc">-</span> <span class="fu">cov</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>stder_BM_focal,DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>f_RS),<span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>) </span>
<span id="cb73-128"><a href="#cb73-128" aria-hidden="true" tabindex="-1"></a>diff.observed_small_area</span>
<span id="cb73-129"><a href="#cb73-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-130"><a href="#cb73-130" aria-hidden="true" tabindex="-1"></a>number_of_permutations <span class="ot">=</span> <span class="dv">100000</span></span>
<span id="cb73-131"><a href="#cb73-131" aria-hidden="true" tabindex="-1"></a>diff.random_small_area <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb73-132"><a href="#cb73-132" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span> <span class="sc">:</span> number_of_permutations) {</span>
<span id="cb73-133"><a href="#cb73-133" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-134"><a href="#cb73-134" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Sample from the combined dataset</span></span>
<span id="cb73-135"><a href="#cb73-135" aria-hidden="true" tabindex="-1"></a>  a.random <span class="ot">=</span> <span class="fu">sample</span> (<span class="fu">na.omit</span>(comb_data_RS), <span class="fu">length</span>(<span class="fu">c</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>m_RS))), <span class="cn">TRUE</span>)</span>
<span id="cb73-136"><a href="#cb73-136" aria-hidden="true" tabindex="-1"></a>  b.random <span class="ot">=</span> <span class="fu">sample</span> (<span class="fu">na.omit</span>(comb_data_BM), <span class="fu">length</span>(<span class="fu">c</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>m_RS))), <span class="cn">TRUE</span>)</span>
<span id="cb73-137"><a href="#cb73-137" aria-hidden="true" tabindex="-1"></a>  c.random <span class="ot">=</span> <span class="fu">sample</span> (<span class="fu">na.omit</span>(comb_data_RS), <span class="fu">length</span>(<span class="fu">c</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>f_RS))), <span class="cn">TRUE</span>)</span>
<span id="cb73-138"><a href="#cb73-138" aria-hidden="true" tabindex="-1"></a>  d.random <span class="ot">=</span> <span class="fu">sample</span> (<span class="fu">na.omit</span>(comb_data_BM), <span class="fu">length</span>(<span class="fu">c</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>f_RS))), <span class="cn">TRUE</span>)</span>
<span id="cb73-139"><a href="#cb73-139" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-140"><a href="#cb73-140" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Null (permuated) difference</span></span>
<span id="cb73-141"><a href="#cb73-141" aria-hidden="true" tabindex="-1"></a>  diff.random_small_area[i] <span class="ot">=</span> <span class="fu">cov</span>(b.random,a.random,<span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>) <span class="sc">-</span> <span class="fu">cov</span>(d.random,c.random,<span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb73-142"><a href="#cb73-142" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb73-143"><a href="#cb73-143" aria-hidden="true" tabindex="-1"></a><span class="co"># P-value is the fraction of how many times the permuted difference is</span></span>
<span id="cb73-144"><a href="#cb73-144" aria-hidden="true" tabindex="-1"></a><span class="co"># equal or more extreme than the observed difference</span></span>
<span id="cb73-145"><a href="#cb73-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-146"><a href="#cb73-146" aria-hidden="true" tabindex="-1"></a>p_Sex_diff_small_area <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">abs</span>(diff.random_small_area) <span class="sc">&gt;=</span> <span class="fu">as.numeric</span>(<span class="fu">abs</span>(diff.observed_small_area)))<span class="sc">/</span>   number_of_permutations</span>
<span id="cb73-147"><a href="#cb73-147" aria-hidden="true" tabindex="-1"></a>p_Sex_diff_small_area</span>
<span id="cb73-148"><a href="#cb73-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-149"><a href="#cb73-149" aria-hidden="true" tabindex="-1"></a><span class="co"># Treatment bias ####</span></span>
<span id="cb73-150"><a href="#cb73-150" aria-hidden="true" tabindex="-1"></a><span class="co"># Group size ####</span></span>
<span id="cb73-151"><a href="#cb73-151" aria-hidden="true" tabindex="-1"></a><span class="co"># Males</span></span>
<span id="cb73-152"><a href="#cb73-152" aria-hidden="true" tabindex="-1"></a>Treat_diff_male_pop<span class="ot">=</span><span class="fu">c</span>(boot_BW_males_group_size_large<span class="sc">$</span>t)<span class="sc">-</span><span class="fu">c</span>(boot_BW_males_group_size_small<span class="sc">$</span>t)</span>
<span id="cb73-153"><a href="#cb73-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-154"><a href="#cb73-154" aria-hidden="true" tabindex="-1"></a>t_Treat_diff_male_pop<span class="ot">=</span><span class="fu">mean</span>(Treat_diff_male_pop,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb73-155"><a href="#cb73-155" aria-hidden="true" tabindex="-1"></a>t_Treat_diff_male_pop_lower<span class="ot">=</span><span class="fu">quantile</span>(Treat_diff_male_pop,.<span class="dv">025</span>,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb73-156"><a href="#cb73-156" aria-hidden="true" tabindex="-1"></a>t_Treat_diff_male_pop_upper<span class="ot">=</span><span class="fu">quantile</span>(Treat_diff_male_pop,.<span class="dv">975</span>,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb73-157"><a href="#cb73-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-158"><a href="#cb73-158" aria-hidden="true" tabindex="-1"></a><span class="co">#Permutation test to calculate p value</span></span>
<span id="cb73-159"><a href="#cb73-159" aria-hidden="true" tabindex="-1"></a>comb_data_RS<span class="ot">=</span><span class="fu">c</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>m_RS),</span>
<span id="cb73-160"><a href="#cb73-160" aria-hidden="true" tabindex="-1"></a>               DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>m_RS))</span>
<span id="cb73-161"><a href="#cb73-161" aria-hidden="true" tabindex="-1"></a>comb_data_BM<span class="ot">=</span><span class="fu">c</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>stder_BM_focal,</span>
<span id="cb73-162"><a href="#cb73-162" aria-hidden="true" tabindex="-1"></a>               DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>stder_BM_focal)</span>
<span id="cb73-163"><a href="#cb73-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-164"><a href="#cb73-164" aria-hidden="true" tabindex="-1"></a>diff.observed_male_pop <span class="ot">=</span> <span class="fu">cov</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>stder_BM_focal,DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>m_RS),<span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>) <span class="sc">-</span> <span class="fu">cov</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>stder_BM_focal,DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>m_RS),<span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>) </span>
<span id="cb73-165"><a href="#cb73-165" aria-hidden="true" tabindex="-1"></a>diff.observed_male_pop</span>
<span id="cb73-166"><a href="#cb73-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-167"><a href="#cb73-167" aria-hidden="true" tabindex="-1"></a>number_of_permutations <span class="ot">=</span> <span class="dv">100000</span></span>
<span id="cb73-168"><a href="#cb73-168" aria-hidden="true" tabindex="-1"></a>diff.random_male_pop <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb73-169"><a href="#cb73-169" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span> <span class="sc">:</span> number_of_permutations) {</span>
<span id="cb73-170"><a href="#cb73-170" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-171"><a href="#cb73-171" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Sample from the combined dataset</span></span>
<span id="cb73-172"><a href="#cb73-172" aria-hidden="true" tabindex="-1"></a>  a.random <span class="ot">=</span> <span class="fu">sample</span> (<span class="fu">na.omit</span>(comb_data_RS), <span class="fu">length</span>(<span class="fu">c</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>m_RS))), <span class="cn">TRUE</span>)</span>
<span id="cb73-173"><a href="#cb73-173" aria-hidden="true" tabindex="-1"></a>  b.random <span class="ot">=</span> <span class="fu">sample</span> (<span class="fu">na.omit</span>(comb_data_BM), <span class="fu">length</span>(<span class="fu">c</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>m_RS))), <span class="cn">TRUE</span>)</span>
<span id="cb73-174"><a href="#cb73-174" aria-hidden="true" tabindex="-1"></a>  c.random <span class="ot">=</span> <span class="fu">sample</span> (<span class="fu">na.omit</span>(comb_data_RS), <span class="fu">length</span>(<span class="fu">c</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>m_RS))), <span class="cn">TRUE</span>)</span>
<span id="cb73-175"><a href="#cb73-175" aria-hidden="true" tabindex="-1"></a>  d.random <span class="ot">=</span> <span class="fu">sample</span> (<span class="fu">na.omit</span>(comb_data_BM), <span class="fu">length</span>(<span class="fu">c</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>m_RS))), <span class="cn">TRUE</span>)</span>
<span id="cb73-176"><a href="#cb73-176" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-177"><a href="#cb73-177" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Null (permuated) difference</span></span>
<span id="cb73-178"><a href="#cb73-178" aria-hidden="true" tabindex="-1"></a>  diff.random_male_pop[i] <span class="ot">=</span> <span class="fu">cov</span>(b.random,a.random,<span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>) <span class="sc">-</span> <span class="fu">cov</span>(d.random,c.random,<span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb73-179"><a href="#cb73-179" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb73-180"><a href="#cb73-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-181"><a href="#cb73-181" aria-hidden="true" tabindex="-1"></a><span class="co"># P-value is the fraction of how many times the permuted difference is</span></span>
<span id="cb73-182"><a href="#cb73-182" aria-hidden="true" tabindex="-1"></a><span class="co"># equal or more extreme than the observed difference</span></span>
<span id="cb73-183"><a href="#cb73-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-184"><a href="#cb73-184" aria-hidden="true" tabindex="-1"></a>p_Treat_diff_male_pop <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">abs</span>(diff.random_male_pop) <span class="sc">&gt;=</span> <span class="fu">as.numeric</span>(<span class="fu">abs</span>(diff.observed_male_pop)))<span class="sc">/</span>   number_of_permutations</span>
<span id="cb73-185"><a href="#cb73-185" aria-hidden="true" tabindex="-1"></a>p_Treat_diff_male_pop</span>
<span id="cb73-186"><a href="#cb73-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-187"><a href="#cb73-187" aria-hidden="true" tabindex="-1"></a><span class="co"># Females</span></span>
<span id="cb73-188"><a href="#cb73-188" aria-hidden="true" tabindex="-1"></a>Treat_diff_female_pop<span class="ot">=</span><span class="fu">c</span>(boot_BW_females_group_size_large<span class="sc">$</span>t)<span class="sc">-</span><span class="fu">c</span>(boot_BW_females_group_size_small<span class="sc">$</span>t)</span>
<span id="cb73-189"><a href="#cb73-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-190"><a href="#cb73-190" aria-hidden="true" tabindex="-1"></a>t_Treat_diff_female_pop<span class="ot">=</span><span class="fu">mean</span>(Treat_diff_female_pop,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb73-191"><a href="#cb73-191" aria-hidden="true" tabindex="-1"></a>t_Treat_diff_female_pop_lower<span class="ot">=</span><span class="fu">quantile</span>(Treat_diff_female_pop,.<span class="dv">025</span>,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb73-192"><a href="#cb73-192" aria-hidden="true" tabindex="-1"></a>t_Treat_diff_female_pop_upper<span class="ot">=</span><span class="fu">quantile</span>(Treat_diff_female_pop,.<span class="dv">975</span>,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb73-193"><a href="#cb73-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-194"><a href="#cb73-194" aria-hidden="true" tabindex="-1"></a><span class="co">#Permutation test to calculate p value</span></span>
<span id="cb73-195"><a href="#cb73-195" aria-hidden="true" tabindex="-1"></a>comb_data_RS<span class="ot">=</span><span class="fu">c</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>f_RS),</span>
<span id="cb73-196"><a href="#cb73-196" aria-hidden="true" tabindex="-1"></a>               DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>f_RS))</span>
<span id="cb73-197"><a href="#cb73-197" aria-hidden="true" tabindex="-1"></a>comb_data_BM<span class="ot">=</span><span class="fu">c</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>stder_BM_focal,</span>
<span id="cb73-198"><a href="#cb73-198" aria-hidden="true" tabindex="-1"></a>               DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>stder_BM_focal)</span>
<span id="cb73-199"><a href="#cb73-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-200"><a href="#cb73-200" aria-hidden="true" tabindex="-1"></a>diff.observed_female_pop <span class="ot">=</span> <span class="fu">cov</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>stder_BM_focal,DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>f_RS),<span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>) <span class="sc">-</span> <span class="fu">cov</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>stder_BM_focal,DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>f_RS),<span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>) </span>
<span id="cb73-201"><a href="#cb73-201" aria-hidden="true" tabindex="-1"></a>diff.observed_female_pop</span>
<span id="cb73-202"><a href="#cb73-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-203"><a href="#cb73-203" aria-hidden="true" tabindex="-1"></a>number_of_permutations <span class="ot">=</span> <span class="dv">100000</span></span>
<span id="cb73-204"><a href="#cb73-204" aria-hidden="true" tabindex="-1"></a>diff.random_female_pop <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb73-205"><a href="#cb73-205" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span> <span class="sc">:</span> number_of_permutations) {</span>
<span id="cb73-206"><a href="#cb73-206" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-207"><a href="#cb73-207" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Sample from the combined dataset</span></span>
<span id="cb73-208"><a href="#cb73-208" aria-hidden="true" tabindex="-1"></a>  a.random <span class="ot">=</span> <span class="fu">sample</span> (<span class="fu">na.omit</span>(comb_data_RS), <span class="fu">length</span>(<span class="fu">c</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>f_RS))), <span class="cn">TRUE</span>)</span>
<span id="cb73-209"><a href="#cb73-209" aria-hidden="true" tabindex="-1"></a>  b.random <span class="ot">=</span> <span class="fu">sample</span> (<span class="fu">na.omit</span>(comb_data_BM), <span class="fu">length</span>(<span class="fu">c</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;LG&#39;</span>,]<span class="sc">$</span>f_RS))), <span class="cn">TRUE</span>)</span>
<span id="cb73-210"><a href="#cb73-210" aria-hidden="true" tabindex="-1"></a>  c.random <span class="ot">=</span> <span class="fu">sample</span> (<span class="fu">na.omit</span>(comb_data_RS), <span class="fu">length</span>(<span class="fu">c</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>f_RS))), <span class="cn">TRUE</span>)</span>
<span id="cb73-211"><a href="#cb73-211" aria-hidden="true" tabindex="-1"></a>  d.random <span class="ot">=</span> <span class="fu">sample</span> (<span class="fu">na.omit</span>(comb_data_BM), <span class="fu">length</span>(<span class="fu">c</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Gr_size<span class="sc">==</span><span class="st">&#39;SG&#39;</span>,]<span class="sc">$</span>f_RS))), <span class="cn">TRUE</span>)</span>
<span id="cb73-212"><a href="#cb73-212" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-213"><a href="#cb73-213" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Null (permuated) difference</span></span>
<span id="cb73-214"><a href="#cb73-214" aria-hidden="true" tabindex="-1"></a>  diff.random_female_pop[i] <span class="ot">=</span> <span class="fu">cov</span>(b.random,a.random,<span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>) <span class="sc">-</span> <span class="fu">cov</span>(d.random,c.random,<span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb73-215"><a href="#cb73-215" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb73-216"><a href="#cb73-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-217"><a href="#cb73-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-218"><a href="#cb73-218" aria-hidden="true" tabindex="-1"></a><span class="co"># P-value is the fraction of how many times the permuted difference is</span></span>
<span id="cb73-219"><a href="#cb73-219" aria-hidden="true" tabindex="-1"></a><span class="co"># equal or more extreme than the observed difference</span></span>
<span id="cb73-220"><a href="#cb73-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-221"><a href="#cb73-221" aria-hidden="true" tabindex="-1"></a>p_Treat_diff_female_pop <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">abs</span>(diff.random_female_pop) <span class="sc">&gt;=</span> <span class="fu">as.numeric</span>(<span class="fu">abs</span>(diff.observed_female_pop)))<span class="sc">/</span>   number_of_permutations</span>
<span id="cb73-222"><a href="#cb73-222" aria-hidden="true" tabindex="-1"></a>p_Treat_diff_female_pop</span>
<span id="cb73-223"><a href="#cb73-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-224"><a href="#cb73-224" aria-hidden="true" tabindex="-1"></a><span class="co"># Area ####</span></span>
<span id="cb73-225"><a href="#cb73-225" aria-hidden="true" tabindex="-1"></a><span class="co"># Males</span></span>
<span id="cb73-226"><a href="#cb73-226" aria-hidden="true" tabindex="-1"></a>Treat_diff_male_area<span class="ot">=</span><span class="fu">c</span>(boot_BW_males_area_large<span class="sc">$</span>t)<span class="sc">-</span><span class="fu">c</span>(boot_BW_males_area_small<span class="sc">$</span>t)</span>
<span id="cb73-227"><a href="#cb73-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-228"><a href="#cb73-228" aria-hidden="true" tabindex="-1"></a>t_Treat_diff_male_area<span class="ot">=</span><span class="fu">mean</span>(Treat_diff_male_area,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb73-229"><a href="#cb73-229" aria-hidden="true" tabindex="-1"></a>t_Treat_diff_male_area_lower<span class="ot">=</span><span class="fu">quantile</span>(Treat_diff_male_area,.<span class="dv">025</span>,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb73-230"><a href="#cb73-230" aria-hidden="true" tabindex="-1"></a>t_Treat_diff_male_area_upper<span class="ot">=</span><span class="fu">quantile</span>(Treat_diff_male_area,.<span class="dv">975</span>,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb73-231"><a href="#cb73-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-232"><a href="#cb73-232" aria-hidden="true" tabindex="-1"></a><span class="co">#Permutation test to calculate p value</span></span>
<span id="cb73-233"><a href="#cb73-233" aria-hidden="true" tabindex="-1"></a>comb_data_RS<span class="ot">=</span><span class="fu">c</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>m_RS),</span>
<span id="cb73-234"><a href="#cb73-234" aria-hidden="true" tabindex="-1"></a>               DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>m_RS))</span>
<span id="cb73-235"><a href="#cb73-235" aria-hidden="true" tabindex="-1"></a>comb_data_BM<span class="ot">=</span><span class="fu">c</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>stder_BM_focal,</span>
<span id="cb73-236"><a href="#cb73-236" aria-hidden="true" tabindex="-1"></a>               DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>stder_BM_focal)</span>
<span id="cb73-237"><a href="#cb73-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-238"><a href="#cb73-238" aria-hidden="true" tabindex="-1"></a>diff.observed_male_area <span class="ot">=</span> <span class="fu">cov</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>stder_BM_focal,DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>m_RS),<span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>) <span class="sc">-</span> <span class="fu">cov</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>stder_BM_focal,DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>m_RS),<span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>) </span>
<span id="cb73-239"><a href="#cb73-239" aria-hidden="true" tabindex="-1"></a>diff.observed_male_area</span>
<span id="cb73-240"><a href="#cb73-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-241"><a href="#cb73-241" aria-hidden="true" tabindex="-1"></a>number_of_permutations <span class="ot">=</span> <span class="dv">100000</span></span>
<span id="cb73-242"><a href="#cb73-242" aria-hidden="true" tabindex="-1"></a>diff.random_male_area <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb73-243"><a href="#cb73-243" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span> <span class="sc">:</span> number_of_permutations) {</span>
<span id="cb73-244"><a href="#cb73-244" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-245"><a href="#cb73-245" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Sample from the combined dataset</span></span>
<span id="cb73-246"><a href="#cb73-246" aria-hidden="true" tabindex="-1"></a>  a.random <span class="ot">=</span> <span class="fu">sample</span> (<span class="fu">na.omit</span>(comb_data_RS), <span class="fu">length</span>(<span class="fu">c</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>m_RS))), <span class="cn">TRUE</span>)</span>
<span id="cb73-247"><a href="#cb73-247" aria-hidden="true" tabindex="-1"></a>  b.random <span class="ot">=</span> <span class="fu">sample</span> (<span class="fu">na.omit</span>(comb_data_BM), <span class="fu">length</span>(<span class="fu">c</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>m_RS))), <span class="cn">TRUE</span>)</span>
<span id="cb73-248"><a href="#cb73-248" aria-hidden="true" tabindex="-1"></a>  c.random <span class="ot">=</span> <span class="fu">sample</span> (<span class="fu">na.omit</span>(comb_data_RS), <span class="fu">length</span>(<span class="fu">c</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>m_RS))), <span class="cn">TRUE</span>)</span>
<span id="cb73-249"><a href="#cb73-249" aria-hidden="true" tabindex="-1"></a>  d.random <span class="ot">=</span> <span class="fu">sample</span> (<span class="fu">na.omit</span>(comb_data_BM), <span class="fu">length</span>(<span class="fu">c</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>m_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_M[DB_data_clean_M<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>m_RS))), <span class="cn">TRUE</span>)</span>
<span id="cb73-250"><a href="#cb73-250" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-251"><a href="#cb73-251" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Null (permuated) difference</span></span>
<span id="cb73-252"><a href="#cb73-252" aria-hidden="true" tabindex="-1"></a>  diff.random_male_area[i] <span class="ot">=</span> <span class="fu">cov</span>(b.random,a.random,<span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>) <span class="sc">-</span> <span class="fu">cov</span>(d.random,c.random,<span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb73-253"><a href="#cb73-253" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb73-254"><a href="#cb73-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-255"><a href="#cb73-255" aria-hidden="true" tabindex="-1"></a><span class="co"># P-value is the fraction of how many times the permuted difference is</span></span>
<span id="cb73-256"><a href="#cb73-256" aria-hidden="true" tabindex="-1"></a><span class="co"># equal or more extreme than the observed difference</span></span>
<span id="cb73-257"><a href="#cb73-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-258"><a href="#cb73-258" aria-hidden="true" tabindex="-1"></a>p_Treat_diff_male_area <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">abs</span>(diff.random_male_area) <span class="sc">&gt;=</span> <span class="fu">as.numeric</span>(<span class="fu">abs</span>(diff.observed_male_area)))<span class="sc">/</span>   number_of_permutations</span>
<span id="cb73-259"><a href="#cb73-259" aria-hidden="true" tabindex="-1"></a>p_Treat_diff_male_area</span>
<span id="cb73-260"><a href="#cb73-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-261"><a href="#cb73-261" aria-hidden="true" tabindex="-1"></a><span class="co"># Females</span></span>
<span id="cb73-262"><a href="#cb73-262" aria-hidden="true" tabindex="-1"></a>Treat_diff_female_area<span class="ot">=</span><span class="fu">c</span>(boot_BW_females_area_large<span class="sc">$</span>t)<span class="sc">-</span><span class="fu">c</span>(boot_BW_females_area_small<span class="sc">$</span>t)</span>
<span id="cb73-263"><a href="#cb73-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-264"><a href="#cb73-264" aria-hidden="true" tabindex="-1"></a>t_Treat_diff_female_area<span class="ot">=</span><span class="fu">mean</span>(Treat_diff_female_area,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb73-265"><a href="#cb73-265" aria-hidden="true" tabindex="-1"></a>t_Treat_diff_female_area_lower<span class="ot">=</span><span class="fu">quantile</span>(Treat_diff_female_area,.<span class="dv">025</span>,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb73-266"><a href="#cb73-266" aria-hidden="true" tabindex="-1"></a>t_Treat_diff_female_area_upper<span class="ot">=</span><span class="fu">quantile</span>(Treat_diff_female_area,.<span class="dv">975</span>,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb73-267"><a href="#cb73-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-268"><a href="#cb73-268" aria-hidden="true" tabindex="-1"></a><span class="co">#Permutation test to calculate p value</span></span>
<span id="cb73-269"><a href="#cb73-269" aria-hidden="true" tabindex="-1"></a>comb_data_RS<span class="ot">=</span><span class="fu">c</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>f_RS),</span>
<span id="cb73-270"><a href="#cb73-270" aria-hidden="true" tabindex="-1"></a>               DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>f_RS))</span>
<span id="cb73-271"><a href="#cb73-271" aria-hidden="true" tabindex="-1"></a>comb_data_BM<span class="ot">=</span><span class="fu">c</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>stder_BM_focal,</span>
<span id="cb73-272"><a href="#cb73-272" aria-hidden="true" tabindex="-1"></a>               DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>stder_BM_focal)</span>
<span id="cb73-273"><a href="#cb73-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-274"><a href="#cb73-274" aria-hidden="true" tabindex="-1"></a>diff.observed_female_area <span class="ot">=</span> <span class="fu">cov</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>stder_BM_focal,DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>f_RS),<span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>) <span class="sc">-</span> <span class="fu">cov</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>stder_BM_focal,DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>f_RS),<span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>) </span>
<span id="cb73-275"><a href="#cb73-275" aria-hidden="true" tabindex="-1"></a>diff.observed_female_area</span>
<span id="cb73-276"><a href="#cb73-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-277"><a href="#cb73-277" aria-hidden="true" tabindex="-1"></a>number_of_permutations <span class="ot">=</span> <span class="dv">100000</span></span>
<span id="cb73-278"><a href="#cb73-278" aria-hidden="true" tabindex="-1"></a>diff.random_female_area <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb73-279"><a href="#cb73-279" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span> <span class="sc">:</span> number_of_permutations) {</span>
<span id="cb73-280"><a href="#cb73-280" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-281"><a href="#cb73-281" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Sample from the combined dataset</span></span>
<span id="cb73-282"><a href="#cb73-282" aria-hidden="true" tabindex="-1"></a>  a.random <span class="ot">=</span> <span class="fu">sample</span> (<span class="fu">na.omit</span>(comb_data_RS), <span class="fu">length</span>(<span class="fu">c</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>f_RS))), <span class="cn">TRUE</span>)</span>
<span id="cb73-283"><a href="#cb73-283" aria-hidden="true" tabindex="-1"></a>  b.random <span class="ot">=</span> <span class="fu">sample</span> (<span class="fu">na.omit</span>(comb_data_BM), <span class="fu">length</span>(<span class="fu">c</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Small&#39;</span>,]<span class="sc">$</span>f_RS))), <span class="cn">TRUE</span>)</span>
<span id="cb73-284"><a href="#cb73-284" aria-hidden="true" tabindex="-1"></a>  c.random <span class="ot">=</span> <span class="fu">sample</span> (<span class="fu">na.omit</span>(comb_data_RS), <span class="fu">length</span>(<span class="fu">c</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>f_RS))), <span class="cn">TRUE</span>)</span>
<span id="cb73-285"><a href="#cb73-285" aria-hidden="true" tabindex="-1"></a>  d.random <span class="ot">=</span> <span class="fu">sample</span> (<span class="fu">na.omit</span>(comb_data_BM), <span class="fu">length</span>(<span class="fu">c</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>f_RS<span class="sc">/</span><span class="fu">mean</span>(DB_data_clean_F[DB_data_clean_F<span class="sc">$</span>Area<span class="sc">==</span><span class="st">&#39;Large&#39;</span>,]<span class="sc">$</span>f_RS))), <span class="cn">TRUE</span>)</span>
<span id="cb73-286"><a href="#cb73-286" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-287"><a href="#cb73-287" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Null (permuated) difference</span></span>
<span id="cb73-288"><a href="#cb73-288" aria-hidden="true" tabindex="-1"></a>  diff.random_female_area[i] <span class="ot">=</span> <span class="fu">cov</span>(b.random,a.random,<span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>) <span class="sc">-</span> <span class="fu">cov</span>(d.random,c.random,<span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb73-289"><a href="#cb73-289" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb73-290"><a href="#cb73-290" aria-hidden="true" tabindex="-1"></a><span class="co"># P-value is the fraction of how many times the permuted difference is</span></span>
<span id="cb73-291"><a href="#cb73-291" aria-hidden="true" tabindex="-1"></a><span class="co"># equal or more extreme than the observed difference</span></span>
<span id="cb73-292"><a href="#cb73-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-293"><a href="#cb73-293" aria-hidden="true" tabindex="-1"></a>p_Treat_diff_female_area <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">abs</span>(diff.random_female_area) <span class="sc">&gt;=</span> <span class="fu">as.numeric</span>(<span class="fu">abs</span>(diff.observed_female_area)))<span class="sc">/</span>   number_of_permutations</span>
<span id="cb73-294"><a href="#cb73-294" aria-hidden="true" tabindex="-1"></a>p_Treat_diff_female_area</span></code></pre></div>
<p>Sex difference in small group size treatment: <br> p=</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>p_Sex_diff_Small_pop</span></code></pre></div>
<pre><code>[1] 0.82309</code></pre>
<p>Sex difference in large group size treatment: <br> p=</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>p_Sex_diff_large_pop</span></code></pre></div>
<pre><code>[1] 0.20426</code></pre>
<p>Sex difference in large area treatment: <br> p=</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>p_Sex_diff_large_area</span></code></pre></div>
<pre><code>[1] 0.66058</code></pre>
<p>Sex difference in small area treatment: <br> p=</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>p_Sex_diff_small_area</span></code></pre></div>
<pre><code>[1] 0.1184</code></pre>
<p>Treatment difference in group size treatment for males: <br> p=</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>p_Treat_diff_male_pop</span></code></pre></div>
<pre><code>[1] 0.11652</code></pre>
<p>Treatment difference in group size treatment for females: <br> p=</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>p_Treat_diff_female_pop</span></code></pre></div>
<pre><code>[1] 0.05831</code></pre>
<p>Treatment difference in area treatment for males: <br> p=</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>p_Treat_diff_male_area</span></code></pre></div>
<pre><code>[1] 0.57268</code></pre>
<p>Treatment difference in area treatment for females: <br> p=</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>p_Treat_diff_female_area</span></code></pre></div>
<pre><code>[1] 0.45154</code></pre>
</div>
<div id="repeatability" class="section level1">
<h1>Repeatability</h1>
<p>Repeatability of body mass measures.<br> Intra-class correlation
coefficient:<br> - Males</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ICCest</span>(DB_data<span class="sc">$</span>Body_mass_mg_focal[DB_data<span class="sc">$</span>Sex<span class="sc">==</span><span class="st">&#39;M&#39;</span>], DB_data<span class="sc">$</span>Mass_reproducibility_mg_focal[DB_data<span class="sc">$</span>Sex<span class="sc">==</span><span class="st">&#39;M&#39;</span>])</span></code></pre></div>
<pre><code>NAs removed from rows:
 1 2 3 4 5 6 7 10 13 14 16 17 18 19 20 21 22 23 24 26 27 28 29 30 32 33 34 35 37 38 39 40 43 44 45 47 48 50 51 52 53 55 56 57 58 59 60 61 62 63 64 65 68 69 71 72 75 76 77 83 84 86 89 91 95 96 97 99 103 105 107 108 110 111 112 113 114 115 116 117 119 120 122 123 124 125 127 128 129 130 131 133 134 135 136 137 139 140 141 144 145 146 147 148 </code></pre>
<pre><code>$ICC
[1] 0.9809211

$LowerCI
[1] 0.9441615

$UpperCI
[1] 0.9920126

$N
[1] 32

$k
[1] 1.366569

$varw
[1] 0.0006763889

$vara
[1] 0.0347759</code></pre>
<ul>
<li>Females</li>
</ul>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ICCest</span>(DB_data<span class="sc">$</span>Body_mass_mg_focal[DB_data<span class="sc">$</span>Sex<span class="sc">==</span><span class="st">&#39;F&#39;</span>], DB_data<span class="sc">$</span>Mass_reproducibility_mg_focal[DB_data<span class="sc">$</span>Sex<span class="sc">==</span><span class="st">&#39;F&#39;</span>])</span></code></pre></div>
<pre><code>NAs removed from rows:
 1 2 3 4 5 6 7 8 9 10 11 12 13 14 16 17 18 21 22 23 24 25 26 27 28 30 31 32 37 39 40 41 43 44 50 53 61 62 63 64 65 66 68 69 70 72 73 76 77 78 79 80 81 82 83 84 86 87 88 90 91 92 93 94 95 96 97 98 99 100 101 104 105 106 107 108 109 110 112 113 114 116 117 120 121 122 124 126 127 128 </code></pre>
<pre><code>$ICC
[1] 0.9800911

$LowerCI
[1] 0.9383238

$UpperCI
[1] 0.9919915

$N
[1] 29

$k
[1] 1.369643

$varw
[1] 0.0008924242

$vara
[1] 0.04393306</code></pre>
<br>
<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-sessioninfo" data-toggle="collapse" data-target="#workflowr-sessioninfo" style="display: block;">
<span class="glyphicon glyphicon-wrench" aria-hidden="true"></span>
Session information
</button>
</p>
<div id="workflowr-sessioninfo" class="collapse">
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code></pre></div>
<pre><code>R version 4.2.0 (2022-04-22 ucrt)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 10 x64 (build 19043)

Matrix products: default

locale:
[1] LC_COLLATE=German_Germany.utf8  LC_CTYPE=German_Germany.utf8   
[3] LC_MONETARY=German_Germany.utf8 LC_NUMERIC=C                   
[5] LC_TIME=German_Germany.utf8    

attached base packages:
[1] grid      stats     graphics  grDevices utils     datasets  methods  
[8] base     

other attached packages:
 [1] ICC_2.4.0          tidyr_1.2.0        data.table_1.14.2  boot_1.3-28       
 [5] RColorBrewer_1.1-3 car_3.1-0          carData_3.0-5      gridGraphics_0.5-1
 [9] cowplot_1.1.1      EnvStats_2.7.0     dplyr_1.0.9        readr_2.1.2       
[13] lmerTest_3.1-3     lme4_1.1-30        Matrix_1.4-1       gridExtra_2.3     
[17] ggplot2_3.3.6      ggeffects_1.1.3    workflowr_1.7.0   

loaded via a namespace (and not attached):
 [1] httr_1.4.3          sass_0.4.2          bit64_4.0.5        
 [4] vroom_1.5.7         jsonlite_1.8.0      splines_4.2.0      
 [7] bslib_0.4.0         getPass_0.2-2       highr_0.9          
[10] yaml_2.3.5          numDeriv_2016.8-1.1 pillar_1.8.0       
[13] lattice_0.20-45     glue_1.6.2          digest_0.6.29      
[16] promises_1.2.0.1    minqa_1.2.4         colorspace_2.0-3   
[19] htmltools_0.5.3     httpuv_1.6.5        pkgconfig_2.0.3    
[22] purrr_0.3.4         scales_1.2.0        processx_3.7.0     
[25] whisker_0.4         later_1.3.0         tzdb_0.3.0         
[28] git2r_0.30.1        tibble_3.1.7        mgcv_1.8-40        
[31] farver_2.1.1        generics_0.1.3      ellipsis_0.3.2     
[34] cachem_1.0.6        withr_2.5.0         cli_3.3.0          
[37] crayon_1.5.1        magrittr_2.0.3      evaluate_0.16      
[40] ps_1.7.1            fs_1.5.2            fansi_1.0.3        
[43] nlme_3.1-157        MASS_7.3-56         tools_4.2.0        
[46] hms_1.1.1           lifecycle_1.0.1     stringr_1.4.0      
[49] munsell_0.5.0       callr_3.7.1         compiler_4.2.0     
[52] jquerylib_0.1.4     rlang_1.0.2         nloptr_2.0.3       
[55] rstudioapi_0.13     labeling_0.4.2      rmarkdown_2.14     
[58] gtable_0.3.0        abind_1.4-5         R6_2.5.1           
[61] knitr_1.39          fastmap_1.1.0       bit_4.0.4          
[64] utf8_1.2.2          rprojroot_2.0.3     stringi_1.7.8      
[67] parallel_4.2.0      Rcpp_1.0.9          vctrs_0.4.1        
[70] tidyselect_1.1.2    xfun_0.31          </code></pre>
</div>
</div>


<!-- Adjust MathJax settings so that all math formulae are shown using
TeX fonts only; see
https://docs.mathjax.org/en/latest/web/configuration.html. This will make
the presentation more consistent at the cost of the webpage sometimes
taking slightly longer to load. Note that this only works because the
footer is added to webpages before the MathJax javascript. -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>




</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
